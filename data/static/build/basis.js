(function(){(function(g){function H(a,h){for(var f in h)a[f]=h[f];return a}function b(a,h){for(var f in h)!1==f in a&&(a[f]=h[f]);return a}function t(a,h){var f={};if(!h)return H(f,a);for(var c=0,s;s=h[c++];)s in a&&(f[s]=a[s]);return f}function J(a,h,f){var c=[],s;for(s in a)c.push(h.call(f,s,a[s]));return c}function A(a){return null==a||void 0==a}function P(a){return a}function z(a){return function(){return a}}function y(){}function v(a,h){if(null!=a){var f=a.length;if("undefined"==typeof f||"[object Function]"==
C.call(a))return[a];h||(h=0);if(0<f-h){for(var c=[],s=0,w=h;w<f;)c[s++]=a[w++];return c}}return[]}function p(a,h,f){for(var c=[],s="function"==typeof h,w=0;w<a;w++)c[w]=s?h.call(f,w,c):h;return c}var F=g.document,q={_l10nIndex_:"basis>ui>calendar>day>fri<mon<sat<sun<thr<tue<wed<<day2>fri<mon<sat<sun<thr<tue<wed<<day3>fri<mon<sat<sun<thr<tue<wed<<month>apr<aug<dec<feb<jan<jul<jun<mar<may<nov<oct<sep<<monthShort>apr<aug<dec<feb<jan<jul<jun<mar<may<nov<oct<sep<<quarter<selected<today","0.css":"","0.tmpl":[[1,
0,["element"],"div",[4,[["app-page__","unselected"]],0,"app-page"]]],"n.tmpl":[[1,0,["element"],"div",[4,0,0,"app-wizard-start-local"],[1,0,0,"h2",[3,0,0,"Add your photos from desktop"]],[1,0,0,"div",[4,0,0,"app-wizard-start-local_drop-zone"],[3,0,0,"Drop your photos here or "],[1,0,0,"button",[3,0,0,"browse"]]]]],"m.tmpl":[[1,0,["element"],"span",[4,[["app-wizard-start-providers-item__","unchecked"]],0,"app-wizard-start-providers-item"],[6,"click","toggle"],[1,0,0,"img",[4,0,0,"app-wizard-start-providers-item_image"],
[2,[["imageUrl"],[0]],0,"src"]],[1,0,0,"div",[4,[["app-wizard-start-providers-item_title__","unchecked"]],0,"app-wizard-start-providers-item_title"],[3,1,["title"]]]]],"1.tmpl":[[1,0,["element"],"div",[4,0,0,"app-layout"],[1,0,0,"h1",[3,0,0,"EventShot"]],[1,0,0,"div",[4,0,0,"app-main-menu"],[1,0,0,"span",[4,0,0,"app-main-menu-item"],[6,"click","showEventList"],[3,0,0,"My events"]],[1,0,0,"span",[4,0,0,"app-main-menu-item"],[6,"click","createEvent"],[3,0,0,"New event"]]],[8,1,["tabs"]],[8,1,["pages"]]]],
"2.tmpl":[[1,0,["element"],"div",[4,0,0,"app-welcome"],[1,0,0,"h2",[3,0,0,"Welcome page"]]]],"3.tmpl":[[1,0,["element"],"div",[4,0,0,"app-wizard"]]],"4.tmpl":[[1,0,["element"],"div",[4,[["app-wizard-page__","selected"],["app-wizard-page__","unselected"]],0,"app-wizard-page"],[8,1,["content"]]]],"l.tmpl":[[1,0,["element"],"div",[4,0,0,"app-wizard-start-providers-list"],[1,1,["childNodesElement"],"div",[4,0,0,"app-wizard-start-providers-list_content"]]]],"k.tmpl":[[1,0,["element"],"div",[4,0,0,"app-wizard-start-dates"],
[1,0,0,"h2",[3,0,0,"When did you do?"]],[1,0,0,"div",[4,0,0,"app-wizard-start-dates_date-buttons"],[1,0,0,"button",[4,0,0,"app-wizard-start-dates_date-button"],[6,"click","pickStartDate"],[3,1,["startDate"]]],[1,0,0,"span",[5,0,0,"font-size: 180%;"],[3,0,0,"—"]],[1,0,0,"button",[4,0,0,"app-wizard-start-dates_date-button"],[6,"click","pickEndDate"],[3,1,["endDate"]]]]]],"j.tmpl":[[1,0,["element"],"div",[4,[["popup-","orientation",0,"v-left-top v-right-top v-center-top v-left-center v-right-center v-center-center v-left-bottom v-right-bottom v-center-bottom h-left-top h-right-top h-center-top h-left-center h-right-center h-center-center h-left-bottom h-right-bottom h-center-bottom".split(" ")],
["","anim:visible",2,["visible","hidden"]],["","selected",0],["","disabled",0]],0,"Basis-Popup hidden"],[1,0,["content","childNodesElement"],"div",[4,0,0,"Basis-Popup-Content"]],[2,0,0,"id","app-wizard-start-date-picker"]]],"w.tmpl":[[1,0,["element"],"a",[4,[["","nodePeriodName",0,["day","month","year","decade","quarter"]],["","selected",0],["","disabled",0],["","before",0],["","after",0]],0,"Basis-Calendar-Node"],[6,"click"],[3,1,["title"]]]],"5.tmpl":[[1,0,["element"],"div",[4,0,0,"app-eventlist"],
[1,0,0,"div",[1,0,0,"div",[4,0,0,"app-eventlist-item app-eventlist_new"],[6,"click","create"],[1,0,0,"div",[4,0,0,"app-eventlist_new-overlay"],[1,0,0,"div",[4,0,0,"app-eventlist_new-overlay-icon"]]]],[8,1,["childNodesHere"]]]]],"6.tmpl":[[1,0,["element"],"div",[4,0,0,"app-eventlist-item"],[6,"click","showDetails"],[1,0,0,"div",[4,0,0,"app-eventlist-item_defcover"]],[8,1,["cover"]],[1,0,0,"div",[4,0,0,"app-eventlist-item_label"],[1,0,0,"div",[4,[["app-eventlist-item_title__","noTitle"]],0,"app-eventlist-item_title"],
[3,1,["title"]]],[1,0,0,"div",[4,[["app-eventlist-item_dates__","noTitle"]],0,"app-eventlist-item_dates"],[3,1,["startDate"]],[3,0,0," — "],[3,1,["endDate"]]]]]],"7.tmpl":[[1,0,["element"],"div",[4,0,0,"app-eventlist-item-cover"],[5,[[["url"],["url(",0,")"],"background-image"]],0]]],"8.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event-entry"],[1,0,0,"a",[2,[["url"],[0]],0,"href"],[2,0,0,"target","_blank"],[1,0,0,"img",[4,0,0,"app-event-entry_source-icon"],[2,[["sourceImage"],[0]],0,"src"],[2,0,0,"width",
"46"]]],[1,0,0,"div",[4,0,0,"app-event-entry_content"],[8,1,["content"]]]]],"9.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event-entry app-event-entry-text"],[1,0,0,"a",[2,[["url"],[0]],0,"href"],[2,0,0,"target","_blank"],[1,0,0,"img",[4,0,0,"app-event-entry_source-icon"],[2,[["sourceImage"],[0]],0,"src"],[2,0,0,"width","46"]]],[1,0,0,"div",[4,0,0,"app-event-entry_content"],[1,0,0,"div",[4,0,0,"app-event-entry-text_wrapper"],[3,1,["content"]],[1,0,0,"br"],[1,0,0,"span",[4,0,0,"app-event-entry-time"],
[3,1,["time"]]]]]],[3,0,0,"</div>"]],"a.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event-entry app-event-entry-photo"],[1,0,0,"a",[2,[["url"],[0]],0,"href"],[2,0,0,"target","_blank"],[1,0,0,"img",[4,0,0,"app-event-entry_source-icon"],[2,[["sourceImage"],[0]],0,"src"],[2,0,0,"width","46"]]],[1,0,0,"div",[4,0,0,"app-event-entry_content"],[1,0,0,"div",[4,0,0,"app-event-entry-photo_photo-card_wrapper"],[1,0,0,"div",[4,0,0,"app-event-entry-photo_photo-card"],[1,0,0,"img",[4,0,0,"app-event-entry-photo_image"],
[2,[["imageUrl"],[0]],0,"src"],[2,[["width"],[0]],0,"width"],[2,[["height"],[0]],0,"height"]],[1,0,0,"div",[4,[["app-event-entry-photo_title__","title",0]],0,"app-event-entry-photo_title"],[1,0,0,"span",[4,0,0,"app-event-entry-photo_title-text"],[3,1,["title"]]]]]]]],[3,0,0,"</div>"]],"b.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event-entry app-event-entry-weather"],[1,0,0,"a",[2,[["url"],[0]],0,"href"],[2,0,0,"target","_blank"],[1,0,0,"img",[4,0,0,"app-event-entry_source-icon"],[2,[["sourceImage"],
[0]],0,"src"],[2,0,0,"width","46"]]],[1,0,0,"div",[4,0,0,"app-event-entry_content"],[1,0,0,"div",[4,0,0,"app-event-entry-text_wrapper"],[1,0,0,"img",[4,0,0,"app-event-entry-weather_image"],[2,[["image"],[0]],0,"src"]],[3,1,["title"]],[1,0,0,"br"],[1,0,0,"span",[4,0,0,"app-event-entry-time"],[3,1,["time"]]]]]],[3,0,0,"</div>"]],"c.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event"],[1,0,0,"div",[4,0,0,"app-event_dates"],[3,1,["startDate"]],[3,0,0," — "],[3,1,["endDate"]]],[8,1,["title"]],[8,1,["description"]],
[8,1,["entries"]],[8,1,["progress"]]]],"d.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event-title"],[1,0,["input","focus"],"input",[4,0,0,"app-event-title_input"],[2,0,0,"placeholder","Give a name for event"],[2,[["title"],[0]],0,"value"],[6,"keyup","change"],[6,"change"],[6,"blur","change"]]]],"e.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event-description"],[1,1,["input"],"textarea",[4,0,0,"app-event-description_input"],[2,0,0,"placeholder","Event description"],[2,[["description"],[0]],0,"value"],
[6,"keyup","change"],[6,"change"],[6,"blur","change"]]]],"v.tmpl":[[1,0,["element"],"div",[4,[["","selected",0],["","disabled",0]],0,"Basis-Calendar-Section Basis-Calendar-Section-Month"],[1,0,0,"div",[4,0,0,"Basis-Calendar-SectionTitle"],[3,1,["title"]],[3,0,0," "],[3,1,["year"]]],[1,0,["content","childNodesElement"],"div",[4,0,0,"Basis-Calendar-SectionContent"],[1,0,0,"div",[4,0,0,"Basis-Calendar-MonthWeekDays"],[1,0,0,"span",[4,0,0,"Basis-Calendar-MonthWeekDays-Day"],[3,"l10n:basis.ui.calendar.day2.mon",
0]],[1,0,0,"span",[4,0,0,"Basis-Calendar-MonthWeekDays-Day"],[3,"l10n:basis.ui.calendar.day2.tue",0]],[1,0,0,"span",[4,0,0,"Basis-Calendar-MonthWeekDays-Day"],[3,"l10n:basis.ui.calendar.day2.wed",0]],[1,0,0,"span",[4,0,0,"Basis-Calendar-MonthWeekDays-Day"],[3,"l10n:basis.ui.calendar.day2.thr",0]],[1,0,0,"span",[4,0,0,"Basis-Calendar-MonthWeekDays-Day"],[3,"l10n:basis.ui.calendar.day2.fri",0]],[1,0,0,"span",[4,0,0,"Basis-Calendar-MonthWeekDays-Day"],[3,"l10n:basis.ui.calendar.day2.sat",0]],[1,0,0,
"span",[4,0,0,"Basis-Calendar-MonthWeekDays-Day"],[3,"l10n:basis.ui.calendar.day2.sun",0]]]]],[1,1,["tabElement"],"div",[4,[["","selected",0]],0,"Basis-Calendar-SectionTab"],[6,"click","select"],[3,1,["tabTitle"]]]],"g.tmpl":[[1,0,["element"],"div",[4,0,0,"app-event-day"],[1,0,0,"div",[4,0,0,"app-event-day_title"],[3,1,["title"]]]]],"h.tmpl":[[1,0,["element"],"div",[4,[["app-event-progress__","visible"]],0,"app-event-progress"],[1,0,0,"div",[4,0,0,"app-event-progress_box"],[1,0,0,"div",[4,0,0,"app-event-progress_fill"],
[5,[[["progress"],[0,"%"],"width"]],0]]]]],"i.tmpl":[[1,0,["element"],"div",[4,0,0,"app-wizard-start"],[8,1,["dates"]],[8,1,["providers"]],[1,0,0,"button",[4,0,0,"app-wizard-start_create-button"],[6,"click","create"],[3,0,0,"Compose"]]]],"u.tmpl":[[1,0,["element"],"div",[4,[["Basis-Calendar-Section-","sectionName",0,"Month Year YearDecade Century YearQuarter Quarter".split(" ")],["","selected",0],["","disabled",0]],0,"Basis-Calendar-Section"],[1,0,0,"div",[4,0,0,"Basis-Calendar-SectionTitle"],[3,
1,["title"]]],[1,1,["childNodesElement"],"div",[4,0,0,"Basis-Calendar-SectionContent"]]],[1,1,["tabElement"],"div",[4,[["","selected",0]],0,"Basis-Calendar-SectionTab"],[6,"click","select"],[3,1,["tabTitle"]]]],"o.tmpl":[[1,0,["element"],"div",[4,0,0,"Basis-VerticalPanel"]]],"p.tmpl":[[1,0,["element"],"div",[4,0,0,"Basis-VerticalPanelStack"],[1,1,["ruller"],"div",[5,0,0,"position: absolute;visibility: hidden;top: -1000px;width: 10px;"]]]],"q.tmpl":[[1,0,["element"],"div",[4,[["popup-","orientation",
0,"v-left-top v-right-top v-center-top v-left-center v-right-center v-center-center v-left-bottom v-right-bottom v-center-bottom h-left-top h-right-top h-center-top h-left-center h-right-center h-center-center h-left-bottom h-right-bottom h-center-bottom".split(" ")],["","anim:visible",2,["visible","hidden"]],["","selected",0],["","disabled",0]],0,"Basis-Popup hidden"],[1,0,["content","childNodesElement"],"div",[4,0,0,"Basis-Popup-Content"]]]],"r.tmpl":[[1,0,["element"],"div",[4,[["mode-","orientation",
0,"v-left-top v-right-top v-center-top v-left-center v-right-center v-center-center v-left-bottom v-right-bottom v-center-bottom h-left-top h-right-top h-center-top h-left-center h-right-center h-center-center h-left-bottom h-right-bottom h-center-bottom".split(" ")],["","anim:visible",2,["visible","hidden"]],["","selected",0],["","disabled",0]],0,"Basis-Balloon hidden"],[6,"click"],[1,0,0,"div",[4,0,0,"Basis-Balloon-Canvas"],[1,0,0,"div",[4,0,0,"corner-left-top"]],[1,0,0,"div",[4,0,0,"corner-right-top"]],
[1,0,0,"div",[4,0,0,"side-top"]],[1,0,0,"div",[4,0,0,"side-left"]],[1,0,0,"div",[4,0,0,"side-right"]],[1,0,0,"div",[4,0,0,"content"]],[1,0,0,"div",[4,0,0,"corner-left-bottom"]],[1,0,0,"div",[4,0,0,"corner-right-bottom"]],[1,0,0,"div",[4,0,0,"side-bottom"]],[1,0,0,"div",[4,0,0,"tail"]]],[1,0,0,"div",[4,0,0,"Basis-Balloon-Layout"],[1,0,["content","childNodesElement"],"div",[4,0,0,"Basis-Balloon-Content"]]]]],"s.tmpl":[[1,0,["element"],"div",[2,0,0,"id","Basis-PopupStack"],[4,[["","hasChildren",0]],
0]]],"t.tmpl":[[1,0,["element"],"div",[4,[["","selected",0],["","disabled",0]],0,"Basis-Calendar"],[1,0,0,"div",[4,0,0,"Basis-Calendar-Header"],[1,1,["sectionTabs"],"div",[4,0,0,"Basis-Calendar-SectionTabs"]]],[1,0,0,"div",[4,0,0,"Basis-Calendar-Body"],[1,0,0,"span",[6,"click","movePrev"],[4,0,0,"Basis-Calendar-ButtonPrevPeriod"],[1,0,0,"span",[3,0,0,"‹"]],[1,0,0,"span",[4,0,0,"over"]]],[1,0,0,"span",[6,"click","moveNext"],[4,0,0,"Basis-Calendar-ButtonNextPeriod"],[1,0,0,"span",[3,0,0,"›"]],[1,0,
0,"span",[4,0,0,"over"]]],[1,0,["content","childNodesElement"],"div",[4,0,0,"Basis-Calendar-Content"]]],[1,0,0,"div",[4,0,0,"Basis-Calendar-Footer"],[1,0,0,"div",[4,0,0,"Basis-Calendar-Footer-Date"],[1,0,0,"span",[4,0,0,"Basis-Calendar-Footer-Label"],[3,"l10n:basis.ui.calendar.today",0],[3,0,0,":"]],[1,0,0,"span",[6,"click","selectToday"],[4,0,0,"Basis-Calendar-Footer-Value"],[3,1,["today"]]]]]]],"f.tmpl":[[1,0,["element"],"div",[4,[["app-event-entry-list__","visible"]],0,"app-event-entry-list"]]],
"8.js":function(a,h,f,c,s,w,b){var n="January February March April May June July August September October November December".split(" "),u=new f.ui.calendar.Calendar({maxDate:new Date,sections:["Month"],handler:{change:function(){"startDate"==u.dateType?e.update({startDate:f.date.format(this.selectedDate.value,"%Y-%M-%D")}):e.update({endDate:f.date.format(this.selectedDate.value,"%Y-%M-%D")});d.hide()}}}),d=new f.ui.popup.Popup({template:f.template.get("#k"),dir:"bottom center top center",childNodes:[u]}),
e=new f.ui.Node({autoDelegate:!0,template:f.template.get("#l"),binding:{startDate:{events:"update",getter:function(a){a=f.date.fromISOString(a.data.startDate);return n[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear()}},endDate:{events:"update",getter:function(a){a=f.date.fromISOString(a.data.endDate);return n[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear()}}},action:{pickStartDate:function(a){u.selectedDate.set(f.date.fromISOString(this.data.startDate));u.dateType="startDate";d.show(a.sender)},
pickEndDate:function(a){u.selectedDate.set(f.date.fromISOString(this.data.endDate));u.dateType="endDate";d.show(a.sender)}}});h.exports=e},"7.js":function(a,h,f,c,s,w,b){a=f.entity.createType("Provider",{id:f.entity.StringId,title:String,enabled:Boolean});a.all.sync([{id:"instagram",title:"Instagram"},{id:"twitter",title:"Twitter"},{id:"foursquare",title:"Foursquare"},{id:"facebook",title:"Facebook"}]);a.assets={instagram:"res/5jmIgrt08XS4w3uQga33fw.png",twitter:"res/eeJAfI-8iZkLWmv0c_HMVQ.png",foursquare:"res/l5sxV1gmop93otZQ-MocqQ.png",
facebook:"res/S9P1qHtsWyou0VhQNl7UUA.png",weather:"res/QdoVTxrca3Gp7N6VZ3ljQQ.png"};h.exports=a},"6.js":function(a,h,f,c,s,w,b){a=f.entity.createType("Entry",{id:f.entity.IntId,source:String,type:String,created:String,data:function(a){return a||""}});var n=a.entityType.reader;a.entityType.reader=function(a){a&&a.data&&(a.created=a.data.created);return n.call(this,a)};h.exports=a},"5.js":function(a,h,f,c,s,w,b){function n(a){return null==a?a:String(a)}var u=f.entity.createType("Event",{id:f.entity.IntId,
startDate:{type:String,defValue:function(){return(new Date).add("day",-7).toISOString()}},endDate:{type:String,defValue:function(){return(new Date).toISOString()}},title:n,description:n,main_entry:"Entry",status:String,progress:Number,providers:{type:Array,defValue:function(){return app.type.Provider.all.getItems().filter(function(a){return a.data.enabled}).map(function(a){return a.data.id})}},entries:f.entity.createSetType("Entry")}),d=u.entityType.reader;u.entityType.reader=function(a){a&&a.entries&&
a.entries.forEach(function(h){h.data&&h.data.weather&&a.entries.push({id:-h.id,created:h.data.created,source:"weather",type:"weather",data:f.object.complete({created:h.data.created},h.data.weather)})});return d.call(this,a)};var e;u.inited=new f.data.dataset.Subset({source:u.all,rule:function(a){return a.data.id},syncAction:app.service["default"].createAction({url:"/api/event",success:function(a){f.array(a.events).map(u.reader).map(u)}}),handler:{stateChanged:function(){this.state==f.data.STATE.READY||
this.state==f.data.STATE.UNDEFINED?e||(e=setTimeout(function(){u.inited.deprecate()},5E3)):e=clearTimeout(e)}}});new f.ui.Node({active:!0,dataSource:u.inited});u.extend({syncAction:app.service["default"].createAction({url:"/api/event/:id",request:function(){return{routerParams:{id:this.data.id}}},success:function(a){this.update(u.reader(a.event))}}),save:app.service["default"].createAction({method:"POST",request:function(){return!this.data.id?{url:"/api/event/create",params:{start_date:this.data.startDate,
end_date:this.data.endDate,providers:this.data.providers}}:{url:"/api/event/:id",routerParams:{id:this.data.id},params:f.object.slice(this.data,["title","description"])}},success:function(a){this.data.id||f.net.request({timeout:6E4,method:"POST",url:"/api/event/"+a.event.id+"/start"});this.update(u.reader(a.event))}}),remove:app.service["default"].createAction({method:"POST",url:"/api/:id/remove",request:function(){return{routerParams:{id:this.data.id}}},success:function(a){this.destroy()}})});h.exports=
u},"9.js":function(a,h,f,c,s,w,b){var n=new f.data.Value({value:[]}),u=new f.ui.Node({autoDelegate:!0,dataSource:app.type.Provider.all,handler:{update:function(){n.set(this.data.providers)}},template:f.template.get("#m"),childClass:{checked:!1,template:f.template.get("#n"),binding:{id:"data:",imageUrl:{events:"update",getter:function(a){return app.type.Provider.assets[a.data.id]}},title:"data:",unchecked:n.compute("update",function(a,h){return-1==h.indexOf(a.data.id)})},action:{toggle:function(){var a=
f.array(this.parentNode.data.providers),h=a.indexOf(this.data.id);if(-1==h)if(app.type.Provider(this.data.id).data.enabled)a.push(this.data.id);else return window.open("/login/"+this.data.id,"oauth","scrollbars=0, resizable=1, menubar=0, left="+(screen.width-800)/2+", top="+(screen.height-600)/2+", width=800, height=600, toolbar=0, status=0"),!1;else a.splice(h,1);this.parentNode.update({providers:a})}}}});app.onProvidersInit=function(){u.update({providers:app.type.Provider.all.getItems().filter(function(a){return a.data.enabled}).map(function(a){return a.data.id})})};
h.exports=u},"0.js":function(a,h,f,c,s,w,b){h.exports=new f.ui.Node({template:f.template.get("#3"),binding:{},action:{}})},"3.js":function(a,h,f,c,s,w,b){var n="January February March April May June July August September October November December".split(" "),u=new f.ui.Node.subclass({template:f.template.get("#9"),binding:{source:"data:",sourceImage:{events:"update",getter:function(a){return app.type.Provider.assets[a.data.source]}},content:"data:data",type:"data:type",id:"data:id",url:'data:data.url || ""',
time:{events:"update",getter:function(a){return a.data.created.split(" ")[1].split(":").slice(0,2).join(":")}}}}),d={text:u.subclass({template:f.template.get("#a"),binding:{content:"data:data.title"}}),photo:u.subclass({template:f.template.get("#b"),binding:{imageUrl:"data:data.photo",title:"data:data.title",width:"data:data.width",height:"data:data.height"}}),weather:u.subclass({template:f.template.get("#c"),binding:{image:"data:data.pic",title:"data:data.title"}})},e=new f.ui.Node({active:!0,handler:{update:function(a,
h){"status"in h&&this.deprecate()}},template:f.template.get("#d"),binding:{id:"data:",status:"data:",title:new f.ui.Node({autoDelegate:!0,template:f.template.get("#e"),binding:{title:{events:"update",getter:function(a){return a.data.title||""}}},action:{change:function(a){if("blur"==a.type||"keyup"==a.type&&a.key==a.KEY.ENTER){var h=this.data.id;f.net.request({method:"POST",params:{title:this.data.title},url:"/api/event/"+this.data.id},function(a){app.type.Event(h).set("title",a.event.title)})}else this.target.set("title",
this.tmpl.input.value,!0)}},handler:{targetChanged:function(){var a=this;f.nextTick(function(){a.data.title||a.focus()})}}}),startDate:{events:"update",getter:function(a){a=f.date.fromISOString(a.data.startDate);return n[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear()}},endDate:{events:"update",getter:function(a){a=f.date.fromISOString(a.data.endDate);return n[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear()}},description:new f.ui.Node({autoDelegate:!0,template:f.template.get("#f"),binding:{description:{events:"update",
getter:function(a){return a.data.description||""}}},action:{change:function(a){if("blur"==a.type||"keyup"==a.type&&a.key==a.KEY.ENTER){var h=this.data.id;f.net.request({r:1,method:"POST",params:{description:this.data.description},url:"/api/event/"+this.data.id},function(a){app.type.Event(h).set("description",a.event.description)})}else this.target.set("description",this.tmpl.input.value,!0)}}}),entries:new f.ui.Node({autoDelegate:!0,handler:{update:function(){this.setDataSource(this.data.entries)}},
template:f.template.get("#g"),binding:{visible:{events:"update",getter:function(a){return"ready"==a.data.status}}},sorting:"data.created",grouping:{groupGetter:function(a){return a.data.created.split(" ")[0]},childClass:{template:f.template.get("#h"),binding:{title:{events:"update",getter:function(a){a=a.data.title.split("-");return n[a[1]-1]+" "+Number(a[2])}}}}},childClass:u,childFactory:function(a){return new (d[a.delegate.data.type]||u)(a)}}),progress:new f.ui.Node({autoDelegate:!0,template:f.template.get("#i"),
binding:{visible:{events:"update",getter:function(a){return"wait"==a.data.status||"progress"==a.data.status}},progress:"data:"}})}});f.router.add("/event/:id",{match:function(a){e.setDelegate(app.type.Event(a))},leave:function(){e.setDelegate()}});h.exports=e},"a.js":function(a,h,f,c,s,w,b){h.exports=new f.ui.Node({template:f.template.get("#o"),binding:{},action:{}})},"2.js":function(a,h,f,c,s,w,b){var n="January February March April May June July August September October November December".split(" ");
h.exports=new f.ui.Node({template:f.template.get("#6"),action:{create:function(){f.router.navigate("/add-event")}},dataSource:app.type.Event.inited,active:!0,sorting:"data.id",sortingDesc:!0,childClass:{template:f.template.get("#7"),binding:{title:"data:",hasTitle:{events:"update",getter:function(a){return!!a.data.title}},noTitle:{events:"update",getter:function(a){return!a.data.title}},startDate:{events:"update",getter:function(a){a=f.date.fromISOString(a.data.startDate);return n[a.getMonth()]+" "+
a.getDate()+", "+a.getFullYear()}},endDate:{events:"update",getter:function(a){a=f.date.fromISOString(a.data.endDate);return n[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear()}},cover:"satellite:"},action:{showDetails:function(){f.router.navigate("/event/"+this.data.id)}},satelliteConfig:{cover:{existsIf:function(a){return a.data.main_entry},delegate:function(a){return a.data.main_entry},instanceOf:f.ui.Node.subclass({template:f.template.get("#8"),binding:{url:"data:data.photo"}})}}}})},"1.js":function(a,
h,f,c,s,w,b){var n=new f.ui.Node({template:f.template.get("#4"),selection:!0,childClass:{autoDelegate:!0,template:f.template.get("#5"),binding:{content:"satellite:"},emit_select:function(){this.lazyContent&&(this.setSatellite("content",this.lazyContent.fetch()),this.lazyContent=null);f.ui.Node.prototype.emit_select.call(this)}},childNodes:[{autoDelegate:!0,selected:!0,lazyContent:f.resource("4.js")}],handler:{update:function(a,h){"id"in h&&this.data.id&&f.router.navigate("/event/"+this.data.id)}}});
f.router.add(/^(\/add-event|\/?)$/,{enter:function(a){n.setDelegate(app.type.Event({}))},leave:function(){n.data.id?n.setDelegate():n.target.destroy()}});h.exports=n},"4.js":function(a,h,f,c,s,w,b){a=new f.ui.Node({autoDelegate:!0,template:f.template.get("#j"),binding:{dates:f.resource("8.js").fetch(),providers:f.resource("9.js").fetch(),local:f.resource("a.js").fetch()},action:{create:function(){this.target.save()}}});h.exports=a}},C=Object.prototype.toString,x=function(){function a(h){if(f.test(h)){var w=
h.split("."),T=w[0],c=w[1],s=w[2];switch(w.length){case 1:h=function(a){return null!=a?a[T]:a};break;case 2:h=function(a){return null!=a?a[T][c]:a};break;case 3:h=function(a){return null!=a?a[T][c][s]:a};break;default:h=function(a){if(null!=a){a=a[T][c][s];for(var h=3,f;f=w[h];h++)a=a[f]}return a}}return h}return new Function("object","return object != null ? object."+h+" : object")}var h=1,f=/^[a-z$_][a-z$_0-9]*(\.[a-z$_][a-z$_0-9]*)*$/i,c=[],s={},w={};return function(f,b){var n,u,d;if(!f||f===N)return N;
"function"==typeof f?(d=f.basisGetterId_)?n=c[Math.abs(d)-1]:(n=function(a){return f(a)},n.base=f,n.__extend__=x,d=c.push(n),f.basisGetterId_=-d,n.basisGetterId_=d):(n=s[f])?d=n.basisGetterId_:(n=a(f),n.base=f,n.__extend__=x,d=c.push(n),n.basisGetterId_=d,s[f]=n);u=null!=b&&typeof b;if(!u)return n;var e=w[d],E;if("string"==u)E=u+b;else if("function"==u)E=b.basisModId_;else if("object"!=u)return n;if(E&&e&&e[E])return e[E];"function"==typeof n.base&&(n=n.base);switch(u){case "string":u=function(a){return b.format(n(a))};
break;case "function":E||(E=u+h++,b.basisModId_=E);u=function(a){return b(n(a))};break;default:u=function(a){return b[n(a)]}}u.base=n.base||n;u.__extend__=x;E&&(e||(e={},w[d]=e),e[E]=u,u.mod=b,u.basisGetterId_=c.push(u));return u}}(),N=H(function(){},{__extend__:x}),G=function(){var a={log:y,info:y,warn:y,error:y};"undefined"!=typeof console&&J(a,function(h){a[h]="bind"in Function.prototype&&"function"==typeof console[h]?Function.prototype.bind.call(console[h],console):function(){Function.prototype.apply.call(console[h],
console,arguments)}});return a}(),I=g.setImmediate||g.msSetImmediate,r=g.clearImmediate||g.msSetImmediate;I&&(I=I.bind(g));r&&(r=r.bind(g));I||function(){var a=function(){var a={},f=1;I=function(){a[++f]={fn:arguments[0],args:v(arguments,1)};h(f);return f};r=function(h){delete a[h]};return function(h){var f=a[h];if(f)try{"function"==typeof f.fn?f.fn.apply(void 0,f.args):(g.execScript||function(a){g.eval.call(g,a)})(String(f.fn))}finally{delete a[h]}}}(),h=function(h){setTimeout(function(){a(h)},0)};
if(g.process&&"function"==typeof process.nextTick)h=function(h){process.nextTick(function(){a(h)})};else if(g.MessageChannel)h=function(h){var f=new g.MessageChannel;f.port1.onmessage=function(){a(h)};f.port2.postMessage("")};else{var f=g.postMessage&&!g.importScripts;if(f){var c=g.onmessage;g.onmessage=function(){f=!1};g.postMessage("","*");g.onmessage=c}f?(c=function(h){h&&h.source==g&&(h=String(h.data).split("basisjs.setImmediate")[1])&&a(h)},g.addEventListener?g.addEventListener("message",c,!0):
g.attachEvent("onmessage",c),h=function(a){g.postMessage("basisjs.setImmediate"+a,"*")}):F&&"onreadystatechange"in createScript()&&(h=function(h){var f=createScript();f.onreadystatechange=function(){a(h);f.onreadystatechange=null;f.parentNode.removeChild(f);f=null};F.documentElement.appendChild(f)})}}();var m="object"==typeof process&&"[object process]"==C.call(process),e=function(){var a="",h,f;if(m)f=t(require("path"),"normalize dirname extname basename resolve relative".split(" ")),h=f.resolve(".")+
"/";else{var c=/^([^\/]+:|\/)/,s=/^([a-zA-Z0-9\-]+:)?\/\/[^\/]+/,w=/[\?#].*$/;f={normalize:function(a){var h=[];a=(a||"").replace(s,"").replace(w,"").split("/");for(var f=0;f<a.length;f++)".."==a[f]?h.pop():(a[f]||!f)&&"."!=a[f]&&h.push(a[f]);return h.join("/")},dirname:function(a){return f.normalize(a).replace(/\/[^\/]*$/,"")},extname:function(a){return(a=f.normalize(a).match(/\.[^\\\/]*$/))?a[0]:""},basename:function(a,h){var w=f.normalize(a).match(/[^\\\/]*$/),w=w?w[0]:"";h==f.extname(w)&&(w=w.substring(0,
w.length-h.length));return w},resolve:function(a,w){for(var T=v(arguments).reverse(),s=[],b=!1,n=0;!b&&n<T.length;n++)"string"==typeof T[n]&&(s.unshift(T[n]),b=c.test(T[n]));b||s.unshift("/"==h?"":h);return f.normalize(s.join("/"))},relative:function(a,w){"string"!=typeof w&&(w=a,a=h);for(var T=f.normalize(w).split(/\//),c=f.normalize(a).split(/\//),s=0;T[s]==c[s]&&"string"==typeof c[s];)s++;for(var b="",c=c.length-s;0<c;c--)b+="../";return b+T.slice(s).join("/")}};h=location.pathname.replace(/[^\/]+$/,
"");a=location.protocol+"//"+location.host}f.baseURI=h;f.origin=a;return f}(),d="",k=function(){var a="",h={extClass:!0};if(m)d=__filename,a=__dirname;else for(var f=F.getElementsByTagName("script"),c=0,s;s=f[c];c++){var w=s.getAttributeNode("data-basis-config")||s.getAttributeNode("basis-config");if(w){try{H(h,Function("return{"+w.nodeValue+"}")()||{})}catch(b){}d=e.normalize(s.src);a=e.dirname(d);break}}h.path=H(h.path||{},{basis:a});a=h.autoload;h.autoload=!1;if(a&&(a=a.match(/^((?:[^\/]*\/)*)([a-z$_][a-z0-9$_]*)((?:\.[a-z$_][a-z0-9$_]*)*)$/i))&&
"basis"!=a[2])h.autoload=a[2]+(a[3]||""),a[1]&&(h.path[a[2]]=a[1].replace(/\/$/,""));for(var n in h.path)h.path[n]=e.resolve(h.path[n])+"/";return h}(),R={},D=function(a,h){var f=g,c;a=a.split(".");for(var s=0,w;w=a[s];s++){if(!f[w]){var n=a.slice(0,s+1).join(".");f[w]=function(a,h){var f="function"==typeof h?h:null,w=function(h){return a+(h?"."+h:"")};w.toString=z(a);return H(function(){if(f)return f.apply(this,arguments)},{path:w,exports:{path:w},toString:z("[basis.namespace "+a+"]"),extend:function(a){H(this.exports,
a);return b(this,a)},setWrapper:function(a){"function"==typeof a&&(f=a)}})}(n,s<a.length?h:null);c&&(c.namespaces_[n]=f[w])}f=f[w];c||(c=f,c.namespaces_||(c.namespaces_={}))}return R[a.join(".")]=f},E=function(){function a(h){return"function"==typeof h&&!!h.basisClassId_}function h(a){for(var f=this;f&&f!==a;)f=f.superClass_;return f===a}var f=function(){},c=1,s=1,w=function(){},n={},b=function(){for(var a in{toString:1})return!1;return!0}();H(f,{className:"basis.Class",extendConstructor_:!1,prototype:{constructor:null,
init:w,postInit:w,toString:function(){return"[object "+(this.constructor||this).className+"]"},destroy:function(){for(var a in this)this[a]=null;this.destroy=y}},create:function(w,b){var u=s++;"function"!=typeof w&&(w=f);var d=function(){};d.prototype=w.prototype;for(var d=new d,u={basisClassId_:u,superClass_:w,extendConstructor_:!!w.extendConstructor_,isSubclassOf:h,subclass:function(){return f.create.apply(null,[l].concat(v(arguments)))},extend:f.extend,__extend__:function(h){return h&&h!==n&&("object"==
typeof h||"function"==typeof h&&!a(h))?f.create.call(null,l,h):h},prototype:d},e=1,E;E=arguments[e];e++)u.extend(E);var l=u.extendConstructor_?function(a){this.basisObjectId=c++;var h,f;for(f in a)h=this[f],this[f]=h&&h.__extend__?h.__extend__(a[f]):a[f];this.init();this.postInit()}:function(){this.basisObjectId=c++;this.init.apply(this,arguments);this.postInit()};d.constructor=l;for(var S in d)d[S]===n&&(d[S]=l);H(l,u);return l},extend:function(h){var f=this.prototype;"function"==typeof h&&!a(h)&&
(h=h(this.superClass_.prototype));h.prototype&&(h=h.prototype);for(var w in h){var c=h[w],s=f[w];"className"==w||"extendConstructor_"==w?this[w]=c:f[w]=s&&s.__extend__?s.__extend__(c):c}if(b&&h[w="toString"]!==C)f[w]=h[w];return this}});var u=function(a,h,f){return{__extend__:function(a){if(!a||a&&a.__extend__)return a;var f=function(){};f.prototype=this;f=new f;h(f,a);return f}}.__extend__(a||{})},d=function(a){return u(a,H,"extensibleProperty")};return D("basis.Class",f.create).extend({SELF:n,BaseClass:f,
create:f.create,isClass:a,customExtendProperty:u,extensibleProperty:d,nestedExtendProperty:function(a){return u(a,function(a,h){for(var f in h){var w=a[f];a[f]=w&&w.__extend__?w.__extend__(h[f]):d(h[f])}},"nestedExtendProperty")},oneFunctionProperty:function(a,h){var f=function(h){var w;if(h){if(h.__extend__)return h;w={__extend__:f};for(var T in h)h[T]&&(w[T]=a)}return w};return f(h||{})}})}(),L=E(null,{className:"basis.Token",value:null,handler:null,deferredToken:null,bindingBridge:{attach:function(a,
h,f){return a.attach(h,f)},detach:function(a,h,f){return a.detach(h,f)},get:function(a){return a.get()}},init:function(a){this.value=a},get:function(){return this.value},set:function(a){this.value!==a&&(this.value=a,this.apply())},attach:function(a,h){this.handler={fn:a,context:h,handler:this.handler}},detach:function(a,h){for(var f=this,c;c=f,f=f.handler;)if(f.fn===a&&f.context===h){f.fn=y;c.handler=f.handler;break}},apply:function(){for(var a=this.get(),h=this;h=h.handler;)h.fn.call(h.context,a)},
deferred:function(){var a=this.deferredToken;a||(a=this.deferredToken=new S.DeferredToken(this.value),this.attach(a.set,a));return a},destroy:function(){this.deferredToken&&(this.deferredToken.destroy(),this.deferredToken=null);this.value=this.handler=null}}),O=function(){function a(){var c=h;h={};f=null;for(var s in c)c[s].apply()}var h={},f;return function(c){c.basisObjectId in h||(h[c.basisObjectId]=c,f||I(a))}}(),c=L.subclass({set:function(a){this.value!==a&&(this.value=a,O(this))},deferred:function(){return this}}),
l={},B={};(function(){if(q)for(var a in q)B[e.resolve(a)]=q[a];q=null})();var Q=function(a,h){if(h||!B.hasOwnProperty(a)){var f="";if(m)try{f=require("fs").readFileSync(a,"utf-8")}catch(c){}else{var s=new XMLHttpRequest;s.open("GET",a,!1);s.setRequestHeader("If-Modified-Since",(new Date(0)).toGMTString());s.setRequestHeader("X-Basis-Resource",1);s.send("");200<=s.status&&400>s.status&&(f=s.responseText)}B[a]=f}return B[a]},K=function(a){a=e.resolve(a);if(!l[a]){var h=K.extensions[e.extname(a)],f=
!1,c=!1,s,w=function(){if(f)return s;var n=Q(a);h?c||(c=!0,s=h(n,a)):s=n;f=!0;w.apply();return s};H(w,H(new L,{url:a,fetch:function(){return w()},toString:function(){return"[basis.resource "+a+"]"},update:function(n){n=String(n);if(!f||n!=B[a]){B[a]=n;if(h){if(!c||!h.updatable)return;s=h(n,a)}else s=n;f=!0;w.apply()}},reload:function(){var h=B[a],c=Q(a,!0);c!=h&&(f=!1,w.update(c))},get:function(h){return h?Q(a):w()},ready:function(a,c){if(f&&(a.call(c,w()),h&&!h.updatable))return;w.attach(a,c);return w}}));
l[a]=w}return l[a]};H(K,{getFiles:function(){var a=[],h;for(h in l)a.push(e.relative(h));return a},getSource:function(a){return Q(e.resolve(a))},exists:function(a){return!!l.hasOwnProperty(e.resolve(a))},extensions:{".js":function(a,h){return M({exports:{}},h,a).exports},".json":H(function(a,h){if("object"==typeof a)return a;var f;try{f=JSON.parse(String(a))}catch(c){}return f||null},{updatable:!0})}});var M=function(a,h,f){var c=e.dirname(h)+"/",s=f;a.exports||(a.exports={});if("function"!=typeof s)try{s=
new Function("exports, module, basis, global, __filename, __dirname, resource","//@ sourceURL="+e.origin+h+"\n//# sourceURL="+e.origin+h+'\n"use strict";\n\n'+f)}catch(w){return S.dev.error("Compilation error at "+h+("line"in w?":"+(w.line-4):"")+": "+w),a}s.call(a.exports,a.exports,a,S,g,h,c,function(a){return K(c+a)});return a},a=function(){if(m){var a=e.dirname(module.filename)+"/",h=module.constructor.prototype;return function(f){var w=h._compile,c=D(f);h._compile=function(a,h){this.basis=S;w.call(H(this,
c),'var basis = module.basis;\nvar resource = function(filename){ return basis.require(__dirname + "/" + filename) };\n'+a,h)};f=require(a+f.replace(/\./g,"/"));c.exports=f;b(c,f);h._compile=w;return f}}var f=k.path,c={};return function(a){if(/[^a-z0-9_\.]/i.test(a))throw 1;var h=a.replace(/\./g,"/")+".js",s=a.split(".")[0];s==a&&(f[s]=f[a]||e.baseURI);if(!R[a]){s=f[s];if(!/^\//.test(s))throw 2;if(c[a])throw 3;c[a]=!0;h=s+h;a=D(a);s=Q(h);M(a,h,s);b(a,a.exports)}}}();b(Function.prototype,{bind:function(a){var h=
this,f=v(arguments,1);return f.length?function(){return h.apply(a,f.concat.apply(f,arguments))}:function(){return h.apply(a,arguments)}}});b(Array,{isArray:function(a){return"[object Array]"===C.call(a)}});b(Array.prototype,{indexOf:function(a,h){h=parseInt(h,10)||0;if(0>h)return-1;for(;h<this.length;h++)if(this[h]===a)return h;return-1},lastIndexOf:function(a,h){var f=this.length;h=parseInt(h,10);for(h=isNaN(h)||h>=f?f-1:(h+f)%f;0<=h;h--)if(this[h]===a)return h;return-1},forEach:function(a,h){for(var f=
0,c=this.length;f<c;f++)f in this&&a.call(h,this[f],f,this)},every:function(a,h){for(var f=0,c=this.length;f<c;f++)if(f in this&&!a.call(h,this[f],f,this))return!1;return!0},some:function(a,h){for(var f=0,c=this.length;f<c;f++)if(f in this&&a.call(h,this[f],f,this))return!0;return!1},filter:function(a,h){for(var f=[],c=0,s=this.length;c<s;c++)c in this&&a.call(h,this[c],c,this)&&f.push(this[c]);return f},map:function(a,h){for(var f=[],c=0,s=this.length;c<s;c++)c in this&&(f[c]=a.call(h,this[c],c,
this));return f},reduce:function(a,h){var f=this.length,c=arguments.length;if(0==f&&1==c)throw 4;var s,w=0;1<c&&(s=h,w=1);for(c=0;c<f;c++)c in this&&(s=w++?a.call(null,s,this[c],c,this):this[c]);return s}});H(Array.prototype,{flatten:function(){return this.concat.apply([],this)},repeat:function(a){return p(parseInt(a,10)||0,this).flatten()},item:function(a){a=parseInt(a||0,10);return this[0<=a?a:this.length+a]},search:function(a,h,f){Array.lastSearchIndex=-1;h=x(h||P);f=parseInt(f,10)||0;for(var c=
this.length;f<c;f++)if(h(this[f])===a)return this[Array.lastSearchIndex=f]},lastSearch:function(a,h,f){Array.lastSearchIndex=-1;h=x(h||P);var c=this.length;f=isNaN(f)||null==f?c:parseInt(f,10);for(c=f>c?c:f;0<c--;)if(h(this[c])===a)return this[Array.lastSearchIndex=c]},binarySearchPos:function(a,h,f,c,s,w){if(!this.length)return c?-1:0;h=x(h||P);f=!!f;var n;s=isNaN(s)?0:s;var b=isNaN(w)?this.length-1:w;do if(w=s+b>>1,n=h(this[w]),f?a>n:a<n)b=w-1;else if(f?a<n:a>n)s=w+1;else return a==n?w:c?-1:0;while(s<=
b);return c?-1:w+(n<a^f)},binarySearch:function(a,h){return this.binarySearchPos(a,h,!1,!0)},add:function(a){return-1==this.indexOf(a)&&!!this.push(a)},remove:function(a){a=this.indexOf(a);return-1!=a&&!!this.splice(a,1)},has:function(a){return-1!=this.indexOf(a)},merge:function(a){return this.reduce(H,a||{})},sortAsObject:function(a,h,f){a=x(a);f=f?-1:1;return this.map(function(h,f){return{i:f,v:a(h)}}).sort(h||function(a,h){return f*(a.v>h.v||-(a.v<h.v)||(a.i>h.i?1:-1))}).map(function(a){return this[a.i]},
this)},set:function(a){this!==a&&(this.length=0,this.push.apply(this,a));return this},clear:function(){this.length=0;return this}});if(![1,2].splice(1).length){var n=Array.prototype.splice;Array.prototype.splice=function(){var a=v(arguments);2>a.length&&(a[1]=this.length);return n.apply(this,a)}}var u={"<":">","[":"]","(":")","{":"}","«":"»"},U=/([\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$])/g,V=/\{([a-z\d_]+)(?::([\.0])(\d+)|:(\?))?\}/gi,W={};b(String,{toLowerCase:function(a){return String(a).toLowerCase()},
toUpperCase:function(a){return String(a).toUpperCase()},trim:function(a){return String(a).trim()},trimLeft:function(a){return String(a).trimLeft()},trimRight:function(a){return String(a).trimRight()}});b(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});H(String.prototype,{toObject:function(a){try{return(new Function("return 0,"+this))()}catch(h){if(a)throw 5;}},toArray:"a".hasOwnProperty("0")?
function(){return v(this)}:function(){for(var a=[],h=this.length,f=0;f<h;f++)a[f]=this.charAt(f);return a},repeat:function(a){return Array(parseInt(a,10)+1||0).join(this)},qw:function(){var a=this.trim();return a?a.split(/\s+/):[]},forRegExp:function(){return this.replace(U,"\\$1")},format:function(a){var h=arguments;"object"==typeof a&&H(h,a);return this.replace(V,function(a,f,c,w,s){a=f in h?h[f]:s?"":a;return c&&!isNaN(a)?(a=Number(a),"."==c?a.toFixed(w):a.lead(w)):a})},quote:function(a,h){a=a||
'"';h=h||u[a]||a;var f=(1==a.length?a:"")+(1==h.length?h:"");return a+(f?this.replace(W[f]||(W[f]=RegExp("["+f.forRegExp()+"]","g")),"\\$&"):this)+h},capitalize:function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()},camelize:function(){return this.replace(/-(.)/g,function(a,h){return h.toUpperCase()})},dasherize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}});11!="|||".split(/\|/).length+"|||".split(/(\|)/).length&&(String.prototype.split=function(a,
h){if(""==a||a&&""==a.source)return this.toArray();var f=[],c=0,s;if(a instanceof RegExp)for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));s=a.exec(this);)s[0]=this.substring(c,s.index),f.push.apply(f,s),c=a.lastIndex;else for(;-1!=(s=this.indexOf(a,c));)f.push(this.substring(c,s)),c=s+a.length;f.push(this.substr(c));return f});if("2"!="12".substr(-1)){var h=String.prototype.substr;String.prototype.substr=function(a,f){return h.call(this,0>a?Math.max(0,this.length+a):a,f)}}H(Number.prototype,
{fit:function(a,h){return!isNaN(a)&&this<a?Number(a):!isNaN(h)&&this>h?Number(h):this},between:function(a,h){return!isNaN(this)&&this>=a&&this<=h},quote:function(a,h){return(this+"").quote(a,h)},toHex:function(){return parseInt(this,10).toString(16).toUpperCase()},sign:function(){return 0>this?-1:+(0<this)},base:function(a){return!a||isNaN(a)?0:Math.floor(this/a)*a},lead:function(a,h){return(this+"").replace(/\d+/,function(f){return 1<(a-=f.length-1)?Array(a).join(h||0)+f:f})},group:function(a,h){return(this+
"").replace(/\d+/,function(f){return f.replace(/\d/g,function(c,s){return!s+(f.length-s)%(a||3)?c:(h||" ")+c})})},format:function(a,h,f,c,s){a=this.toFixed(a);if(h||s)a=a.replace(/(\d+)(\.?)/,function(a,f,c){return(h?Number(f).group(3,h):f)+(c?s||c:"")});f&&(a=a.replace(/^-?/,"$&"+(f||"")));return a+(c||"")}});b(Date,{now:function(){return+new Date}});1900>(new Date).getYear()&&H(Date.prototype,{getYear:function(){return this.getFullYear()-1900},setYear:function(a){return this.setFullYear(!isNaN(a)&&
100>a?Number(a)+1900:a)}});var f=function(){function a(){if("complete"==F.readyState&&!f++)for(;c;)c.callback.call(c.context),c=c.next}function h(){try{F.documentElement.doScroll("left"),a()}catch(f){setTimeout(h,1)}}var f=!F||"complete"==F.readyState,c;if(!f)if(F.addEventListener)F.addEventListener("DOMContentLoaded",a,!1),g.addEventListener("load",a,!1);else{F.attachEvent("onreadystatechange",a);g.attachEvent("onload",a);try{!g.frameElement&&F.documentElement.doScroll&&h()}catch(s){}}return function(a,
h){f?a.call(h):c={callback:a,context:h,next:c}}}(),s=function(){function a(c){f.globalDestroy=!0;f.add=y;for(f.remove=y;c=h.pop();)if("function"==typeof c.destroy)try{c.destroy()}catch(s){}else for(var w in c)c[w]=null;h.clear()}var h=[];if("attachEvent"in g)g.attachEvent("onunload",a);else if("addEventListener"in g)g.addEventListener("unload",a,!1);else return{add:y,remove:y};var f={add:function(a){null!=a&&h.push(a)},remove:function(a){h.remove(a)}};return f}(),S=D("basis").extend({filename_:d,
NODE_ENV:m,config:k,platformFeature:{},namespace:D,require:a,resource:K,asset:function(a){return a},getter:x,ready:f,setImmediate:I,clearImmediate:r,nextTick:function(){I.apply(null,arguments)},Class:E,Token:L,DeferredToken:c,cleaner:s,console:G,object:{extend:H,complete:b,keys:function(a){var h=[],f;for(f in a)h.push(f);return h},values:function(a){var h=[],f;for(f in a)h.push(a[f]);return h},slice:t,splice:function(a,h){var f={};if(!h)return H(f,a);for(var c=0,s;s=h[c++];)s in a&&(f[s]=a[s],delete a[s]);
return f},merge:function(){return v(arguments).reduce(H,{})},iterate:J,coalesce:function(){for(var a=0;a<arguments.length;a++)if(null!=arguments[a])return arguments[a]}},fn:{$undefined:function(a){return void 0==a},$defined:function(a){return void 0!=a},$isNull:A,$isNotNull:function(a){return null!=a&&void 0!=a},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:P,$const:z,$false:function(){return!1},$true:function(){return!0},$null:function(){return null},$undef:y,
getter:x,nullGetter:N,def:function(a,h,f){f=f||A;return function(c){c=a(c);return f(c)?h:c}},wrapper:function(a){return function(h){var f={};f[a]=h;return f}},lazyInit:function(a,h){var f=0,c,s;return c=function(){f++||(c.inited=!0,c.data=s=a.apply(h||this,arguments));return s}},lazyInitAndRun:function(a,h,f){var c=0,s,w;return s=function(){c++||(s.inited=!0,s.data=w=a.call(f||this));h.apply(w,arguments);return w}},runOnce:function(a,h){var f=0;return function(){if(!f++)return a.apply(h||this,arguments)}},
body:function(a){return a.toString().replace(/^\s*\(?\s*function[^(]*\([^\)]*\)[^{]*\{|\}\s*\)?\s*$/g,"")}},array:H(v,{from:v,create:p}),string:{entity:{laquo:"«",raquo:"»",nbsp:" ",quot:'"',quote:'"',copy:"©",shy:"­",para:"¶",sect:"§",deg:"°",mdash:"—",hellip:"…"},isEmpty:function(a){return null==a||""==String(a)},isNotEmpty:function(a){return null!=a&&""!=String(a)},format:String.prototype.format},bool:{invert:function(a){return!a}}});D("basis.dev").extend(G);S.path=e;k.extClass&&(H(Object,S.object),
H(Function,S.fn),H(Array,S.array),H(String,S.string));k.autoload&&a(k.autoload)})(this);[["basis.app",function(g,H,b,t,J,A,P){function z(b){y.title=b}var y=t.document||{title:"unknown"},v=y.title,p=b.fn.$undef,F,q,C=b.fn.lazyInit(function(g){var t={setTitle:function(r){r!=v&&(v instanceof b.Token&&v.detach(z),r instanceof b.Token?(r.attach(z),z(r.get())):z(r),v=r)},setElement:function(b){b="string"==typeof b?y.getElementById(b):b;q!=b&&(q?q.parentNode.replaceChild(b,q):(q=b,F||(F={type:"container",
node:y.body}),(b="string"==typeof F.node?y.getElementById(F.node):F.node)&&("container"==F.type?b.appendChild(q):b.parentNode.replaceChild(q,b))))}},G;for(G in g){var I=g[G];switch(G){case "title":t.setTitle(I);break;case "container":F={type:"insert",node:I};break;case "replace":F={type:"replace",node:I};break;case "element":q=I;break;case "init":p="function"==typeof I?I:p}}b.ready(function(){var b=q,m=p.call(t);m&&(b=m.element?m.element:m);q=null;t.setElement(b)});return t});H.setWrapper(function(){return C.apply(this,
arguments)});H.exports={create:C}}],["basis.timer",function(g,H,b,t,J,A,P){var z=b.cleaner,y=b.getter,v=b.setImmediate,p=b.clearImmediate;t.setImmediate||(t.setImmediate=v,t.clearImmediate=p);t.nativeSetTimeout_=t.setTimeout;t.nativeClearTimeout_=t.clearTimeout;t.setTimeout=function(b,g){return isNaN(g)||0>=g?"basisjs.setImmediate"+v(b):t.nativeSetTimeout_(b,g)};t.clearTimeout=function(b){var g=String(b).split("basisjs.setImmediate")[1];return g?p(g):t.nativeClearTimeout_(b)};g=function(){function b(){if(!e)if(G.length){var d=
Date.now(),k=Math.max(G[0].eventTime,d);k<r&&(clearTimeout(m),m=setTimeout(p,(r=k)-d))}else m=clearTimeout(m),r=x}function g(d,e){var m=d.basisObjectId,D=I[e]&&I[e][m];D&&(G.remove(D),delete I[e][m],b())}function p(){var d=Date.now(),d=G.binarySearchPos(d+15,t);e=!0;G.splice(0,d).forEach(function(b){delete I[b.eventName][b.object.basisObjectId];b.callback.call(b.object)});e=!1;r=x;b()}var x=2E12,t=y("eventTime"),G=[],I={},r=x,m=null,e=!1;z.add({destroy:function(){e=!0;clearTimeout(m);G.length=0;I=
null}});return{add:function(d,e,m){var D=d.basisObjectId,E=I[e];E||(E=I[e]={});var L=E[D];if(L){if(isNaN(m)){g(d,e);return}if(L.eventTime==m)return;G.remove(L);L.eventTime=m}else{if(isNaN(m))return;L=E[D]={eventName:e,object:d,eventTime:m,callback:d[e]}}G.splice(G.binarySearchPos(m,t),0,L);b()},remove:g}}();H.exports={nextTick:b.nextTick,setImmediate:v,clearImmediate:p,add:g.add,remove:g.remove};H.exports.TimeEventManager=g}],["basis.l10n",function(g,H,b,t,J,A,P){function z(b){1<arguments.length&&
(b=C(arguments).join("."));if("#"==b.charAt(0))return x[parseInt(b.substr(1),36)];var d=b.lastIndexOf(".");return v(b.substr(0,d),!0).getToken(b.substr(d+1))}function y(b){return function(d){for(var e=0,c;c=b[e++];)if(c=this.getCultureValue(c,d))return c;return this.getCultureValue("base",d)}}function v(b,d){var e=I[b];!e&&d&&(e=I[b]=new m(b));return e}function p(b,d,e){v(b,!0).update(d,e)}function F(b,d,e){if(b)if(Array.isArray(b)){e=0;for(var c,l,B=0;B<b.length;B++,e++)l=b[B],"number"==typeof l?
e+=l:(c=x[e])&&c.dictionary.setCultureValue(d,c.name,l)}else if(e)b[e]&&p(e,d,b[e]);else for(e in b)p(e,d,b[e])}function q(e,k){function m(c){if("base"!=c&&(!d||-1!=d.indexOf(c))&&e.location){var l=e.location+"/"+c,k=b.resource(l+".json");G[l]||(G[l]=!0,k.attach(function(b){F(b,c)}));F(k(),c,e.name)}}if(R[k])for(var c=0,l;l=R[k][c];c++)m(l);m(k)}g=this.path;t=b.Class;var C=b.array.from,x=[],N=t(b.Token,{className:g+".Token",init:function(d,e){b.Token.prototype.init.call(this,null);this.dictionary=
d;this.name=e;x.push(this)},toString:function(){return this.value}}),G={},I={},r=[],m=t(null,{className:g+".Dictionary",name:"[noname]",tokens:null,resources:null,init:function(b){this.name=b;this.tokens={};this.resources={}},update:function(b,d){for(var e in this.tokens)d[e]||this.setCultureValue(b,e,"");for(e in d)this.setCultureValue(b,e,d[e])},setCulture:function(b){for(var d in this.tokens)this.setTokenValue(b,d)},getTokenValue:function(b,d){return this.getCultureValue(b,d)||this.getCultureValue("base",
d)},setTokenValue:function(b,d){this.tokens[d].set(k[b]?k[b].call(this,d):this.getTokenValue(b,d))},getCultureValue:function(b,d){return this.resources[b]&&this.resources[b][d]},setCultureValue:function(b,d,k){var c=this.resources[b];c||(c=this.resources[b]={});c[d]=k;this.tokens[d]&&("base"==b||b==e)&&this.setTokenValue(e,d)},getToken:function(b){!1==b in this.tokens&&(this.tokens[b]=new N(this,b),this.setTokenValue(e,b));return this.tokens[b]},destroy:function(){this.resources=this.tokens=null}}),
e="base",d=[],k={},R={},D=[];H.exports={Token:N,token:z,getToken:function(){return z.apply(this,arguments)},getDictionary:v,createDictionary:function(b,d,k){var c=v(b),c=v(b,!0);c.location=d;if(Array.isArray(k)){d=0;for(var l,B,m=0;m<k.length;m++,d++)B=k[m],"number"==typeof B?d+=B:(l=x[d])&&l.dictionary.setCultureValue("base",l.name,B)}else c.update("base",k);q(c,e);for(k=0;c=r[k];k++)c.handler.call(c.context,b)},updateDictionary:p,getDictionaries:function(){return I},addCreateDictionaryHandler:function(b,
d){for(var e=0,c;c=r[e];e++)if(c.handler==b&&c.context==d)return!1;r.push({handler:b,context:d});return!0},removeCreateDictionaryHandler:function(b,d){for(var e=0,c;c=r[e];e++)if(c.handler==b&&c.context==d)return r.splice(e,1),!0;return!1},getCulture:function(){return e},setCulture:function(b){b||(b="base");if(e!=b){e=b;for(var d in I){var k=I[d],c=e;q(k,c);k.setCulture(c)}for(d=0;k=D[d];d++)k.fn.call(k.context,b)}},getCultureList:function(){return d},setCultureList:function(b){"string"==typeof b&&
(b=b.qw());for(var e=[],m,c=0;m=b[c];c++)m=m.split("/"),e.push(m[0]),k[m[0]]=y(m),R[m[0]]=m.slice(1);d=e},loadCultureForDictionary:q,onCultureChange:function(b,d,k){D.push({fn:b,context:d});k&&b.call(d,e)}};(function(){for(var d=b.resource("_l10nIndex_").fetch().split(/([\<\>\#])/),e=[],k=0;k<d.length;k++)switch(d[k]){case "#":e.length=0;break;case "<":e.pop();break;case ">":break;default:d[k]&&(e.push(d[k]),z(e.join(".")))}})()}],["basis.event",function(g,H,b,t,J,A,P){function z(b){var g=q[b];g||
(g=function(){for(var g=this,I,r;g=g.handler;)r=g.callbacks[b],"function"==typeof r&&r.apply(g.context||this,I||(I=[this].concat(v.call(arguments)))),r=g.callbacks["*"],"function"==typeof r&&r.call(g.context||this,{sender:this,type:b,args:arguments});p&&this.emit_debug&&this.emit_debug({sender:this,type:b,args:arguments})},p&&(g=(new Function("slice, DEVMODE",'return {"'+y+".events."+b+'":\n\n      function('+v.call(arguments,1).join(", ")+"){"+g.toString().replace(/\beventName\b/g,"'"+b+"'").replace(/^function[^(]*\(\)[^{]*\{|\}$/g,
"")+'}\n\n}["'+y+".events."+b+'"];'))(v,p)),q[b]=g);return g}var y=this.path;g=b.Class;var v=Array.prototype.slice,p=!1,F={},q={},C=function(){throw 7;};g=g(null,{className:y+".Emitter",extendConstructor_:!0,handler:null,emit_destroy:z("destroy"),listen:g.nestedExtendProperty(),init:function(){this.handler&&!this.handler.callbacks&&(p&&"handlerContext"in this&&b.dev.warn(this.constructor.className+": handlerContext is obsolete. Use # handler: { callbacks: {..}, context: <handlerContext> } # instead."),
this.handler={callbacks:this.handler,context:this,handler:null})},addHandler:function(g,t){p&&!g&&b.dev.warn(this.constructor.className+"#addHandler: callbacks is not an object (",g,")");t=t||this;if(p)for(var G=this;G=G.handler;)if(G.callbacks===g&&G.context===t){b.dev.warn(this.constructor.className+"#addHandler: add duplicate event callbacks",g,"to Emitter instance:",this);break}this.handler={callbacks:g,context:t,handler:this.handler}},removeHandler:function(g,t){var G=this,I;for(t=t||this;I=
G,G=G.handler;)if(G.callbacks===g&&G.context===t){G.callbacks=F;I.handler=G.handler;return}p&&I!==this&&b.dev.warn(this.constructor.className+"#removeHandler: no handler removed")},destroy:function(){p&&(this.destroy=C);this.emit_destroy();this.handler=null}});p&&g.extend({handler_list:function(){for(var b=[],g=this;g=g.handler;)b.push([g.callbacks,g.context]);return b},emit_debug:null});H.exports={create:z,createHandler:function(b,g){var G={events:[]};if(b){b=String(b).trim().split(/\s+|\s*,\s*/).sort();
for(var G={events:b},t=0,r;r=b[t];t++)"destroy"!=r&&(G[r]=g)}return G},events:q,Emitter:g}}],["basis.data",function(g,H,b,t,J,A,P){function z(a,c){return function(){a.apply(this,arguments);c.apply(this,arguments)}}function y(a){var c=L[a];if(!c)for(var b=[],d={},e=1,c=L[a]={actions:b,handler:d};a;){if(a&1){var l=R[e],h;for(h in l.handler)b.push(l.action),d[h]=d[h]?z(d[h],l.handler[h]):l.handler[h]}e<<=1;a>>=1}return c}function v(a,c){for(;c&&c!==a&&c!==c.delegate;)c=c.delegate;return c===a}function p(a,
c){var b={},d;a&&a.length&&(d=b.inserted=a);c&&c.length&&(d=b.deleted=c);if(d)return b}function F(a,c){var b=[],d=[];if(!a||!a.itemCount)b=c.getItems();else if(!c||!c.itemCount)d=a.getItems();else{for(var e in a.items_){var l=a.items_[e];!1==l.basisObjectId in c.items_&&d.push(l)}for(e in c.items_)l=c.items_[e],!1==l.basisObjectId in a.items_&&b.push(l)}return p(b,d)}function q(a){return Array.isArray(a)?a.map(function(a){return{data:a}}):{data:a}}function C(a){if(!a||a.constructor!==Object)a={value:a};
return new B({data:a})}J=this.path;A=b.Class;var x=b.cleaner,N=b.object.values,G=b.fn.$self,I=b.event.Emitter;P=b.event.create;var r=b.event.events,m={},e=[],d={},k={priority:[],values:{},add:function(a,c){var b=a.toLowerCase();k[a]=b;d[b]=a;this.values[b]=a;c=c?this.priority.indexOf(c):-1;-1==c?this.priority.push(b):this.priority.splice(c,0,b)},getList:function(){return N(d)}};k.add("READY");k.add("DEPRECATED");k.add("UNDEFINED");k.add("ERROR");k.add("PROCESSING");var R={},D=1,E={NONE:0,ALL:0,link:function(a,
c,b){a+=c.basisObjectId;var d=b.subscribers_;d||(d=b.subscribers_={});d[a]||(d[a]=c,1==(b.subscriberCount+=1)&&b.emit_subscribersChanged(1))},unlink:function(a,c,b){a+=c.basisObjectId;if((c=b.subscribers_)&&c[a])if(delete c[a],0==(b.subscriberCount-=1))b.emit_subscribersChanged(-1),b.subscribers_=null},add:function(a,c,b){R[D]={handler:c,action:b};E[a]=D;E.ALL|=D;D<<=1},addProperty:function(a,c){var b={};b[c||a+"Changed"]=function(c,b){b&&E.unlink(a,c,b);c[a]&&E.link(a,c,c[a])};this.add(a.toUpperCase(),
b,function(c,b){b[a]&&c(a,b,b[a])})}},L={};E.addProperty("delegate");E.addProperty("target");E.addProperty("dataset");var O=A(I,{className:J+".AbstractData",state:k.UNDEFINED,emit_stateChanged:P("stateChanged","oldState"),active:!1,emit_activeChanged:P("activeChanged"),subscribeTo:E.NONE,subscriberCount:0,subscribers_:null,emit_subscribersChanged:P("subscribersChanged","delta"),syncEvents:A.oneFunctionProperty(function(){this.isSyncRequired()&&this.syncAction()},{stateChanged:!0,subscribersChanged:!0}),
syncAction:null,init:function(){I.prototype.init.call(this);this.active&&this.addHandler(y(this.subscribeTo).handler);var a=this.syncAction;a&&(this.syncAction=null,this.setSyncAction(a))},setState:function(a,c){var b=String(a);if(!d[b])throw 6;if(this.state!=b||this.state.data!=c){var e=this.state;this.state=Object(b);this.state.data=c;this.emit_stateChanged(e);return!0}return!1},deprecate:function(){this.state!=k.PROCESSING&&this.setState(k.DEPRECATED)},setActive:function(a){a=!!a;if(this.active!=
a){this.active=a;this.emit_activeChanged();if(a){a=y(this.subscribeTo);for(var c=0,b;b=a.actions[c];c++)b(E.link,this);this.addHandler(a.handler)}else{a=y(this.subscribeTo);for(c=0;b=a.actions[c++];)b(E.unlink,this);this.removeHandler(a.handler)}return!0}return!1},setSubscription:function(a){var c=this.subscribeTo,b=a&E.ALL;if(a=c^b){this.subscribeTo=b;if(this.active){var d=y(c),b=y(b);this.removeHandler(d.handler);this.addHandler(b.handler);for(d=1;a;)a&1&&(b=R[d],c&d?b.action(E.unlink,this):b.action(E.link,
this)),d<<=1,a>>=1}return!0}return!1},isSyncRequired:function(){return 0<this.subscriberCount&&(this.state==k.UNDEFINED||this.state==k.DEPRECATED)},setSyncAction:function(a){var c=this.syncAction;"function"!=typeof a&&(a=null);(this.syncAction=a)?(c||this.addHandler(this.syncEvents),this.isSyncRequired()&&this.syncAction()):c&&this.removeHandler(this.syncEvents)},destroy:function(){if(this.active)for(var a=y(this.subscribeTo),c=0,b;b=a.actions[c];c++)b(E.unlink,this);I.prototype.destroy.call(this);
this.state=k.UNDEFINED}}),c={},l={change:function(a){for(var c=this;c=c.tokens_;)c.token.set(c.fn(a.value))}};g=A(O,{className:J+".Value",emit_change:P("change","curValue","oldValue"),value:null,initValue:null,proxy:null,locked:!1,lockedValue_:null,tokens_:null,init:function(){O.prototype.init.call(this);this.proxy&&(this.value=this.proxy(this.value));this.initValue=this.value},set:function(a){var c=this.value;a=this.proxy?this.proxy(a):a;var b=a!==c;b&&(this.value=a,this.locked||this.emit_change(a,
c));return b},reset:function(){this.set(this.initValue)},lock:function(){this.locked||(this.locked=!0,this.lockedValue_=this.value)},unlock:function(){this.locked&&(this.locked=!1,this.value!==this.lockedValue_&&(this.emit_change(this.value,this.lockedValue_),this.lockedValue_=null))},compute:function(a,d){d||(d=a,a=null);var e=this,l=b.event.createHandler(a,function(a){this.set(d(a,e.value))}),k=l.events.concat(String(d),this.basisObjectId).join("_"),B=c[k];if(!B){var h={};l.destroy=function(a){delete h[a.basisObjectId];
this.destroy()};this.addHandler({change:function(){for(var a in h){var c=h[a];c.token.set(d(c.object,this.value))}},destroy:function(){for(var a in h){var c=h[a];c.object.removeHandler(l,c.token);c.token.destroy()}e=h=null}});B=c[k]=function(a){var c=a.basisObjectId,k=h[c];k||(k=new b.Token(d(a,e.value)),a.addHandler(l,k),k=h[c]={token:k,object:a});return k.token};B.deferred=function(){return function(a){return B(a).deferred()}}}return B},as:function(a,c){"function"!=typeof a&&(a=b.fn.$self);if(this.tokens_)for(var d=
this;d=d.tokens_;){if(d.fn==String(a))return c?d.token.deferred():d.token}else this.addHandler(l);d=new b.Token(a(this.value));this.tokens_={fn:a,token:d,tokens_:this.tokens_};return c?d.deferred():d},deferred:function(a){return this.as(a,!0)},destroy:function(){O.prototype.destroy.call(this);this.tokens_=this.lockedValue_=this.value=this.initValue=this.proxy=null}});var B=A(O,{className:J+".Object",subscribeTo:E.DELEGATE+E.TARGET,data:null,emit_update:P("update","delta"),delegate:null,canSetDelegate:!0,
emit_delegateChanged:P("delegateChanged","oldDelegate"),isTarget:!1,target:null,emit_targetChanged:P("targetChanged","oldTarget"),root:null,emit_rootChanged:P("rootChanged","oldRoot"),cascadeDestroy:!1,listen:{delegate:{update:function(a,c){this.data=a.data;this.emit_update(c)},stateChanged:function(a,c){this.state=a.state;this.emit_stateChanged(c)},targetChanged:function(a,c){this.target=a.target;var b=this.listen.target;b&&(c&&c.removeHandler(b,this),this.target&&this.target.addHandler(b,this));
this.emit_targetChanged(c)},rootChanged:function(a,c){this.data=a.data;this.root=a.root;this.emit_rootChanged(c)},destroy:function(){this.cascadeDestroy?this.destroy():this.setDelegate()}}},init:function(){O.prototype.init.call(this);var a=this.delegate;a?(this.delegate=null,this.data=a.data,this.state=a.state,this.setDelegate(a)):(this.root=this,this.data||(this.data={}),this.isTarget&&(this.target=this))},getRootDelegate:function(){for(var a=this;a.delegate&&a.delegate!==a;)a=a.delegate;return a},
setDelegate:function(a){if(!this.canSetDelegate)return!1;if(a&&a instanceof B){if(a.delegate&&v(this,a))return!1}else a=null;if(this.delegate!==a){var c=this.state,b=this.data,d=this.delegate,e=this.target,l=this.root,h={},f=this.listen.delegate,s=(e||a)&&(!a||a.target!==e)&&this.listen.target;d&&f&&d.removeHandler(f,this);e&&s&&e.removeHandler(s,this);if(a){this.delegate=a;this.root=a.root;this.data=a.data;this.state=a.state;this.target=a.target;for(var k in a.data)!1===k in b&&(h[k]=void 0);for(k in b)b[k]!==
a.data[k]&&(h[k]=b[k]);f&&a.addHandler(f,this);a.target&&s&&a.target.addHandler(s,this);for(k in h){this.emit_update(h);break}c!==this.state&&(String(c)!=this.state||c.data!==this.state.data)&&this.emit_stateChanged(c)}else for(k in this.target=this.delegate=null,this.root=this,this.data={},b)this.data[k]=b[k];this.root!==l&&this.emit_rootChanged(l);this.target!==e&&this.emit_targetChanged(e);this.emit_delegateChanged(d);return!0}return!1},setState:function(a,c){var b=this.target||this.getRootDelegate();
return b!==this?b.setState(a,c):O.prototype.setState.call(this,a,c)},update:function(a){var c=this.target||this.getRootDelegate();if(c!==this)return c.update(a);if(a){var c={},b=!1,d;for(d in a)this.data[d]!==a[d]&&(b=!0,c[d]=this.data[d],this.data[d]=a[d]);if(b)return this.emit_update(c),c}return!1},destroy:function(){this.delegate&&this.setDelegate();O.prototype.destroy.call(this);this.data=m;this.target=this.root=null}});t=A(B,{className:J("Slot")});var Q={destroy:function(){delete this.map[this.itemId]}},
G=A(null,{className:J("KeyObjectMap"),itemClass:B,keyGetter:G,map_:null,extendConstructor_:!0,init:function(){this.map_={};x.add(this)},resolve:function(a){return this.get(this.keyGetter(a),a)},create:function(a,c){var b={};a instanceof B?b.delegate=a:b.data={id:a,title:a};return new this.itemClass(b)},get:function(a,c){var b=a instanceof B?a.basisObjectId:a,d=this.map_[b];!d&&c&&(d=this.map_[b]=this.create(a,c),d.addHandler(Q,{map:this.map_,itemId:b}));return d},destroy:function(){x.remove(this);
for(var a=N(this.map_),c=0,b;b=a[c++];)b.destroy()}}),K=A(B,{className:J+".DatasetWrapper",subscribeTo:B.prototype.subscribeTo+E.DATASET,listen:{dataset:{itemsChanged:function(a,c){this.itemCount=a.itemCount;this.emit_itemsChanged(c)},destroy:function(){this.setDataset()}}},dataset:null,emit_datasetChanged:P("datasetChanged","oldDataset"),emit_itemsChanged:P("itemsChanged","delta"),init:function(){var a=this.dataset;a&&(this.dataset=null,this.setDataset(a));B.prototype.init.call(this)},setDataset:function(a){!1==
a instanceof M&&(a=null);if(this.dataset!==a){var c=this.listen.dataset,b=this.dataset,d;c&&(b&&b.removeHandler(c,this),a&&a.addHandler(c,this));this.itemCount=a?a.itemCount:0;(d=F(b,a))&&this.emit_itemsChanged(d);this.dataset=a;this.emit_datasetChanged(b)}},destroy:function(){this.dataset&&this.setDataset();B.prototype.destroy.call(this)}}),M=A(B,{className:J("AbstractDataset"),itemCount:0,items_:null,members_:null,cache_:null,emit_itemsChanged:P("itemsChanged","delta")&&function(a){var c,b=0,d=
0,e;if(c=a.inserted)for(;e=c[b];)this.items_[e.basisObjectId]=e,b++;if(c=a.deleted)for(;e=c[d];)delete this.items_[e.basisObjectId],d++;this.itemCount+=b-d;this.cache_=null;r.itemsChanged.call(this,a)},init:function(){B.prototype.init.call(this);this.members_={};this.items_={}},has:function(a){return!(!a||!this.items_[a.basisObjectId])},getItems:function(){this.cache_||(this.cache_=N(this.items_));return this.cache_},pick:function(){for(var a in this.items_)return this.items_[a];return null},top:function(a){var c=
[];if(a)for(var b in this.items_)if(c.push(this.items_[b])>=a)break;return c},forEach:function(a){for(var c=this.getItems(),b=0;b<c.length;b++)a(c[b])},clear:function(){},destroy:function(){this.clear();B.prototype.destroy.call(this);this.cache_=e;this.itemCount=0;this.items_=this.members_=null}});J=A(M,{className:J("Dataset"),listen:{item:{destroy:function(a){this.remove([a])}}},init:function(){M.prototype.init.call(this);var a=this.items;a&&(this.items=null,this.set(a))},add:function(a){var c=this.members_,
b=this.listen.item,d=[],e;a&&!Array.isArray(a)&&(a=[a]);for(var l=0;l<a.length;l++){var h=a[l];if(h instanceof B){var f=h.basisObjectId;c[f]||(c[f]=h,b&&h.addHandler(b,this),d.push(h))}}d.length&&this.emit_itemsChanged(e={inserted:d});return e},remove:function(a){var c=this.members_,b=this.listen.item,d=[],e;a&&!Array.isArray(a)&&(a=[a]);for(var l=0;l<a.length;l++){var h=a[l];if(h instanceof B){var f=h.basisObjectId;c[f]&&(b&&h.removeHandler(b,this),delete c[f],d.push(h))}}d.length&&this.emit_itemsChanged(e=
{deleted:d});return e},set:function(a){if(!this.itemCount)return this.add(a);if(!a||!a.length)return this.clear();for(var c=this.members_,b=this.listen.item,d={},e=[],l=[],h,f,s,k=0;k<a.length;k++)h=a[k],h instanceof B&&(f=h.basisObjectId,d[f]=h,c[f]||(c[f]=h,b&&h.addHandler(b,this),l.push(h)));for(f in c)d[f]||(h=c[f],b&&h.removeHandler(b,this),delete c[f],e.push(h));(s=p(l,e))&&this.emit_itemsChanged(s);return s},sync:function(a){a=this.set(a)||{};var c=a.deleted;if(c)for(var b=0,d;d=c[b];b++)d.destroy();
return a.inserted},clear:function(){var a=this.getItems(),c=this.listen.item,b;if(a.length){if(c)for(b=0;b<a.length;b++)a[b].removeHandler(c,this);this.emit_itemsChanged(b={deleted:a});this.members_={}}return b}});J.setAccumulateState=function(){function a(){var a=f;f={};for(var h in a){var c=a[h];l.call(c.dataset,c)}}function c(a){var h=this.basisObjectId,b=a.inserted,d=a.deleted,e=f[h];if(b&&d)e&&(delete f[h],l.call(e.dataset,e)),l.call(this,a);else{if(e){var k=e[b?"inserted":"deleted"];if(k){k.push.apply(k,
b||d);return}l.call(e.dataset,e)}f[h]=a;a.dataset=this}}function d(){h=null;k&&(k=0,e.emit_itemsChanged=l,a())}var e=M.prototype,l=e.emit_itemsChanged,k=0,h,f={};return function(f){f?(0==k&&(e.emit_itemsChanged=c,h||(h=b.setImmediate(d))),k++):(k-=0<k,0==k&&(e.emit_itemsChanged=l,a()))}}();H.setWrapper(function(a){return q(a)});H.exports={STATE:k,SUBSCRIPTION:E,AbstractData:O,Value:g,Object:B,Slot:t,KeyObjectMap:G,AbstractDataset:M,Dataset:J,DatasetWrapper:K,isConnected:v,getDatasetDelta:F,wrapData:q,
wrapObject:C,wrap:function(a,c){var b=c?C:q;return Array.isArray(a)?a.map(b):b(a)}}}],["basis.dom.wrapper",function(g,H,b,t,J,A,P){function z(a){return a.sortingValue||0}function y(a,f){a=a.sortingValue||0;f=f.sortingValue||0;return+(a>f)||-(a<f)}function v(a,f){a=a.sortingValue||0;f=f.sortingValue||0;return-(a>f)||+(a<f)}function p(a){return a.childNodes.sort(a.sortingDesc?v:y)}function F(a,f,c,b,d){if(f!==c){var e=a,l=[];b&&(a.contextSelection=c,a.selected&&l.push(a));for(;e;){if((b=!e.selection||
d&&e===a?e.firstChild:null)&&b.contextSelection!==f)throw 8;for(;!b;){if(e===a){l.length&&(f&&f.remove(l),c&&c.add(l));return}b=e.nextSibling;b||(e=e.parentNode)}e=b;e.selected&&l.push(e);e.contextSelection=c}}}function q(a,f){a.contextDisabled!=f&&(a.contextDisabled=f,a.disabled||(f?a.emit_disable():a.emit_enable()))}function C(a,f){var c=f.length-1;a.childNodes=f;a.firstChild=f[0]||null;a.lastChild=f[c]||null;for(var b=c;c=f[b];b--)c.nextSibling=f[b+1]||null,c.previousSibling=f[b-1]||null,a.insertBefore(c,
c.nextSibling)}function x(a,f){var c;if("function"==typeof a.childFactory&&(c=a.childFactory(f),c instanceof a.childClass))return c;if(!c)throw 11;throw 12;}g=this.path;var N=b.Class,G=b.object.complete,I=b.array.from,r=b.fn.$undef,m=b.getter,e=b.fn.nullGetter;t=N.oneFunctionProperty;J=b.event.create;var d=b.event.events;A=b.data.SUBSCRIPTION;var k=b.data.STATE,R=b.data.AbstractData,D=b.data.Object,E=b.data.AbstractDataset,L=b.data.Dataset,O={ANY:!0,NONE:!1,PARENT:"parent",OWNER:"owner"},c={};A.addProperty("owner");
A.addProperty("dataSource");var l=N.customExtendProperty({},function(a,f){for(var c in f){var b=f[c];N.isClass(b)&&(b={instanceOf:b});if(b&&"object"==typeof b){var d=!1,e={instanceOf:b.instanceOf},l={key:c,config:e};typeof b.config&&(e.config=b.config);"function"==typeof b.existsIf&&(d=e.existsIf=b.existsIf);"function"==typeof b.delegate&&(d=e.delegate=b.delegate);"function"==typeof b.dataSource&&(d=e.dataSource=b.dataSource);if(d){var b=Q.__extend__(b.hook||{update:!0}),k;for(k in b)if(b[k]===B){l.hook=
b;break}}a[c]=l}else a[c]=null}}),B=function(){var a=this.owner,f=this.context.key,c=this.context.config,b=!c.existsIf||c.existsIf(a),d=a.satellite[f];b?d?(c.delegate&&d.setDelegate(c.delegate(a)),c.dataSource&&d.setDataSource(c.dataSource(a))):(b=("function"==typeof c.config?c.config(a):c.config)||{},b.owner=a,c.delegate&&(b.delegate=c.delegate(a)),c.dataSource&&(b.dataSource=c.dataSource(a)),d=new c.instanceOf(b),a.satellite[f]=d,a.emit_satelliteChanged(f,null),a.listen.satellite&&d.addHandler(a.listen.satellite,
a)):d&&(delete a.satellite[f],a.emit_satelliteChanged(f,d),d.destroy())},Q=t(B,{}),K=N(D,{className:g+".AbstractNode",subscribeTo:D.prototype.subscribeTo+A.DATASOURCE,isSyncRequired:function(){return this.state==k.UNDEFINED||this.state==k.DEPRECATED},syncEvents:{activeChanged:!1},emit_update:function(a){D.prototype.emit_update.call(this,a);if(a=this.parentNode)a.matchFunction&&this.match(a.matchFunction),a.insertBefore(this,this.nextSibling)},listen:{owner:{destroy:function(){this.setOwner()}}},autoDelegate:O.NONE,
nodeType:"DOMWrapperNode",name:null,childNodes:null,emit_childNodesModified:J("childNodesModified","delta")&&function(a){d.childNodesModified.call(this,a);var f=this.listen.childNode,c;if(f){if(c=a.inserted)for(var b=0,e;e=c[b];b++)e.addHandler(f,this);if(c=a.deleted)for(b=0;e=c[b];b++)e.removeHandler(f,this)}},childNodesState:k.UNDEFINED,emit_childNodesStateChanged:J("childNodesStateChanged","oldState"),childClass:K,dataSource:null,emit_dataSourceChanged:J("dataSourceChanged","oldDataSource"),dataSourceMap_:null,
destroyDataSourceMember:!0,parentNode:null,nextSibling:null,previousSibling:null,firstChild:null,lastChild:null,sorting:e,sortingDesc:!1,emit_sortingChanged:J("sortingChanged","oldSorting","oldSortingDesc"),grouping:null,emit_groupingChanged:J("groupingChanged","oldGrouping"),groupingClass:null,groupNode:null,groupId:NaN,satelliteConfig:l,satellite:null,emit_satelliteChanged:J("satelliteChanged","key","oldSatellite"),owner:null,emit_ownerChanged:J("ownerChanged","oldOwner"),init:function(){D.prototype.init.call(this);
var a=this.childNodes,f=this.dataSource;a&&(this.childNodes=null);f&&(this.dataSource=null);var c=this.grouping;c&&(this.grouping=null,this.setGrouping(c));this.childClass&&(this.childNodes=[],f?this.setDataSource(f):a&&this.setChildNodes(a));a=this.satellite;this.satellite={};if(a)for(var b in a)this.setSatellite(b,a[b]);if(this.satelliteConfig!==l)for(b in this.satelliteConfig)if((a=this.satelliteConfig[b])&&"object"==typeof a)f={context:a,owner:this},a.hook&&this.addHandler(a.hook,f),B.call(f);
if(b=this.owner)this.owner=null,this.setOwner(b)},setChildNodesState:function(a,f){var c=String(a),b=this.childNodesState;if(!k.values[c])throw 9;if(b!=c||b.data!=f)this.childNodesState=Object(c),this.childNodesState.data=f,this.emit_childNodesStateChanged(b)},appendChild:function(a){},insertBefore:function(a,f){},removeChild:function(a){},replaceChild:function(a,f){},clear:function(a){},setChildNodes:function(a){},setGrouping:function(a,f){},setSorting:function(a,f){},setDataSource:function(a){},
setOwner:function(a){if(!a||!1==a instanceof K)a=null;if(a&&this.parentNode)throw 10;var f=this.owner;if(f!==a){var c=this.listen.owner;c&&(f&&f.removeHandler(c,this),a&&a.addHandler(c,this));this.owner=a;this.emit_ownerChanged(f);(this.autoDelegate==O.OWNER||this.autoDelegate===O.ANY)&&this.setDelegate(a)}},setSatellite:function(a,f){var c=this.satellite[a];!1==f instanceof R&&(f=null);if(c!=f&&!this.satelliteConfig[a]){var b=this.listen.satellite;c&&(c instanceof K&&c.setOwner(null),b&&c.removeHandler(b,
this));f?this.satellite[a]=f:delete this.satellite[a];f&&(f instanceof K&&f.setOwner(this),b&&f.addHandler(b,this));this.emit_satelliteChanged(a,c)}},getChildNodesDataset:function(){return c[this.basisObjectId]||new V({sourceNode:this})},destroy:function(){D.prototype.destroy.call(this);this.dataSource?this.setDataSource():this.firstChild&&this.clear();this.parentNode&&this.parentNode.removeChild(this);this.grouping&&(this.grouping.setOwner(),this.grouping=null);this.owner&&this.setOwner();if(this.satellite){for(var a in this.satellite){var f=
this.satellite[a];f.owner=null;f.destroy()}this.satellite=null}this.lastChild=this.firstChild=this.nextSibling=this.previousSibling=this.parentNode=this.childNodes=null}}),M=N(K,{className:g+".PartitionNode",autoDestroyIfEmpty:!1,nodes:null,first:null,last:null,init:function(){this.nodes=[];K.prototype.init.call(this)},insert:function(a,f){var c=this.nodes,b=f?c.indexOf(f):-1;-1==b?(c.push(a),this.last=a):c.splice(b,0,a);this.first=c[0];a.groupNode=this;this.emit_childNodesModified({inserted:[a]})},
remove:function(a){var f=this.nodes;f.remove(a)&&(this.first=f[0]||null,this.last=f[f.length-1]||null,a.groupNode=null,this.emit_childNodesModified({deleted:[a]}));!this.first&&this.autoDestroyIfEmpty&&this.destroy()},clear:function(){if(this.first){for(var a=this.nodes,f=a.length;0<f--;)a[f].groupNode=null;this.nodes=[];this.last=this.first=null;this.emit_childNodesModified({deleted:a});this.autoDestroyIfEmpty&&this.destroy()}},destroy:function(){K.prototype.destroy.call(this);this.last=this.first=
this.nodes=null}}),a={childClass:K,childFactory:null,listen:{dataSource:{itemsChanged:function(a,f){var c={},b=[];if(f.deleted)if(c.deleted=b,this.childNodes.length==f.deleted.length){for(var b=I(this.childNodes),d=0,e;e=b[d];d++)e.canSetDelegate=!0;d=this.dataSource;this.dataSource=null;this.clear(!0);this.dataSource=d;this.dataSourceMap_={}}else for(d=0;e=f.deleted[d];d++){e=e.basisObjectId;var l=this.dataSourceMap_[e];delete this.dataSourceMap_[e];l.canSetDelegate=!0;this.removeChild(l);b.push(l)}if(f.inserted){c.inserted=
[];for(d=0;e=f.inserted[d];d++)l=x(this,{cascadeDestroy:!1,delegate:e}),l.canSetDelegate=!1,this.dataSourceMap_[e.basisObjectId]=l,c.inserted.push(l),this.firstChild&&this.insertBefore(l)}this.firstChild?this.emit_childNodesModified(c):this.setChildNodes(c.inserted);if(this.destroyDataSourceMember&&b.length)for(d=0;e=b[d];d++)e.destroy()},stateChanged:function(a){this.setChildNodesState(a.state)},destroy:function(a){this.dataSource===a&&this.setDataSource()}}},getChild:function(a,f){return this.childNodes.search(a,
f)},getChildByName:function(a){return this.getChild(a,"name")},getChildren:function(a,f){return this.childNodes.filter(function(c){return f(c)==a})},appendChild:function(a){return this.insertBefore(a)},insertBefore:function(a,f){if(!this.childClass)throw 13;if(a.firstChild)for(var c=this;c=c.parentNode;)if(c===a)throw 14;var b=a&&a instanceof this.childClass;if(this.dataSource&&(!b||this.dataSourceMap_[a.delegate.basisObjectId]!==a))throw 15;b||(a=x(this,a instanceof D?{delegate:a}:a));if(a.owner)throw 16;
var b=a.parentNode===this,d=this.childNodes,l=this.grouping,k=a.groupNode,n=null,B=this.sorting,w,u=!1,m,c=-1,M,E;b&&(M=a.nextSibling,E=a.previousSibling);if(B!==e&&(f=null,w=this.sortingDesc,m=B(a)||0,b))if(m===a.sortingValue)u=!0;else if((!M||(w?M.sortingValue<=m:M.sortingValue>=m))&&(!E||(w?E.sortingValue>=m:E.sortingValue<=m)))a.sortingValue=m,u=!0;if(l){n=l.getGroupNode(a,!0);l=n.nodes;if(k===n&&(u||B===e&&M===f))return a;B!==e?k===n&&u?c=M&&M.groupNode===n?l.indexOf(M):l.length:(c=l.binarySearchPos(m,
z,w),a.sortingValue=m):c=f&&f.groupNode===n?l.indexOf(f):l.length;if(c<l.length)f=l[c];else if(n.last)f=n.last.nextSibling;else{c=n;for(f=null;(c=c.nextSibling)&&!(f=c.first););}if(a===f||b&&M===f)return k!==n&&(k&&k.remove(a),n.insert(a,f)),a;c=-1}else if(B!==e){if(u)return a;c=d.binarySearchPos(m,z,w);f=d[c];a.sortingValue=m;if(a===f||b&&M===f)return a}else{if(f&&f.parentNode!==this)throw 17;if(b){if(M===f)return a;if(a===f)throw 18;}}b?(M?(M.previousSibling=E,a.nextSibling=null):this.lastChild=
E,E?(E.nextSibling=M,a.previousSibling=null):this.firstChild=M,-1==c?d.remove(a):(w=d.indexOf(a),d.splice(w,1),c-=w<c),k&&(k.remove(a),k=null)):a.parentNode&&a.parentNode.removeChild(a);k!=n&&n.insert(a,f);if(f){-1==c&&(c=d.indexOf(f));if(-1==c)throw 19;a.nextSibling=f;d.splice(c,0,a)}else c=d.length,d.push(a),f={previousSibling:this.lastChild},this.lastChild=a;a.parentNode=this;a.previousSibling=f.previousSibling;0==c?this.firstChild=a:f.previousSibling.nextSibling=a;f.previousSibling=a;b||(F(a,
a.contextSelection,this.selection||this.contextSelection,!0),q(a,this.disabled||this.contextDisabled),a.match&&a.match(this.matchFunction),(a.autoDelegate==O.PARENT||a.autoDelegate===O.ANY)&&a.setDelegate(this),this.dataSource||this.emit_childNodesModified({inserted:[a]}),a.listen.parentNode&&this.addHandler(a.listen.parentNode,a));return a},removeChild:function(a){if(!a||a.parentNode!==this)throw 20;if(!1==a instanceof this.childClass)throw 21;if(this.dataSource&&this.dataSource.has(a.delegate))throw 22;
var f=this.childNodes.indexOf(a);if(-1==f)throw 23;this.childNodes.splice(f,1);a.parentNode=null;a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling;a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling;a.nextSibling=null;a.previousSibling=null;a.listen.parentNode&&this.removeHandler(a.listen.parentNode,a);F(a,a.contextSelection,null,!0);a.groupNode&&a.groupNode.remove(a);this.dataSource||this.emit_childNodesModified({deleted:[a]});
(a.autoDelegate==O.PARENT||a.autoDelegate===O.ANY)&&a.setDelegate();return a},replaceChild:function(a,f){if(this.dataSource)throw 24;if(null==f||f.parentNode!==this)throw 25;this.insertBefore(a,f);return this.removeChild(f)},clear:function(a){if(this.dataSource&&this.dataSource.itemCount)throw 26;if(this.firstChild){a&&F(this,this.selection||this.contextSelection,null,!1,!0);var f=this.childNodes;this.lastChild=this.firstChild=null;this.childNodes=[];this.emit_childNodesModified({deleted:f});for(var c=
f.length;0<c--;){var b=f[c];b.listen.parentNode&&b.parentNode.removeHandler(b.listen.parentNode,b);b.parentNode=null;b.groupNode=null;a?(b.nextSibling=null,b.previousSibling=null,(b.autoDelegate==O.PARENT||b.autoDelegate===O.ANY)&&b.setDelegate()):b.destroy()}if(this.grouping){f=this.grouping.childNodes;for(c=f.length-1;a=f[c];c--)a.clear()}}},setChildNodes:function(a,f){this.dataSource||this.clear(f);if(a&&(!1=="length"in a&&(a=[a]),a.length)){var c=this.emit_childNodesModified;this.emit_childNodesModified=
r;for(var b=0,d=a.length;b<d;b++)this.insertBefore(a[b]);this.emit_childNodesModified=c;this.emit_childNodesModified({inserted:this.childNodes})}},setDataSource:function(a){if(!a||!this.childClass||!1==a instanceof E)a=null;if(this.dataSource!==a){var f=this.dataSource,c=this.listen.dataSource;f&&(this.dataSource=this.dataSourceMap_=null,c&&f.removeHandler(c,this));if(this.firstChild){if(f)for(var b=0,d;d=this.childNodes[b];b++)d.canSetDelegate=!0;this.clear()}(this.dataSource=a)?(this.dataSourceMap_=
{},this.setChildNodesState(a.state),c&&(a.addHandler(c,this),a.itemCount&&c.itemsChanged&&c.itemsChanged.call(this,a,{inserted:a.getItems()}))):this.setChildNodesState(k.UNDEFINED);this.emit_dataSourceChanged(f)}},setGrouping:function(a,f){if("function"==typeof a||"string"==typeof a)a={groupGetter:a};!1==a instanceof u&&(a=a&&"object"==typeof a?new this.groupingClass(a):null);if(this.grouping!==a){var c=this.grouping,b;if(c){this.grouping=null;if(!a&&this.firstChild){b=this.sorting!==e?p(this):this.childNodes;
for(var d=b.length;0<d--;)b[d].groupNode=null;C(this,b)}c.setOwner()}if(a&&(this.grouping=a,a.setOwner(this),this.firstChild)){b=this.sorting!==e?p(this):this.childNodes;for(var d=0,l;l=b[d];d++)l.groupNode=this.grouping.getGroupNode(l,!0);for(d=0;l=b[d];d++)l.groupNode.nodes.push(l);b.length=0;for(d=this.grouping.nullGroup;d;d=d.nextSibling)l=d.nodes,d.first=l[0]||null,d.last=l[l.length-1]||null,b.push.apply(b,l),d.emit_childNodesModified({inserted:l});C(this,b)}this.emit_groupingChanged(c)}},setSorting:function(a,
f){a=m(a);f=!!f;if(this.sorting!==a||this.sortingDesc!=!!f){var c=this.sorting,b=this.sortingDesc;this.sorting=a;this.sortingDesc=!!f;if(a!==e&&this.firstChild){var d=[],l;for(l=this.firstChild;l;l=l.nextSibling)l.sortingValue=a(l)||0;if(this.grouping)for(var k=this.grouping.nullGroup;k;k=k.nextSibling)l=k.nodes=p({childNodes:k.nodes,sortingDesc:this.sortingDesc}),k.first=l[0]||null,k.last=l[l.length-1]||null,d.push.apply(d,l);else d=p(this);C(this,d)}this.emit_sortingChanged(c,b)}},setMatchFunction:function(a){if(this.matchFunction!=
a){var f=this.matchFunction;this.matchFunction=a;for(var c=this.lastChild;c;c=c.previousSibling)c.match(a);this.emit_matchFunctionChanged(f)}}},n=N(K,a,{className:g+".Node",emit_enable:J("enable")&&function(){for(var a=this.firstChild;a;a=a.nextSibling)q(a,!1);d.enable.call(this)},emit_disable:J("disable")&&function(){for(var a=this.firstChild;a;a=a.nextSibling)q(a,!0);d.disable.call(this)},emit_satelliteChanged:function(a,c){K.prototype.emit_satelliteChanged.call(this,a,c);this.satellite[a]instanceof
n&&q(this.satellite[a],this.disabled||this.contextDisabled)},emit_select:J("select"),emit_unselect:J("unselect"),emit_match:J("match"),emit_unmatch:J("unmatch"),emit_matchFunctionChanged:J("matchFunctionChanged","oldMatchFunction"),selectable:!0,selected:!1,selection:null,contextSelection:null,matchFunction:null,matched:!0,disabled:!1,contextDisabled:!1,listen:{owner:{enable:function(){q(this,!1)},disable:function(){q(this,!0)}}},init:function(){this.selection&&(!1==this.selection instanceof E&&(this.selection=
new W(this.selection)),this.listen.selection&&this.selection.addHandler(this.listen.selection,this));K.prototype.init.call(this);this.disabled&&this.emit_disable();this.selected&&(this.selected=!1,this.select(!0))},setSelection:function(a){if(this.selection!==a)return F(this,this.selection||this.contextSelection,a||this.contextSelection,!1,!0),this.selection&&this.listen.selection&&this.selection.removeHandler(this.listen.selection,this),(this.selection=a)&&this.listen.selection&&a.addHandler(this.listen.selection,
this),!0},hasOwnSelection:function(){return!!this.selection},select:function(a){var c=this.selected,b=this.contextSelection;b?a?c?b.remove([this]):b.add([this]):this.selectable&&b.set([this]):!c&&this.selectable&&(this.selected=!0,this.emit_select());return this.selected!=c},unselect:function(){var a=this.selected;if(a){var c=this.contextSelection;c?c.remove([this]):(this.selected=!1,this.emit_unselect())}return this.selected!=a},setSelected:function(a,c){return a?this.select(c):this.unselect()},
enable:function(){var a=this.disabled;a&&(this.disabled=!1,this.contextDisabled||this.emit_enable());return this.disabled!=a},disable:function(){var a=this.disabled;a||(this.disabled=!0,this.contextDisabled||this.emit_disable());return this.disabled!=a},setDisabled:function(a){return a?this.disable():this.enable()},isDisabled:function(){return this.disabled||this.contextDisabled},match:function(a){"function"!=typeof a&&(a=null);this.underMatch_&&!a&&this.underMatch_(this,!0);this.underMatch_=a;a=
!a||a(this);this.matched!=a&&((this.matched=a)?this.emit_match():this.emit_unmatch())},destroy:function(){this.unselect();this.contextSelection=null;this.selection&&this.setSelection();K.prototype.destroy.call(this)}}),u=N(K,a,{className:g+".GroupingNode",emit_childNodesModified:function(a){d.childNodesModified.call(this,a);this.nullGroup.nextSibling=this.firstChild;var c;if(c=a.inserted){a=0;for(var b;b=c[a++];)b.groupId_=b.delegate?b.delegate.basisObjectId:b.data.id,this.map_[b.groupId_]=b;if(this.dataSource&&
this.nullGroup.first){c=this.owner;b=I(this.nullGroup.nodes);for(a=b.length;0<a--;)c.insertBefore(b[a],b[a].nextSibling)}}},emit_ownerChanged:function(a){a&&a.grouping===this&&a.setGrouping(null,!0);this.owner&&this.owner.grouping!==this&&this.owner.setGrouping(this);d.ownerChanged.call(this,a);!this.owner&&this.autoDestroyWithNoOwner&&this.destroy()},map_:null,autoDestroyWithNoOwner:!0,autoDestroyEmptyGroups:!0,groupGetter:e,childClass:M,childFactory:function(a){return new this.childClass(G({autoDestroyIfEmpty:this.dataSource?
!1:this.autoDestroyEmptyGroups},a))},init:function(){this.map_={};this.nullGroup=new M;K.prototype.init.call(this)},getGroupNode:function(a,c){var b=this.groupGetter(a),d=b instanceof D,e=this.map_[d?b.basisObjectId:b];this.dataSource&&(c=!1);!e&&c&&(e=this.appendChild(d?b:{data:{id:b,title:b}}));return e||this.nullGroup},setDataSource:function(c){var f=this.dataSource;a.setDataSource.call(this,c);if((c=this.owner)&&this.dataSource!==f)for(var f=I(c.childNodes),b=f.length-1;0<=b;b--)c.insertBefore(f[b],
f[b+1])},insertBefore:function(c,f){c=a.insertBefore.call(this,c,f);var b=c.first;if(b){for(var d=b.parentNode,e=c.last,l,k,n,B=null,w=c;(w=w.nextSibling)&&!(B=w.first););n=B?B.previousSibling:d.lastChild;l=b.previousSibling;k=e.nextSibling;if(k!==B){var u=d.childNodes,w=c.nodes,m=w.length;l&&(l.nextSibling=k);k&&(k.previousSibling=l);n&&(n.nextSibling=b);B&&(B.previousSibling=e);b.previousSibling=n;e.nextSibling=B;var e=u.indexOf(b),E=B?u.indexOf(B):u.length;E>e&&(E-=m);u.splice(e,m);u.splice.apply(u,
[E,0].concat(w));if(!n||!l)d.firstChild=u[0];if(!B||!k)d.lastChild=u[u.length-1];if(b instanceof M)for(b=m;0<b--;)d.insertBefore(w[b],B),B=w[b]}}return c},removeChild:function(c){if(c=a.removeChild.call(this,c)){delete this.map_[c.groupId_];for(var f=0,b;b=c.nodes[f];f++)b.parentNode.insertBefore(b)}return c},clear:function(c){var f=[],b=this.getGroupNode,d=this.nullGroup;this.getGroupNode=function(){return d};for(var e=this.firstChild;e;e=e.nextSibling)f.push.apply(f,e.nodes);for(var e=0,l;l=f[e];e++)l.parentNode.insertBefore(l);
this.getGroupNode=b;a.clear.call(this,c);this.map_={}},destroy:function(){this.autoDestroyWithNoOwner=!1;K.prototype.destroy.call(this);this.nullGroup.destroy();this.map_=this.nullGroup=null}});K.prototype.groupingClass=u;var U={childNodesModified:function(a,c){var b=this.members_,d={},e,l=0,k=0,n=c.inserted,B=c.deleted;if(n&&n.length)for(d.inserted=n;e=n[l];)b[e.basisObjectId]=e,l++;if(B&&B.length)for(d.deleted=B;e=B[k];)delete b[e.basisObjectId],k++;(l||k)&&this.emit_itemsChanged(d)},destroy:function(){this.destroy()}},
V=N(E,{className:g+".ChildNodesDataset",sourceNode:null,init:function(){E.prototype.init.call(this);var a=this.sourceNode;c[a.basisObjectId]=this;a.firstChild&&U.childNodesModified.call(this,a,{inserted:a.childNodes});a.addHandler(U,this)},destroy:function(){this.sourceNode.removeHandler(U,this);delete c[this.sourceNode.basisObjectId];E.prototype.destroy.call(this)}}),W=N(L,{className:g+".Selection",multiple:!1,emit_itemsChanged:function(a){L.prototype.emit_itemsChanged.call(this,a);if(a.inserted)for(var c=
0,b;b=a.inserted[c];c++)b.selected||(b.selected=!0,b.emit_select());if(a.deleted)for(c=0;b=a.deleted[c];c++)b.selected&&(b.selected=!1,b.emit_unselect())},add:function(a){if(!this.multiple){if(this.itemCount)return this.set(a);a=[a[0]]}for(var c=[],b=0,d;d=a[b];b++)d.contextSelection==this&&d.selectable&&c.push(d);return L.prototype.add.call(this,c)},set:function(a){for(var c=[],b=0,d;d=a[b];b++)d.contextSelection==this&&d.selectable&&c.push(d);this.multiple||c.splice(1);return L.prototype.set.call(this,
c)}});H.exports={DELEGATE:O,AbstractNode:K,Node:n,GroupingNode:u,PartitionNode:M,Selection:W,nullSelection:new E,ChildNodesDataset:V}}],["basis.ua",function(g,H,b,t,J,A,P){function z(b){var g=1E6;b=String(b).split(".");for(var r=0,m=0;4>r&&r<b.length;r++,g/=100)m+=b[r]*g;return m}function y(b){b=b.toLowerCase();if(b in F)return F[b];var g=b.match(/^([a-z]+)(([\d\.]+)([+-=]?))?$/i);if(g){F[b]=!1;var r=g[1].toLowerCase(),m=z(g[3]),g=g[4]||"=";if(r=p[r])return F[b]=!m||"="==g&&r==m||"+"==g&&r>=m||"-"==
g&&r<m}return!1}var v=t.document;g=t.navigator&&t.navigator.userAgent||"";t=t.opera;var p={},F={},q="unknown";J={MSIE:["Internet Explorer","msie","ie"],Gecko:["Gecko","gecko"],Safari:["Safari","safari"],"iPhone OS":["iPhone","iphone"],AdobeAir:["AdobeAir","air"],AppleWebKit:["WebKit"],Chrome:["Chrome","chrome"],FireFox:["FireFox","firefox","ff"],Iceweasel:["FireFox","firefox","ff"],Shiretoko:["FireFox","firefox","ff"],Opera:["Opera","opera"]};for(var C in J)if(!("MSIE"==C&&t)&&!("Safari"==C&&/chrome/i.test(g))&&
!("AppleWebKit"==C&&/iphone/i.test(g))&&g.match(RegExp(C+".(\\d+(\\.\\d+)*)","i"))){A=J[C];q=t&&"function"==typeof t.version?t.version():RegExp.$1;P=z(q);for(var q=A[0]+" "+q,x=0;x<A.length;x++)p[A[x].toLowerCase()]=P}b.platformFeature.datauri=!1;"undefined"!=typeof Image&&function(){var g=new Image;g.onload=function(){b.platformFeature.datauri=!0};g.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}();if(y("IE7-"))try{v.execCommand("BackgroundImageCache",!1,!0)}catch(N){}H.exports=
{prettyName:q,test:function(){return b.array(arguments).some(y)},is:y,cookies:{set:function(b,g,r,m){v.cookie=b+"="+(null==g?"":escape(g))+";path="+(m||(0==location.pathname.indexOf("/")?"":"/")+location.pathname)+(r?";expires="+(new Date(Date.now()+1E3*r)).toGMTString():"")},get:function(b){return(b=v.cookie.match(RegExp("(^|;)\\s*"+b+"\\s*=\\s*(.*?)\\s*(;|$)")))&&unescape(b[2])},remove:function(b,g){v.cookie=b+"=;expires="+(new Date(0)).toGMTString()+";path="+(g||(0==location.pathname.indexOf("/")?
"":"/")+location.pathname)}}}}],["basis.dom",function(g,H,b,t,J,A,P){function z(a,c,b){return null!=c?a.insertBefore(S(c)?c:q(c),b||null):null}function y(a,c){return a.outerHTML||x("",c?a:a.cloneNode(!0)).innerHTML}function v(a){return a&&(S(a)||a.nodeType)?a:"string"==typeof a?m.getElementById(a):null}function p(a,c){var b=v(a)||m;return"*"==c&&b.all?e(b.all):e(b.getElementsByTagName(c||"*"))}function F(f,h,e){var k,s=[];e="string"==typeof e?d(e):e||b.fn.$true;h&(O|D|L)&&e(f)&&s.push(f);switch(h){case R:case D:for(k=
f;(k=k[a])&&k!==f.document;)e(k)&&s.push(k);break;case l:for(k=f[n];k;)e(k)&&s.push(k),k=k[u];break;case E:case L:f[n]&&(h=new T(f),h.nodes(e,s));break;case B:h=new T(f,e);for(h.cursor_=f[u]||f[a];k=h.next();)s.push(k);break;case Q:for(k=f;k=k[u];)e(k)&&s.push(k);break;case c:e(f[a])&&s.push(f[a]);break;case K:h=new T(f,e,T.BACKWARD);for(h.cursor_=f[U]||f[a];k=h.next();)s.push(k);break;case M:for(k=f;k=k[U];)e(k)&&s.push(k)}return s}function q(a){return m.createTextNode(null!=a?a:"")}function C(){for(var a=
m.createDocumentFragment(),c=arguments.length,b=C.array=[],f=0;f<c;f++)b.push(z(a,arguments[f]));return a}function x(a){var c=void 0!=a&&"string"!=typeof a,f=(c?a.description:a)||"",d="div",h=f.match(/^([a-z0-9_\-]+)(.*)$/i);h&&(d=h[1],f=h[2]);if(""!=f){for(var l=[],k={},s;h=da.exec(f);){if(h[8])throw 27;s=h[1]||h[2]||h[3];h[1]?k.id=s:h[2]?l.push(s):"class"!=s&&(k[s]=h[4]?h[5]||h[6]||h[7]||"":s)}aa&&(k.name&&/^(input|textarea|select)$/i.test(d))&&(d="<"+d+" name="+k.name+">")}f=m.createElement(d);
if(k){k.style&&Y&&(f.style.cssText=k.style);for(var n in k)f.setAttribute(n,k[n],0)}l&&l.length&&(f.className=l.join(" "));1<arguments.length&&z(f,C.apply(0,e(arguments,1).flatten()));if(c&&(a.css&&b.cssom&&b.cssom.setStyle(f,a.css),b.dom.event))for(var B in a)"function"==typeof a[B]?b.dom.event.addHandler(f,B,a[B],f):a[B]instanceof b.dom.event.Handler&&b.dom.event.addHandler(f,B,a[B].handler,a[B].thisObject);return f}function N(a,c,b,d){a=v(a);if(!a)throw 28;switch(b){case void 0:case W:d=null;break;
case V:d=a[n];break;case h:break;case f:d=d[u];break;default:d=Number(b).between(0,a.childNodes.length)?a.childNodes[b]:null}b=!S(a);if(!c||!Array.isArray(c))b=b?c&&a.insertBefore(c,d):z(a,c,d);else if(b){b=[];for(var e=0,l=c.length;e<l;e++)b[e]=a.insertBefore(c[e],d)}else a.insertBefore(C.apply(0,c),d),b=C.array;return b}function G(c,b){return c[a]?c[a].replaceChild(b,c):c}function I(a){if(m.selection){var c=m.selection.createRange();0!=c.compareEndPoints("StartToEnd",c)&&c.collapse(a);return c.getBookmark().charCodeAt(2)-
2}return 0}function r(a){a||(a=m||{head:null});return a.head||p(a,"head")[0]}g=this.path;var m=t.document;t=b.Class;var e=b.array.from,d=b.getter,k=m.createElement("div"),R=1,D=2,E=4,L=8,O=16,c=32,l=64,B=128,Q=256,K=512,M=1024,a="parentNode",n="firstChild",u="nextSibling",U="previousSibling",V="begin",W="end",h="before",f="after",s;s="function"==typeof k.compareDocumentPosition?function(a,c){return a.compareDocumentPosition(c)}:function(a,c){return a==c?0:a.document!=c.document?33:a.sourceIndex>c.sourceIndex?
2|8*c.contains(a):4|16*a.contains(c)};var S;"undefined"!=typeof Node?(S=function(a){return a instanceof Node},Node.prototype.contains||(Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)})):S=function(a){return a&&a.ownerDocument===m};var T=t(null,{className:g+".TreeWalker",root_:null,cursor_:null,filter:b.fn.$true,init:function(a,c,b){this.setRoot(a);this.setDirection(b);"function"==typeof c&&(this.filter=c)},setDirection:function(a){b.object.extend(this,a?{a:"lastChild",
b:U,c:u,d:n}:{a:n,b:u,c:U,d:"lastChild"})},setRoot:function(a){this.root_=a||m;this.reset()},reset:function(){this.cursor_=null},first:function(a){this.reset();return this.next(a)},last:function(a){this.reset();return this.prev(a)},nodes:function(a,c){var b;c||(c=[]);for(this.reset();b=this.next(a);)c.push(b);return c},next:function(c){c=c||this.filter;var b=this.cursor_||this.root_;do for(var f=b[this.a];!f;){if(b===this.root_)return this.cursor_=null;(f=b[this.b])||(b=b[a])}while(!c(b=f));return this.cursor_=
b},prev:function(c){c=c||this.filter;var b=this.cursor_,f=this.c,d=this.d;do{var h=b?b[f]:this.root_[d];if(h){for(;h[d];)h=h[d];b=h}else b&&(b=b[a]);if(!b||b===this.root_){b=null;break}}while(!c(b));return this.cursor_=b},destroy:function(){this.cursor_=this.root_=null}});T.BACKWARD=!0;var Z="textContent innerText nodeValue".qw(),aa=function(){var a=m.createElement("input");a.name="a";return!/name/.test(y(a))}(),Y;k.setAttribute("style","color: red");Y="red"!==k.style.color;var da=/#([a-z0-9_:\-]+)|\.([a-z0-9_:\-]+)|\[([a-z0-9_:\-]+)(="((?:\\.|[^"])*)"|='((?:\\.|[^'])*)'|=((?:\\.|[^\]])*))?\s*\]|\s*(\S)/gi;
H.exports={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_TYPE_NODE:10,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,AXIS_ANCESTOR:R,AXIS_ANCESTOR_OR_SELF:D,AXIS_DESCENDANT:E,AXIS_DESCENDANT_OR_SELF:L,AXIS_SELF:O,AXIS_PARENT:c,AXIS_CHILD:l,AXIS_FOLLOWING:B,AXIS_FOLLOWING_SIBLING:Q,AXIS_PRECEDING:K,AXIS_PRECEDING_SIBLING:M,INSERT_BEGIN:V,INSERT_END:W,INSERT_BEFORE:h,INSERT_AFTER:f,
TreeWalker:T,outerHTML:y,textContent:function(a){for(var c=0,b;b=Z[c++];)if(null!=a[b])return a[b];return F(a,E,function(a){return 3==a.nodeType}).map(d("nodeValue")).join("")},get:v,tag:p,axis:F,findAncestor:function(a,c,b){for(;a&&a!==b&&!c(a);)a=a.parentNode;return a||null},createElement:x,createText:q,createFragment:C,insert:N,remove:function(c){return c[a]?c[a].removeChild(c):c},replace:G,swap:function(a,c){if(a===c||s(a,c)&25)return!1;G(a,k);G(c,a);G(k,c);return!0},clone:function(a,c){var b=
a.cloneNode(!c);b.attachEvent&&F(b,L).forEach(Event.clearHandlers);return b},clear:function(a){for(a=v(a);a.lastChild;)a.removeChild(a.lastChild);return a},wrap:function(a,c,f){var d=[];f=b.getter(f||b.fn.$self);for(var h in c)for(var e=0;e<a.length;e++){var l=f(a[e]);d[e]=c[h](a[e],e,l)?x(h,l):a[e]}return d},setAttribute:function(a,c,b){null==b?a.removeAttribute(c):a.setAttribute(c,b)},parentOf:function(a,c){return a.contains(c)},isInside:function(a,c){return a==c||c.contains(a)},focus:function(a,
c){try{a=v(a),a.focus(),c&&a.select&&a.select()}catch(b){}},setSelectionRange:function(a,c,b){3>arguments.length&&(b=c);if(a.setSelectionRange)a.setSelectionRange(c,b);else if(a.createTextRange){var f=a.createTextRange();f.collapse(!0);f.moveStart("character",c);f.moveEnd("character",b-c);f.select()}},getSelectionStart:function(a){return"undefined"!=typeof a.selectionStart?a.selectionStart:I(!0)},getSelectionEnd:function(a){return"undefined"!=typeof a.selectionEnd?a.selectionEnd:I(!1)},head:r,body:function(a){a||
(a=m||{body:null});return a.body||p(a,"body")[0]},appendHead:function(a){m&&N(r(),a)}}}],["basis.cssom",function(g,H,b,t,J,A,P){function z(a,c){return p(c,!0).createRule(a)}function y(a,c){var b=a.match(/^([^{]+)\{(.*)\}\s*$/);if(b){for(var f=b[1].trim().split(/\s*,\s*/),d=0;d<f.length;d++)this.addRule(f[d],b[2]||null,c++);return c-1}}function v(a,c){var b=D.createElement(!a?'style[type="text/css"]':'link[type="text/css"][rel="{alt}stylesheet"][href={url}]'.format({alt:c?"alternate ":"",url:a.quote('"')}));
D.appendHead(b);b=b.sheet||b.styleSheet;try{b.cssRules||(b.cssRules=b.rules)}catch(f){}b.insertRule||(b.insertRule=y);b.deleteRule||(b.deleteRule=b.removeRule);return b}function p(a,b){a||(a="DefaultGenericStyleSheet");c[a]||b&&(c[a]=new K(v()));return c[a]}function F(a,c,f,d){d=d||{};c=c.qw();for(var h=0,e;e=c[h];h++)if("undefined"!=typeof Q.style[e]){f&&(b.platformFeature["css-"+a]=e);B[a]={key:e,getter:d[e]};break}}function q(a,c,b){var f;var d=c;f=(d=(f=B[d])?f.key:d.replace(/^-ms-/,"ms-").camelize())?
{key:d,value:f&&f.getter?f.getter(b):b}:null;if(f){var d=f.key,h=!!E.test(b);b=a.style;var e;if(!(e=h))e=b.getPropertyPriority?b.getPropertyPriority(c)==L:!1;if(e)if(f.value=f.value.replace(E,""),b.setProperty)h||b.removeProperty(d),b.setProperty(d,f.value,h?L:"");else{a=d+": "+f.value+(h?" !"+L:"")+";";c=b[d]?d+"\\s*:\\s*"+b[d]+"(\\s*!"+L+")?\\s*;?":"^";try{b.cssText=b.cssText.replace(RegExp(c,"i"),a)}catch(k){}}else{if(l)try{a.style[f.key]=f.value}catch(s){}else a.style[f.key]=f.value;return a.style[f.key]}}}
function C(a,c){return q(a,"display","string"==typeof c?c:c?"":"none")}function x(a,c){return q(a,"visibility",c?"":"hidden")}function N(a){return function(){for(var c=0,b;b=this.rules[c];c++)b[a].apply(b,arguments)}}function G(a){return u[a]||(u[a]=RegExp("\\s*\\b"+a+"\\b"))}function I(a,c){var b=(c?"g":"s")+a;return V[b]||(V[b]=RegExp((c?"":"\\s*")+"\\b"+a+"\\S*\\b"))}function r(a){T.setAttribute("href",a);D.insert(Z,T,0)}function m(){T.setAttribute("href",d.href);D.remove(T)}function e(a){return function(c){return 0==
c||isNaN(c)?"0":c+a}}A=this.path;P=t.document;var d=t.location,k=b.path,R=b.array.from;g=b.Class;J=b.cleaner;var D=b.dom;P=(t=t.DOMTokenList)&&P&&P.documentElement.classList instanceof t;var E=/\s*!important/i,L="important",O=1,c={},l=function(){var a=D.createElement();try{a.style.width="badvalue"}catch(c){return!0}return!1}(),B={},Q=D.createElement("DIV");F("opacity","opacity filter",!0,{filter:function(a){return"alpha(opacity:"+parseInt(100*a,10)+")"}});F("float","cssFloat styleFloat");var K=g(null,
{className:A+".StyleSheet",styleSheet:null,rules:null,init:function(a){this.styleSheet=a;this.rules=[]},createRule:function(c){var b=this.styleSheet,f=this.rules.length;b.insertRule(c+"{}",f);c=R(b.cssRules,f);c=c[1]?new a(c,this):new M(c[0],this);this.rules.push.apply(this.rules,c.rules||[c]);return c},deleteRule:function(c){if(c instanceof a)c.rules.forEach(this.deleteRule,this);else{var b=this.rules.indexOf(c);-1!=b&&(this.rules.splice(b,1),this.styleSheet.deleteRule(b))}c.owner=null;c.destroy()},
destroy:function(){this.rules.forEach(function(a){a.destroy()});this.rules=this.styleSheet=null}}),M=g(null,{className:A+".Rule",rule:null,selector:"",init:function(a,c){this.owner=c;this.rule=a;this.selector=a.selectorText},setProperty:function(a,c){q(this.rule,a,c)},setStyle:function(a){b.object.iterate(a,this.setProperty,this)},clear:function(){this.rule.style.cssText=""},destroy:function(){this.owner&&this.owner.deleteRule(this);this.rule=this.owner=null}}),a=g(null,{className:A+".RuleSet",rules:null,
init:function(a,c){this.owner=c;this.rules=a.map(function(a){return new M(a,this)},this)},createRule:function(a){a=this.owner.createRule(a);this.rules.push(a);a.owner=this;return a},deleteRule:function(a){var c=this.rules.indexOf(a);-1!=c&&(this.rules.splice(c,1),this.owner.deleteRule(a))},setProperty:N("setProperty"),setStyle:N("setStyle"),clear:N("clear"),destroy:function(){this.owner&&this.owner.deleteRule(this);this.rules=this.owner=null}}),n,u={},U=g(null,{className:A+".ClassList",init:function(a){this.element=
a},set_:function(a){var c=this.element.className;return"string"==typeof c?this.element.className=a:c.baseVal=a},toString:function(){var a=this.element.className;return"string"==typeof a?a:a.baseVal},set:function(a){this.clear();a.qw().forEach(this.add,this)},replace:function(a,c,b){b=b||"";"undefined"!=typeof a&&this.remove(b+a);"undefined"!=typeof c&&this.add(b+c)},bool:function(a,c){c?this.add(a):this.remove(a)},clear:function(){this.set_("")},contains:function(a){return!!this.toString().match(G(a))},
item:function(a){return this.toString().qw()[a]},add:function(a){var c=this.toString();c.match(G(a))||this.set_(c+" "+a)},remove:function(a){var c=this.toString();a=c.replace(G(a),"");a!=c&&this.set_(a)},toggle:function(a){var c=this.contains(a);c?this.remove(a):this.add(a);return!c}}),V={},W=g(null,{className:A+".ClassListNS",delim:"-",init:function(a,c){this.classList=c;this.prefix=a+this.delim},add:function(a){this.classList.add(this.prefix+a)},remove:function(a){this.classList.remove(this.prefix+
a)},items:function(){var a=this.classList.toString();return a?a.match(I(this.prefix,!0)):null},set:function(a){var c=this.items();a="undefined"!=typeof a?this.prefix+a:"";var b=this.classList;if(c)if(1==c.length){if(c[0]===a)return;b.remove(c[0])}else this.clear();a&&b.add(a)},clear:function(){this.items().forEach(this.classList.remove,this.classList)}});P?(A=U.prototype,b.object.extend(t.prototype,{set:A.set,replace:A.replace,bool:A.bool,clear:function(){for(var a=this.length;0<a;)this.remove(this[--a])},
setPrefixToken:A.setPrefixToken}),n=function(a){return("string"==typeof a?D.get(a):a).classList}):n=function(a){return new U("string"==typeof a?D.get(a):a)};var h={},f=!0,s;try{s=!D.createElement("style","")}catch(S){s=!0}var T=D.createElement("base"),Z=D.head(),aa=g(null,{inUse:0,url:"",baseURI:"",cssText:"",resource:null,element:null,textNode:null,init:function(a){this.url=k.resolve(a);this.baseURI=k.dirname(a)+"/";h[a]=this},updateCssText:function(a){this.cssText!=a&&(this.cssText=a,this.inUse&&
(r(this.baseURI),this.syncCssText(),m()))},syncCssText:function(){this.textNode?this.textNode.nodeValue=this.cssText:this.element.styleSheet.cssText=this.cssText},startUse:function(){if(!this.inUse){if(!this.resource){var a=b.resource(this.url);this.resource=a;this.cssText=a.get(!0)}r(this.baseURI);this.element||(this.element=D.createElement('style[src="'+k.relative(this.url)+'"]'),s||(this.textNode=D.insert(this.element,"")));D.appendHead(this.element);this.syncCssText();m()}this.inUse+=1},stopUse:function(){this.inUse&&
((this.inUse-=1)||D.remove(this.element))},destroy:function(){this.element&&f&&D.remove(this.element);this.cssText=this.resource=this.textNode=this.element=null}});b.resource.extensions[".css"]=function(a,c){var b=h[c];b?b.updateCssText(a):b=new aa(c);return b};b.resource.extensions[".css"].updatable=!0;J.add({destroy:function(){f=!1;for(var a in h)h[a].destroy();h=null}});H.exports={setStyleProperty:q,setStyle:function(a,c){for(var b in c)q(a,b,c[b]);return a},classList:function(a,c){return c?new W(c,
n(a)):n(a)},uniqueRule:function(a){var c="genericRule-"+O++;a&&n(a).add(c);a=z("."+c);a.token=c;return a},createRule:z,getStyleSheet:p,addStyleSheet:v,StyleSheet:K,Rule:M,RuleSet:a,display:C,visibility:x,em:e("em"),ex:e("ex"),px:e("px"),percent:e("%"),show:function(a){return C(a,!0)},hide:function(a){return C(a)},visible:function(a){return x(a,!0)},invisible:function(a){return x(a)}}}],["basis.template",function(g,H,b,t,J,A,P){function z(a){da[d.extname(a)]&&b.resource(a)().startUse()}function y(a){da[d.extname(a)]&&
b.resource(a)().stopUse()}function v(){this.instances_&&x.call(this);for(var a=0,c;c=this.attaches_[a];a++)c.handler.call(c.context)}function p(a){for(var c=[],b=0;b<a.length;b++)c.push(Array.isArray(a[b])?p(a[b]):a[b]);return c}function F(a,c,f,d){var h=a;"function"==typeof h&&(c="baseURI"in a?a.baseURI:c,h=h());h instanceof b.Token&&(c="baseURI"in a?a.baseURI:c,h=h.get());if(Array.isArray(h))f&&(h=p(h)),h={tokens:h};else if("object"!=typeof h||!Array.isArray(h.tokens))h=String(h);"string"==typeof h&&
(h=Y(h,c,d));return h}function q(a,c){return function(){for(var b=0,f;f=a[b];b++)this.tmpl.set(f,c[f](this))}}function C(a){var c={};return function(b,f){var d="bindingId"in b?b.bindingId:null,h=c[d];if(!h){for(var h=[],e={},l={},k,s=0,n;n=a[s];s++){var w=b[n],B=w&&w.getter;if(B&&(e[n]=B,h.push(n),w.events)){w=w.events;Array.isArray(w)||(w=String(w).qw());for(var B=0,u;u=w[B];B++)l[u]?l[u].push(n):(k=k||{},l[u]=[n],k[u]=q(l[u],e))}}h={names:h,events:l,sync:q(h,e),handler:k};d&&(c[d]=h)}return h}}
function x(){var a=F(this.source,this.baseURI),c=this.instances_,f=this.builder(a.tokens),d=this.l10n_,h=this.deps_;if(h){this.deps_=null;for(var e=0,l;l=h[e];e++)l.bindingBridge.detach(l,x,this)}if(a.deps&&a.deps.length){this.deps_=h=a.deps;for(e=0;l=h[e];e++)l.bindingBridge.attach(l,x,this)}if(d){this.l10n_=null;for(e=0;h=d[e];e++)h.token.detach(h.handler,h)}this.createInstance=f.createInstance;this.getBinding=C(f.keys);this.instances_=f.map;var k=f.l10nProtoSync;if(d=a.resources&&0<a.resources.length)for(e=
0;h=a.resources[e];e++)z(h);if(this.resources)for(e=0;h=this.resources[e];e++)y(h);this.resources=d&&a.resources;if(c)for(var s in c)c[s].rebuild_();if(f.l10nKeys){this.l10n_=d=[];c=f.map;for(e=0;a=f.l10nKeys[e];e++)h={path:a,token:b.l10n.token(a),handler:function(a){k(this.path,a);for(var b in c)c[b].set(this.path,a)}},h.token.attach(h.handler,h),d.push(h)}}function N(a){return function(){var c;c=(c=document.getElementById(a))&&"SCRIPT"==c.tagName?"text/basis-template"==c.type?c.textContent||c.text:
"":"";return c}}function G(){var a=b.array(arguments).join("."),c=ba[a];c||(c=new ia("",a),ba[a]=c);return c}function I(a,c){for(var b=[],f={},d=[],h=0;h<c.length;h++)f[c[h]]||(f[c[h]]=!0,d.push(c[h]));b.source=d.join("/");f={base:!0};for(d=0;d<c.length;d++)h=c[d]||"base",h==a||f[h]||(m(h),f[h]=!0,b.push(h),c.splice.apply(c,[d+1,0].concat(X[h].fallback)));b.unshift(a);"base"!=a&&b.push("base");b.value=b.join("/");return b}function r(a,c){for(var b=X[a].sourcesList,f=0,d;d=b[f];f++)if(d.hasOwnProperty(c))return d[c];
return""}function m(a){a||(a="base");if(X[a])return X[a].theme;if(!/^([a-z0-9\_\-]+)$/.test(a))throw 32;var c={},f=[c],h=new ga;X[a]={theme:h,sources:c,sourcesList:f,fallback:[]};var e=function(b,f){!1==b in c&&(c[b]=f,X[ca].fallback.has(a)&&G(b).set());return G(b)};b.object.extend(h,{name:a,fallback:function(c){if(h!==fa&&0<arguments.length){var b="string"==typeof c?c.split("/"):[],f={},b=I(a,b);if(X[a].fallback.source!=b.source){X[a].fallback.source=b.source;for(var d in X){var e=X[d].fallback,
b=I(d,(e.source||"").split("/"));if(b.value!=e.value){f[d]=!0;X[d].fallback=b;e=X[d].sourcesList;e.length=b.length;for(var l=0;l<e.length;l++)e[l]=X[b[l]].sources}}}for(d in f)if(X[ca].fallback.has(d)){b=void 0;for(b in ba)G(b).set();break}}b=X[a].fallback.slice(1);b.source=X[a].fallback.source;return b},define:function(a,c){"function"==typeof a&&(a=a());if("string"==typeof a){if("object"==typeof c){var b=a,f=c,d={},l;for(l in f)f.hasOwnProperty(l)&&(d[l]=e(b+"."+l,f[l]));return d}return 1==arguments.length?
G(a):e(a,c)}if("object"==typeof a){f=a;for(b in f)f.hasOwnProperty(b)&&e(b,f[b]);return h}},apply:function(){if(a!=ca){ca=a;for(var c in ba)G(c).set();c=0;for(var b;b=ha[c];c++)b.fn.call(b.context,a)}return h},getSource:function(b){return b?r(a,d):c[d]},drop:function(b){c.hasOwnProperty(b)&&(delete c[b],X[ca].fallback.has(a)&&G(b).set())}});X[a].fallback=I(a,[]);f.push(X.base.sources);return h}g=this.path;t=b.Class;var e=b.cleaner,d=b.path,k=[],R={},D=1,E=2,L=4,O=6,c=3,l=8,B=0,Q=1,K=2,M=3,a=4,n={4:"class",
5:"style"},u={"class":L,style:5},U=4,V=/((?:.|[\r\n])*?)(\{(?:l10n:([a-zA-Z_][a-zA-Z0-9_\-]*(?:\.[a-zA-Z_][a-zA-Z0-9_\-]*)*)\})?|<(\/|!--(\s*\{)?)?|$)/g,W=/([a-z_][a-z0-9\-_]*)(:|\{|\s*(\/?>)?)/ig,h=/([a-z_][a-z0-9_\-]*)(:|\{|=|\s*)|(\/?>)/ig,f=/(.|[\r\n])*?--\x3e/g,s=/([a-z_][a-z0-9_\-]*(?::[a-z_][a-z0-9_\-]*)?)>/ig,S=/([a-z_][a-z0-9_]*)(\||\}\s*)/ig,T=/"((?:(\\")|[^"])*?)"\s*/g,Z=/\\"/g,aa=function(a){var b=[],d=[],e={childs:b},k,n,w,B,u=!1,m=0,M,g=V,Q=0,K;a=a.trim();try{for(;Q<a.length||g!=V;)if(B=
g.lastIndex=Q,K=g.exec(a),!K||K.index!==Q)if(g==S&&n&&n.type==l)g=f;else{u&&(e=d.pop());n&&e.childs.pop();if(n=e.childs.pop())n.type==c&&!n.refs?m-="len"in n?n.len:n.value.length:e.childs.push(n);u=!1;g=V}else{Q=g.lastIndex;switch(g){case V:M=B+K[1].length;m!=M&&(k=m==B?K[1]:a.substring(m,M),(n=k.replace(/\s*(\r\n?|\n\r?)\s*/g,""))&&e.childs.push({type:c,len:k.length,value:n}));m=M;K[3]?e.childs.push({type:c,refs:["l10n:"+K[3]],value:"{l10n:"+K[3]+"}"}):"{"==K[2]?(w=Q-1,e.childs.push(n={type:c}),
g=S):K[4]?"/"==K[4]?(n=null,g=s):(e.childs.push(n={type:l}),K[5]?(w=Q-K[5].length,g=S):(w=Q,g=f)):K[2]&&(u=!0,d.push(e),e.childs.push(n={type:D,attrs:[],childs:[]}),e=n,g=W);break;case s:K[1]!==(e.prefix?e.prefix+":":"")+e.name?e.childs.push({type:c,value:"</"+K[0]}):e=d.pop();g=V;break;case W:case h:if(":"==K[2]){if(n.prefix)throw 29;n.prefix=K[1];break}K[1]&&(n.name=K[1],n.type==E&&e.attrs.push(n));if("{"==K[2]){g=S;break}if(K[3]){"/>"==K[3]&&(e=d.pop());u=!1;g=V;break}if("="==K[2]){g=T;break}n=
{type:E};g=h;break;case f:n.value=a.substring(w,Q-3);g=V;break;case S:n.refs?n.refs.push(K[1]):n.refs=[K[1]];"|"!=K[2]&&(n.type==c?(Q-=K[2].length-1,n.value=a.substring(w,Q),g=V):n.type==l?g=f:n.type==E&&"="==a[Q]?(Q++,g=T):(n={type:E},g=h));break;case T:n.value=K[1].replace(Z,'"');n={type:E};g=h;break;default:throw 30;}g==V&&(m=Q)}m!=Q&&e.childs.push({type:c,value:a.substring(m,Q)});if(1<d.length)throw 31;b.templateTokens=!0}catch(L){}return b},Y=function(){function f(a){return(a.prefix?a.prefix+
":":"")+a.name}function h(a,c){S[c]||("#"==c.charAt(0)?S[c]=String.fromCharCode("x"==c.charAt(1)||"X"==c.charAt(1)?parseInt(c.substr(2),16):c.substr(1)):q&&(q.innerHTML=a,S[c]=q.firstChild?q.firstChild.nodeValue:a));return S[c]||a}function e(a){a=a.refs;return!a||!a.length?0:a}function s(a,c){function b(a){for(var c,f=[],d=[],e={},l=0;l<a.length;l++)l%2?(c=a[l],e[c]||(e[c]=f.length,f.push(c)),d.push(e[c])):a[l]&&d.push(a[l].replace(W,h));return[f,d]}var f=0,d,e;if(c)switch(a){case "class":if(d=c.match($)){for(var l=
[],f=[],k=0,n;n=d[k];k++)(e=n.match(I))?f.push([e[1]||"",e[2]]):l.push(n);c=l.join(" ")}break;case "style":l=[];f=[];if(d=c.match(v))for(k=0;n=d[k];k++)e=n.match(x),n=e[1],c=e[2].trim(),e=c.split(z),1<e.length?(e=b(e),e.push(n),f.push(e)):l.push(n+": "+c.replace(W,h));l.push("");c=l.join(";");break;default:d=c.split(z),1<d.length?f=b(d):c=c.replace(W,h)}f&&!f.length&&(f=0);return{binding:f,value:c,type:u[a]||2}}function w(a,c,b){a=a.attrs;for(var d=[],h,l=0,k;k=a[l];l++)if("b"==k.prefix)switch(k.name){case "ref":k=
(k.value||"").trim().split(/\s+/);for(h=0;h<k.length;h++)m(c,k[h])}else if(h=k.name.match(/^event-(.+)$/))d.push(h[1]==k.value?[O,h[1]]:[O,h[1],k.value]);else{h=s(k.name,k.value);var n=[h.type,h.binding,e(k)];2==h.type&&n.push(f(k));h.value&&(!b||!h.binding||2!=h.type)&&n.push(h.value);d.push(n)}return d.length?d:0}function m(a,c){a[K]||(a[K]=[]);a[K].add(c);"element"!=c&&(a[Q]=1==a[K].length?c:0)}function g(a,c){var b=a[K].indexOf(c);if(-1!=b){var f=a[Q]&&"number"==typeof a[Q];a[K].splice(b,1);f&&
b==a[Q]-1&&(a[Q]=c);a[K].length?f&&(a[Q]-=b<a[Q]-1):a[K]=0}}function r(a){var c={};if(a.attrs)for(var b=0,d;d=a.attrs[b];b++)c[f(d)]=d.value;return c}function R(a,c){for(var b=0;b<c.length;b++)a.add(c[b])}function t(K,L,O){function p(c,b,f){c=r(c);b&&(c.name=b);if(c.name&&y.test(c.name)){var d=T[c.ref||"element"];if(d&&d.token[B]==D){b=d.token;var h=u[c.name],e=a-!!h,l=b&&b.search(c.name,function(a){return h?n[a[B]]:a[M]});!l&&"remove"!=f&&(l=[h||E,0,0],h||l.push(c.name),l.push(""),b||(b=[],d.token.push(b)),
b.push(l));d="class"==c.name||"style"==c.name;switch(f){case "set":f=s(c.name,c.value);l[Q]=f.binding;!O.optimizeSize||!l[Q]||d?l[e]=f.value||"":l.length=e;if(d&&!l[Q]&&!l[e]){b.remove(l);break}break;case "append":f=s(c.name,c.value);if(f.binding){var k=l[Q];if(k){if("style"==c.name){for(var w={},m=0,g;g=f.binding[m];m++)w[g[2]]=!0;g=m=0;for(var K;K=k[m];m++)w[K[2]]||(k[g++]=K);k.length=g}k.push.apply(k,f.binding)}else l[Q]=f.binding}f.value&&(l[e]+=(l[e]&&"class"==c.name?" ":"")+f.value);if(d&&!l[Q]&&
!l[e]){b.remove(l);break}break;case "remove":l&&b.remove(l)}}}}for(var $=[],I=0,v,z;v=K[I];I++){var x=e(v),S=x&&1==x.length?x[0]:0;switch(v.type){case D:if("b"==v.prefix){var q=r(v);switch(v.name){case "resource":case "style":q.src&&L.resources.push(d.resolve(L.baseURI+q.src));break;case "define":if("name"in q&&!L.defines[q.name])switch(q.type){case "bool":L.defines[q.name]=["true"==q["default"]?1:0];break;case "enum":v=q.values?q.values.qw():[],L.defines[q.name]=[v.indexOf(q["default"])+1,v]}break;
case "include":if(q.src&&(S=(x=/^#\d+$/.test(q.src))?q.src.substr(1):q.src,-1==ea.indexOf(S))){ea.push(S);x?(x=k[S],L.deps.add(x),x.source.bindingBridge&&L.deps.add(x.source),x=F(x.source,x.baseURI,!0,O)):(x=/^[a-z0-9\.]+$/i.test(S)&&!/\.tmpl$/.test(S)?G(S):b.resource(d.resolve(L.baseURI+S)),L.deps.add(x),x=F(x.get(),x.url?d.dirname(x.url)+"/":"",!0,O));ea.pop();x.resources&&!1=="no-style"in q&&R(L.resources,x.resources);x.deps&&R(L.deps,x.deps);var T=V(x.tokens),S=(v.childs||[]).slice();q["class"]&&
S.push({type:D,prefix:"b",name:"append-class",attrs:[{type:E,name:"value",value:q["class"]}]});q.id&&S.push({type:D,prefix:"b",name:"set-attr",attrs:[{type:E,name:"name",value:"id"},{type:E,name:"value",value:q.id}]});q.ref&&T.element&&q.ref.trim().split(/\s+/).map(function(a){m(T.element.token,a)});for(var q=0,C;C=S[q];q++)if(C.type==D&&"b"==C.prefix)switch(C.name){case "replace":case "before":case "after":var A=r(C);if(v=A.ref&&T[A.ref]){var A=v.owner.indexOf(v.token),N;-1!=A&&(A+="after"==C.name,
N="replace"==C.name,v.owner.splice.apply(v.owner,[A,N].concat(t(C.childs,L,O)||[])))}break;case "prepend":case "append":A=r(C);if((v=(v=(v="ref"in A?A.ref:"element")&&T[v])&&v.token)&&v[B]==D)A=t(C.childs,L,O)||[],"prepend"==C.name?v.splice.apply(v,[U,0].concat(A)):v.push.apply(v,A);break;case "attr":case "set-attr":p(C,!1,"set");break;case "append-attr":p(C,!1,"append");break;case "remove-attr":p(C,!1,"remove");break;case "class":case "append-class":p(C,"class","append");break;case "set-class":p(C,
"class","set");break;case "remove-class":p(C,"class","remove");break;case "add-ref":A=r(C);(v=(v=(v="ref"in A?A.ref:"element")&&T[v])&&v.token)&&A.name&&m(v,A.name);break;case "remove-ref":A=r(C),(v=(v=(v="ref"in A?A.ref:"element")&&T[v])&&v.token)&&g(v,A.name||A.ref)}else x.tokens.push.apply(x.tokens,t([C],L,O)||[]);T.element&&g(T.element.token,"element");$.push.apply($,x.tokens)}}continue}z=[1,S,x,f(v)];z.push.apply(z,w(v,z,O.optimizeSize)||[]);z.push.apply(z,t(v.childs,L,O)||[]);break;case c:x&&
(2==x.length&&x.search("element"))&&(S=x[+!Array.lastSearchIndex]);z=[3,S,x];(!x||v.value!="{"+x.join("|")+"}")&&z.push(v.value.replace(W,h));break;case l:if(O.optimizeSize&&!S&&!x)continue;z=[8,S,x];O.optimizeSize||(!x||v.value!="{"+x.join("|")+"}")&&z.push(v.value.replace(W,h))}for(;0===z[z.length-1];)z.pop();$.push(z)}return $.length?$:0}function V(a,c,b){c||(c={});b=b||0;for(var f;f=a[b];b++)if(f[B]!=O){var d=f[K];if(d)for(var h=d.length-1,e;e=d[h];h--)-1!=e.indexOf(":")?g(f,e):(c[e]&&g(c[e].token,
e),f[Q]==e&&(f[Q]=h+1),c[e]={owner:a,token:f});f[B]==D&&V(f,c,U)}return c}function p(c,b,f,d){var h=0;d=d||0;for(var e;e=c[d];d++)if(e[B]==D&&(h+=p(e,b,f,U)),e[B]==L||e[B]==E&&"class"==e[M]){var l=e[Q],k=a-(e[B]==L);if(l){for(var n=(e[k]||"").qw(),s=0,w;w=l[s];s++)if(!(2<w.length)){var m=w[1].split(":").pop(),u=b.defines[m];u?(w.push.apply(w,u),u.used=!0,u[0]&&(1==u.length?n.add(w[0]+m):n.add(w[0]+u[1][u[0]-1]))):h++}e[k]=n.join(" ");f.optimizeSize&&!e[k]&&(e.length=k)}}return h}var y=/^[a-z_][a-z0-9_\-]*$/i,
$=/(\S+)/g,I=/^([a-z_][a-z0-9_\-]*)?\{((anim:)?[a-z_][a-z0-9_\-]*)\}$/i,v=/\s*[^:]+?\s*:(?:\(.*?\)|".*?"|'.*?'|[^;]+?)+(?:;|$)/gi,x=/\s*([^:]+?)\s*:((?:\(.*?\)|".*?"|'.*?'|[^;]+?)+);?$/i,z=/\{([a-z_][a-z0-9_]*|l10n:[a-z_][a-z0-9_]*(?:\.[a-z_][a-z0-9_]*)*)\}/i,W=/&([a-z]+|#[0-9]+|#x[0-9a-f]{1,4});?/gi,S=b.NODE_ENV?require("./template/htmlentity.json"):{},q=!b.NODE_ENV?document.createElement("div"):null,ea=[];return function(a,c,b){b=b||{};var f=[];c={baseURI:c||"",tokens:null,resources:[],deps:[],
defines:{},unpredictable:!0,warns:f};a.templateTokens||(a=aa(""+a));c.tokens=t(a,c,b);c.tokens||(c.tokens=[[3,0,0,""]]);m(c.tokens[0],"element");V(c.tokens);c.unpredictable=!!p(c.tokens,c,b);delete c.defines;f.length||(c.warns=!1);return c}}(),da={".css":!0},w=t(null,{className:g+".Template",__extend__:function(a){return a instanceof w?a:a instanceof ea?new $(a):new w(a)},source:"",baseURI:"",init:function(a){this.attaches_=[];this.setSource(a||"");this.templateId=k.push(this)-1},bindingBridge:{attach:function(a,
c,b){for(var f=0,d;d=a.attaches_[f];f++)if(d.handler==c&&d.context==b)return!1;a.attaches_.push({handler:c,context:b});return!0},detach:function(a,c,b){for(var f=0,d;d=a.attaches_[f];f++)if(d.handler==c&&d.context==b)return a.attaches_.splice(f,1),!0;return!1},get:function(){}},createInstance:function(a,c,b){x.call(this);return this.createInstance(a,c,b)},clearInstance:function(a){a.destroy_()},getBinding:function(a){x.call(this);return this.getBinding(a)},setSource:function(a){var c=this.source;
if(c!=a){if("string"==typeof a){var f=a.match(/^([a-z]+):/);if(f){var d=f[1];a=a.substr(f[0].length);switch(d){case "file":a=b.resource(a);break;case "id":a=N(a);break;case "tokens":a=a.toObject();a.isDecl=!0;break;case "path":a=G(a)}}}if(c&&c.bindingBridge){if(f=c.url&&R[c.url])f.remove(this),f.length||delete R[c.url];this.baseURI="";this.source.bindingBridge.detach(c,v,this)}a&&a.bindingBridge&&(a.url&&(this.baseURI=String(a.url).replace(/[^\\\/]+$/,""),R[a.url]||(R[a.url]=[]),R[a.url].add(this)),
a.bindingBridge.attach(a,v,this));this.source=a;v.call(this)}}}),ea=function(a){b.object.extend(this,a)},$=b.Class(null,{className:g+".TemplateSwitcher",ruleRet_:null,templates_:null,templateClass:w,ruleEvents:null,rule:String,init:function(a){this.ruleRet_=[];this.templates_=[];this.rule=a.rule;if((a=a.events)&&a.length){this.ruleEvents={};for(var c=0,b;b=a[c];c++)this.ruleEvents[b]=!0}e.add(this)},resolve:function(a){a=this.rule(a);var c=this.ruleRet_.indexOf(a);-1==c&&(this.ruleRet_.push(a),c=
this.templates_.push(new this.templateClass(a))-1);return this.templates_[c]},destroy:function(){this.ruleRet_=this.templates_=this.rule=null}}),ga=t(null,{className:g+".Theme",get:G}),ia=t(b.Token,{className:g+".SourceWrapper",path:"",url:"",baseURI:"",init:function(a,c){this.path=c;b.Token.prototype.init.call(this,"")},get:function(){return this.value&&this.value.bindingBridge?this.value.bindingBridge.get(this.value):this.value},set:function(){var a=r(ca,this.path);this.value!=a&&(this.value&&this.value.bindingBridge&&
this.value.bindingBridge.detach(this.value,this.apply,this),this.url=(this.value=a)&&a.url||"",this.baseURI=("object"==typeof a||"function"==typeof a)&&"baseURI"in a?a.baseURI:d.dirname(this.url)+"/",this.value&&this.value.bindingBridge&&this.value.bindingBridge.attach(this.value,this.apply,this),this.apply())},destroy:function(){this.baseURI=this.url=null;this.value&&this.value.bindingBridge&&this.value.bindingBridge.detach(this.value,this.apply,this);b.Token.prototype.destroy.call(this)}}),X={},
ba={},fa=m(),ca="base",ha=[];e.add({destroy:function(){for(var a in ba)ba[a].destroy();ba=X=null;a=0;for(var c;c=k[a];a++){for(var b in c.instances_)c.instances_[b].destroy_();c.attaches_=null;c.createInstance=null;c.getBinding=null;c.instances_=null;c.resources=null;c.l10n_=null;c.source=null}k=null}});H.setWrapper(function(){return fa.define.apply(fa,arguments)});H.exports={DECLARATION_VERSION:2,TYPE_ELEMENT:D,TYPE_ATTRIBUTE:E,TYPE_ATTRIBUTE_CLASS:L,TYPE_ATTRIBUTE_STYLE:5,TYPE_ATTRIBUTE_EVENT:O,
TYPE_TEXT:c,TYPE_COMMENT:l,TOKEN_TYPE:B,TOKEN_BINDINGS:Q,TOKEN_REFS:K,ATTR_NAME:M,ATTR_VALUE:a,ATTR_NAME_BY_TYPE:n,ELEMENT_NAME:3,ELEMENT_ATTRS:U,ELEMENT_CHILDS:5,TEXT_VALUE:3,COMMENT_VALUE:3,TemplateSwitchConfig:ea,TemplateSwitcher:$,Template:w,switcher:function(a,c){var f=b.array(arguments);c=f.pop();return new ea({rule:c,events:f.join(" ").trim().split(/\s+/)})},tokenize:aa,getDeclFromSource:F,makeDeclaration:Y,Theme:ga,theme:m,getThemeList:function(){return b.object.keys(X)},currentTheme:function(){return X[ca].theme},
setTheme:function(a){return m(a).apply()},onThemeChange:function(a,c,b){ha.push({fn:a,context:c});b&&a.call(c,ca)},define:fa.define,get:G,getPathList:function(){return b.object.keys(ba)}};m("base").define({"#1":b.resource("0.tmpl"),"#2":b.resource("1.tmpl"),"#3":b.resource("2.tmpl"),"#4":b.resource("3.tmpl"),"#5":b.resource("4.tmpl"),"#6":b.resource("5.tmpl"),"#7":b.resource("6.tmpl"),"#8":b.resource("7.tmpl"),"#9":b.resource("8.tmpl"),"#a":b.resource("9.tmpl"),"#b":b.resource("a.tmpl"),"#c":b.resource("b.tmpl"),
"#d":b.resource("c.tmpl"),"#e":b.resource("d.tmpl"),"#f":b.resource("e.tmpl"),"#g":b.resource("f.tmpl"),"#h":b.resource("g.tmpl"),"#i":b.resource("h.tmpl"),"#j":b.resource("i.tmpl"),"#k":b.resource("j.tmpl"),"#l":b.resource("k.tmpl"),"#m":b.resource("l.tmpl"),"#n":b.resource("m.tmpl"),"#o":b.resource("n.tmpl")})}],["basis.dom.event",function(g,H,b,t,J,A,P){function z(a){return a instanceof u?a.event_:a||t.event}function y(a){return"string"==typeof a?O.getElementById(a):a}function v(a){return a.target||
a.srcElement}function p(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function F(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function q(a,c){(c=y(c))?R(c,a,q):(F(a),p(a))}function C(a){return a.keyCode||a.which||0}function x(a){return a.charCode||a.keyCode||0}function N(a,c){return"number"==typeof a.which?a.which==c.VALUE:!!(a.button&c.BIT)}function G(a){return a.changedTouches?a.changedTouches[0].pageX:"pageX"in a?a.pageX:a.clientX+(O.documentElement.scrollLeft||O.body.scrollLeft)}
function I(a){return a.changedTouches?a.changedTouches[0].pageY:"pageY"in a?a.pageY:a.clientY+(O.documentElement.scrollTop||O.body.scrollTop)}function r(a){var c=0;"wheelDelta"in a?c=a.wheelDelta:"DOMMouseScroll"==a.type&&(c=-a.detail);return c/Math.abs(c)}function m(a){var c=l(U[a.type]),b=V[a.type],d=new u(a);if(b)b.handler.call(b.thisObject,d),q(a);else if(c)for(a=c.length;0<a--;)b=c[a],b.handler.call(b.thisObject,d)}function e(a){var c=V[a];c&&(k(a,c.handler,c.thisObject),delete V[a])}function d(a,
b,d){var h=U[a];if(h){a=0;for(var e;e=h[a];a++)if(e.handler===b&&e.thisObject===d)return}else W?R(O,a,c):O.addEventListener(a,m,!0),h=U[a]=[];h.push({handler:b,thisObject:d})}function k(a,b,d){var h=U[a];if(h)for(var e=0,l;l=h[e];e++)if(l.handler===b&&l.thisObject===d){h.splice(e,1);h.length||(delete U[a],W?D(O,a,c):O.removeEventListener(a,m,!0));break}}function R(a,c,b,d){a=y(a);if(!a)throw 33;if("function"!=typeof b)throw 34;a[Q]||(a[Q]={});var h={handler:b,thisObject:d},e=a[Q],l=e[c];if(l){for(a=
0;e=l[a];a++)if(e.handler===b&&e.thisObject===d)return;l.push(h)}else l=e[c]=[h],l.fireEvent=function(a){a=z(a);if(W&&(a&&U[c])&&"undefined"==typeof a.returnValue){m(a);if(!0===a.cancelBubble)return;"undefined"==typeof a.returnValue&&(a.returnValue=!0)}var b=0;a=new u(a);for(var f;f=l[b++];)f.handler.call(f.thisObject,a)},B?a.addEventListener(c,l.fireEvent,!1):a.attachEvent("on"+c,l.fireEvent)}function D(a,c,b,d){a=y(a);var h=a[Q];if(h&&(h=h[c]))for(var e=0,l;l=h[e];e++)if(l.handler===b&&l.thisObject===
d){h.splice(e,1);h.length||E(a,c);break}}function E(a,c){a=y(a);var b=a[Q];if(b)if("string"!=typeof c)for(c in b)E(a,c);else{var d=b[c];d&&(a.removeEventListener?a.removeEventListener(c,d.fireEvent,!1):a.detachEvent("on"+c,d.fireEvent),delete b[c])}}function L(a){return function(c,b){return a(z(c),b)}}var O=t.document,c=b.fn.$null,l=b.array.from,B=!!O.addEventListener,Q="__basisEvents";g={BACKSPACE:8,TAB:9,CTRL_ENTER:10,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,
END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};var K={VALUE:1,BIT:1},M={VALUE:2,BIT:4},a={VALUE:3,BIT:2},n={mousewheel:["mousewheel","DOMMouseScroll"]},u=b.Class(null,{className:this.path+".Event",KEY:g,init:function(c){c=z(c);b.object.extend(b.object.complete(this,c),{event_:c,sender:v(c),key:C(c),charCode:x(c),mouseLeft:N(c,K),mouseMiddle:N(c,M),mouseRight:N(c,a),mouseX:G(c),mouseY:I(c),wheelDelta:r(c)})},
stopBubble:function(){p(this.event_)},stopPropagation:function(){p(this.event_)},preventDefault:function(){F(this.event_)},die:function(){this.stopBubble();this.preventDefault()}}),U={},V={},W=!B,h={};H.setWrapper(function(a){return z(a)});H.exports={W3CSUPPORT:B,browserEvents:function(a){return n[a]||[a]},getEventInfo:function(a,c){c||(c="div");var b=c+"-"+a;if(h[b])return h[b];var d=!1,e=!1;if(!B){var l="on"+a,k=O.createElement("div"),n=k.appendChild(O.createElement(c));k[l]=function(){e=!0};try{n.fireEvent(l),
d=!0}catch(w){}}return h[b]={supported:d,bubble:e}},KEY:g,MOUSE_LEFT:K,MOUSE_RIGHT:a,MOUSE_MIDDLE:M,Handler:function(a,c){this.handler=a;this.thisObject=c},Event:u,sender:L(v),cancelBubble:L(p),cancelDefault:L(F),kill:L(q),key:L(C),charCode:L(x),mouseButton:L(N),mouseX:L(G),mouseY:L(I),wheelDelta:L(r),addGlobalHandler:d,removeGlobalHandler:k,captureEvent:function(a,c,b){V[a]&&e(a);d(a,c,b);V[a]={handler:c,thisObject:b}},releaseEvent:e,addHandler:R,addHandlers:function(a,c,b){a=y(a);for(var d in c)R(a,
d,c[d],b)},removeHandler:D,clearHandlers:E,fireEvent:function(a,c,b){a=y(a);(a=a[Q])&&a[c]&&a[c].fireEvent(b)},onLoad:function(a){return b.ready(a)},onUnload:function(a,c){R(t,"unload",a,c)},wrap:z}}],["basis.template.htmlfgen",function(g,H,b,t,J,A,P){var z=b.template.TYPE_ELEMENT,y=b.template.TYPE_ATTRIBUTE,v=b.template.TYPE_TEXT,p=b.template.TYPE_COMMENT,F=b.template.TOKEN_TYPE,q=b.template.TOKEN_BINDINGS,C=b.template.TOKEN_REFS,x=b.template.ATTR_NAME,N=b.template.ATTR_NAME_BY_TYPE,G=b.template.ELEMENT_NAME,
I=b.template.ELEMENT_ATTRS,r={},m=function(){function b(c,d){for(var e=0,l;l=c[e];e++)-1==l.indexOf(":")&&L.push(l+":"+d)}function e(c){var b=E.length,b=g[b]||"r"+b;E.push(b+"="+c);return b}function m(B,g){for(var D,M,a,n,u=0,L=0,t=0,y;y=B[u];u++,L++,n=!1){u?B[u+1]?(y[F]==B[u-1][F]&&y[F]==v&&t++,D=g+".childNodes["+L+(t?" + "+t+" * TEXT_BUG":"")+"]"):D=g+".lastChild":D=g+".firstChild";if(M=y[C])n=!0,D=e(D),b(M,D);y[q]&&(y[q]&&"number"==typeof y[q]&&(y[q]=y[C][y[q]-1]),n||(n=!0,D=e(D)),r.push([y[F],
D,y[q]]));if(y[F]==z){a=-1;g==l&&c.push(D+".basisObjectId");n||(D=e(D),a=E.length);for(var h=[],f=[],s=I,A;A=y[s];s++)A[F]==z||A[F]==v||A[F]==p?f.push(A):h.push(A);for(var s=0,H;H=h[s];s++)if(6!=H[F]){A=N[H[F]]||H[x];if(M=H[C])n=!0,b(M,e(D+'.getAttributeNode("'+A+'")'));if(M=H[q])switch(n=!0,A){case "class":H=0;for(var J;J=M[H];H++)J=[2,D,J[1],A,J[0]].concat(J.slice(2)),r.push(J);break;case "style":for(H=0;J=M[H];H++)for(var P=0,Y;Y=J[0][P];P++)r.push([2,D,Y,A,J[0],J[1],J[2]]);break;default:for(H=
0;Y=M[0][H];H++)r.push([2,D,Y,A,M[0],M[1],y[G]])}}f.length&&m(f,D);!n&&a==E.length&&E.pop()}}}var g="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".toArray(),E,L,r,c,l;return function(b,d){E=[];L=[];r=[];c=[];l=d||"_";m(b,l);return{path:E,ref:L,binding:r,markedElementList:c}}}(),e=function(){function d(b,d){for(var e=[],c=b[5],l=b[4],k,m,g=0;g<c.length;g++)"string"==typeof c[g]?e.push('"'+c[g].replace(/"/g,'\\"')+'"'):(k=l[c[g]],m=k.indexOf(":"),-1==m?e.push("l10n"==d?'"{'+k+'}"':"bool"==d?
"(__"+k+'||"")':"__"+k):e.push('__l10n["'+k.substr(m+1)+'"]'));1==e.length&&e.push('""');return e.join("+")}var e={disabled:"*",checked:["input"],value:["input","textarea"],minlength:["input"],maxlength:["input"],readonly:["input"],selected:["option"]},m={disabled:!0,checked:!0,selected:!0,readonly:!0},g={1:"bind_element",3:"bind_textNode",8:"bind_comment"};return function(E){function L(a){n[a]=!0;c.push(l+"="+a+"("+b.array(arguments,1)+");")}for(var r={},c,l,B=[],Q=[],K,M,a,n={},u,t=0,p;p=E[t];t++){var q=
p[0],h=p[1],f=p[2],s=f.split(":");(u="anim"==s[0])&&(f=s[1]);c=r[f];l="_"+t;K="__"+f;if("l10n"==s[0]&&s[1])u=s[1],M||(M={},a=[]),r[u]||(r[u]=[],M[u]=[],a.push(u)),c=r[u],c.l10n=!0,q==v?(M[u].push(h+".nodeValue=value;"),c.push(h+'.nodeValue=__l10n["'+u+'"];')):(q='"'+p[x]+'"',M[u].push("bind_attr("+[h,q,"NaN",d(p,"l10n")]+");"),B.push(l),L("bind_attr",h,q,l,d(p)));else if(r[f]||(c=r[f]=[],B.push(K)),q!=y)B.push(l+"="+h),L(g[q],h,l,"value");else switch(q=p[x],q){case "class":q="";s="value";K=p[4];s=
p.length;if(6<=s)if(6==s||"string"==typeof p[6])6==s?(s='value?"'+f+'":""',p[5]&&(q=K+f)):(K="",s='value?"'+p[6]+'":""',p[5]&&(q=p[6]));else{if(!p[6].length)continue;7==s?(s=p[6].map(function(a){return'value=="'+a+'"'}).join("||")+'?value:""',p[5]&&(q=K+p[6][p[5]-1])):(K="",s=p[6].map(function(a,c){return'value=="'+a+'"?"'+this[c]+'"'},p[7]).join(":")+':""',p[5]&&(q=p[7][p[5]-1]))}else s='typeof value=="string"||typeof value=="number"?value:(value?"'+f+'":"")';B.push(l+'="'+q+'"');L("bind_attrClass",
h,l,s,'"'+K+'"',u);break;case "style":B.push(l+'=""');L("bind_attrStyle",h,'"'+p[6]+'"',l,d(p));break;default:if(u=e[q],B.push(l+"="+d(p,"l10n")),L("bind_attr",h,'"'+q+'"',l,u&&m[q]?d(p,"bool")+'?"'+q+'":""':d(p)),u&&("*"==u||u.has(p[6].toLowerCase())))c.push("if("+h+"."+q+"!="+l+")"+h+"."+q+"="+(m[q]?"!!(":"(")+l+");")}}Q.push("function set(bindName,value){value=resolve(attaches,updateAttach,bindName,value);switch(bindName){");for(f in r)Q.push('case"'+f+'":'+(r[f].l10n?r[f].join(""):"if(__"+f+"!==value){__"+
f+"=value;"+r[f].join("")+"}")+"break;");Q.push("}}");for(var z in n)B.push(z+"=tools."+z);return{keys:b.object.keys(r),vars:B,set:Q.join(""),l10n:M,l10nKeys:a}}}();H.exports={getFunctions:function(d,k,g,D){if(k=r[g&&b.path.relative(g)])return k;d=m(d,"_");k=e(d.binding);g=d.markedElementList.join("=");D={keys:k.keys,l10nKeys:k.l10nKeys};if(k.l10n){var E=[],L;for(L in k.l10n)E.push('case"'+L+'":if(value==null)value="{'+L+'}";__l10n[token]=value;'+k.l10n[L].join(";")+"break;");D.createL10nSync=new Function("_",
"__l10n","bind_attr","TEXT_BUG","var "+d.path+";return function(token, value){switch(token){"+E.join("")+"}}")}D.createInstance=new Function("gMap","tMap","build","tools","__l10n","TEXT_BUG","return function createInstance_(obj,onAction,onUpdate){var id=gMap.seed++,ref={context:obj},attaches={},resolve=tools.resolve,_=build(),"+d.path.concat(k.vars)+(g?";if(obj)gMap["+g+"=id]=ref":"")+';function updateAttach(){set(this+"",attaches[this])}'+k.set+";return tMap[id]=ref.tmpl={"+[d.ref,"set:set,rebuild_:function(){if(onUpdate)onUpdate.call(obj)},action_:function(action,event){if(onAction)onAction.call(obj,action,event)},destroy_:function(){for(var key in attaches)if(attaches[key])attaches[key].bindingBridge.detach(attaches[key],updateAttach,key);attaches=null;delete tMap[id];"+
(g?"delete gMap[id];":"")+"}"]+"}}");return D}}}],["basis.template.html",function(g,H,b,t,J,A,P){function z(a){return function(c){c=new p.Event(c);if(!c||!("click"==c.type&&3==c.which)){var b=c.sender,d;if(b){do if(d=b.getAttributeNode&&b.getAttributeNode(a))break;while(b=b.parentNode);if(b&&d){var h;a:{h=b;var f;do if(f=h.basisObjectId)if(f=l[f]){h=f;break a}while(h=h.parentNode)}if(h){d=d.nodeValue.qw();c.actionTarget=b;for(b=0;f=d[b++];)h.tmpl.action_(f,c)}}}}}}function y(a){return function(){p.fireEvent(v,
a)}}g=this.path;var v=t.document,p=b.dom.event,F=b.array.from,q=b.l10n.token,C=b.template.htmlfgen.getFunctions,x=b.template.TemplateSwitchConfig;J=b.template.TemplateSwitcher;A=b.template.Template;var N=b.template.TYPE_ELEMENT,G=b.template.TYPE_ATTRIBUTE,I=b.template.TYPE_TEXT,r=b.template.TYPE_COMMENT,m=b.template.TOKEN_TYPE,e=b.template.TOKEN_BINDINGS,d=b.template.TOKEN_REFS,k=b.template.ATTR_NAME,R=b.template.ATTR_VALUE,D=b.template.ATTR_NAME_BY_TYPE,E=b.template.ELEMENT_NAME,L=b.template.TEXT_VALUE,
O=b.template.COMMENT_VALUE,c={},l={seed:1},B={svg:"http://www.w3.org/2000/svg"},Q=function(){var a=v.createElement("div");a.appendChild(v.createTextNode("a"));a.appendChild(v.createTextNode("b"));return 1==a.cloneNode(!0).childNodes.length}(),K=function(){var a=v.createElement("div");a.setAttribute("class","a");return!a.className}();P=function(){var a=/\s+/,c="function"==typeof Node&&v instanceof Node?function(a,c,b){b instanceof Node&&(a=11==b.nodeType?b.firstChild===b.lastChild?b.firstChild:F(b):
b);if(a!==c)if(Array.isArray(a)){if(c.fragmentStart){a.fragmentStart=c.fragmentStart;a.fragmentEnd=c.fragmentEnd;for(b=a.fragmentStart.nextSibling;b&&b!=a.fragmentEnd;){var d=b;b=b.nextSibling;d.parentNode.removeChild(d)}}else a.fragmentStart=v.createComment("start"),a.fragmentEnd=v.createComment("end"),c.parentNode.insertBefore(a.fragmentStart,c),c.parentNode.replaceChild(a.fragmentEnd,c);for(c=0;b=a[c];c++)a.fragmentEnd.parentNode.insertBefore(b,a.fragmentEnd)}else{if(c&&c.fragmentStart){for(b=
c.fragmentStart.nextSibling;b&&b!=c.fragmentEnd;)d=b,b=b.nextSibling,d.parentNode.removeChild(d);c.fragmentStart.parentNode.removeChild(c.fragmentStart);c=c.fragmentEnd}c.parentNode.replaceChild(a,c)}return a}:function(a,c,b){b=b&&"object"==typeof b?b:a;if(b!==c)try{c.parentNode.replaceChild(b,c)}catch(d){b=a,c!==b&&c.parentNode.replaceChild(b,c)}return b},d=function(a,c,b,d){b!==d&&(d?a.setAttribute(c,d):a.removeAttribute(c));return d},e={bind_textNode:function(a,b,d){b=c(a,b,d);b===a&&(a.nodeValue=
d);return b},bind_node:c,bind_element:function(a,b,d){b=c(a,b,d);b===a&&"string"==typeof d&&(a.innerHTML=d);return b},bind_comment:c,bind_attr:d,bind_attrClass:t.DOMTokenList&&v&&v.documentElement.classList instanceof t.DOMTokenList?function(a,c,d,e,l){var k=d?e+d:"";k!=c&&(c&&a.classList.remove(c),k&&(a.classList.add(k),l&&(a.classList.add(k+"-anim"),b.timer.nextTick(function(){a.classList.remove(k+"-anim")}))));return k}:function(c,f,d,e,l){var k=d?e+d:"";if(k!=f){d=c.className;var n="string"!=
typeof d;n&&(d=d.baseVal);d=d.split(a);f&&d.remove(f);k&&(d.push(k),l&&(d.add(k+"-anim"),b.timer.nextTick(function(){var b=(n?c.className.baseVal:c.className).split(a);b.remove(k+"-anim");n?c.className.baseVal=b.join(" "):c.className=b.join(" ")})));n?c.className.baseVal=d.join(" "):c.className=d.join(" ")}return k},bind_attrStyle:function(a,c,b,d){if(b!==d)try{a.style[c.camelize()]=d}catch(e){}return d},resolve:function(a,c,b,d){var e=d&&d.bindingBridge,l=a[b];if(e||l)e?(d!==l&&(l&&l.bindingBridge.detach(l,
c,b),e.attach(d,c,b),a[b]=d),d=e.get(d)):l&&(l.bindingBridge.detach(l,c,b),delete a[b]);return d},l10nToken:q};return function(a){var c=C(a,!0,this.source.url,a.source_),b={},k={},n,m=M(a);if(c.createL10nSync){n=c.createL10nSync(m,k,d,Q);a=0;for(var B;B=c.l10nKeys[a];a++)n(B,q(B).value)}return{createInstance:c.createInstance(l,b,function(){return m.cloneNode(!0)},e,k,Q),l10nProtoSync:n,keys:c.keys,l10nKeys:c.l10nKeys,map:b}}}();var M=function(a,b){function l(a,b){var f="event-"+a;if(!c[a]){c[a]=z(f);
for(var d=0,e=p.browserEvents(a),k;k=e[d++];)p.addGlobalHandler(k,c[a])}p.W3CSUPPORT||(d=p.getEventInfo(a,t),d.supported&&!d.bubble&&h.attachEvent("on"+a,y(a)));h.setAttribute(f,b)}function n(a,c){K&&"class"==a&&(a="className");h.setAttribute(a,c)}for(var h=b||v.createDocumentFragment(),f=b?4:0,g;g=a[f];f++)switch(g[m]){case N:var t=g[E],q=t.split(/:/),q=1<q.length?v.createElementNS(B[q[0]],t):v.createElement(t);M(g,q);h.appendChild(q);break;case G:var q=g[k],x=g[R],A=q.replace(/^event-/,"");if(A!=
q)l(A,x);else if("class"!=q&&"style"!=q?!g[e]:x)n(q,x||"");break;case 4:case 5:(x=g[R-1])&&n(D[g[m]],x);break;case 6:l(g[1],g[2]||g[1]);break;case r:h.appendChild(v.createComment(g[O]||(g[d]?"{"+g[d].join("|")+"}":"")));break;case I:Q&&(f&&a[f-1][m]==I)&&h.appendChild(v.createComment("")),h.appendChild(v.createTextNode(g[L]||(g[d]?"{"+g[d].join("|")+"}":"")||(g[e]?"!":"")))}return h},a=A.subclass({className:g+".Template",__extend__:function(c){return c instanceof a?c:c instanceof x?new n(c):new a(c)},
builder:P}),n=J.subclass({className:g+".TemplateSwitcher",templateClass:a});H.exports={Template:a,TemplateSwitcher:n};b.template.extend({buildHtml:M,buildFunctions:P,resolveObjectById:function(a){return l[a].context}})}],["basis.ui",function(g,H,b,t,J,A,P){g=this.path;var z=t.document;t=b.Class;var y=b.dom,v=b.cssom,p=b.cssom.classList,F=b.event.create,q=b.template.html.Template;J=b.dom.wrapper.Node;var C=b.dom.wrapper.PartitionNode,x=b.dom.wrapper.GroupingNode,N=1,G=function(){var b={},d=/^([a-z_][a-z0-9_]*):(.*)/i;
return{add:function(d,e){b[d]||(b[d]=e)},process:function(e,k){var c,l=k.match(d);l&&(c=b[l[1]],k=l[2]||e);return c?c(k):k}}}();G.add("data",function(b){return{events:"update",getter:"data."+b}});G.add("satellite",function(b){return{events:"satelliteChanged",getter:function(d){return d.satellite[b]?d.satellite[b].element:null}}});var I=t.customExtendProperty({selected:{events:"select unselect",getter:function(b){return b.selected}},unselected:{events:"select unselect",getter:function(b){return!b.selected}},
disabled:{events:"disable enable",getter:function(b){return b.disabled||b.contextDisabled}},enabled:{events:"disable enable",getter:function(b){return!(b.disabled||b.contextDisabled)}},state:{events:"stateChanged",getter:function(b){return String(b.state)}},childNodesState:{events:"childNodesStateChanged",getter:function(b){return String(b.childNodesState)}},childCount:{events:"childNodesModified",getter:function(b){return b.childNodes?b.childNodes.length:0}},hasChildren:{events:"childNodesModified",
getter:function(b){return!!b.firstChild}},empty:{events:"childNodesModified",getter:function(b){return!b.firstChild}}},function(d,e){d.bindingId=N++;for(var k in e){var g=null,c=e[k];if(R&&c instanceof R)g={events:"satelliteChanged",getter:function(c,d){var e=b.fn.runOnce(function(b){b.setSatellite(c,d)});return function(b){e(b);return b.satellite[c]?b.satellite[c].element:null}}(k,c)};else if(c){if("string"==typeof c)c=G.process(k,c);else if(c instanceof b.Token||c instanceof b.data.AbstractData&&
c.bindingBridge)c=b.fn.$const(c);g="object"!=typeof c?{getter:b.getter(c)}:Array.isArray(c)?{events:c[0],getter:b.getter(c[1])}:{events:c.events,getter:b.getter(c.getter)}}d[k]=g}}),r=t.extensibleProperty({select:function(b){this.isDisabled()||(this.contextSelection&&this.contextSelection.multiple?this.select(b.ctrlKey||b.metaKey):this.select())}}),m={"*":function(b){var d=this.templateSwitcher_;d&&(d.ruleEvents&&d.ruleEvents[b.type])&&this.setTemplate(d.resolve(this))}},e=new q("<div/>"),d;A=function(g){return{template:e,
emit_templateChanged:F("templateChanged"),templateSwitcher_:null,binding:I,action:r,tmpl:null,element:null,childNodesElement:null,id:null,cssClassName:null,focusable:!0,emit_update:function(b){this.templateUpdate(this.tmpl,"update",b);g.emit_update.call(this,b)},emit_match:function(){g.emit_match.call(this);v.display(this.element,!0)},emit_unmatch:function(){g.emit_unmatch.call(this);v.display(this.element,!1)},init:function(){var b=this.template;b&&(this.template=null,this.setTemplate(b));g.init.call(this)},
postInit:function(){g.postInit.call(this);this.template&&(this.templateSync(!0),this.container&&(y.insert(this.container,this.element),this.container=null))},templateSync:function(d){var e=this.template,g=e.getBinding(this.binding,this)||null,c=this.templateBinding_,l=this.tmpl,m=this.element;if(g!==c){c&&c.handler&&this.removeHandler(c.handler);d||(this.tmpl&&e.clearInstance(this.tmpl),l=e.createInstance(this,this.templateAction,this.templateSync),l.childNodesHere&&(l.childNodesElement=l.childNodesHere.parentNode,
l.childNodesElement.insertPoint=l.childNodesHere),this.tmpl=l,this.element=l.element,this.childNodesElement=l.childNodesElement||l.element,1!=this.childNodesElement.nodeType&&(this.childNodesElement=z.createDocumentFragment()));if(this.content)if(this.content instanceof b.l10n.Token){var r=this.content,D=y.createText(r.value),M=function(a){this.nodeValue=a};r.attach(M,D);this.addHandler({destroy:function(){r.detach(M,D)}});y.insert(l.content||l.element,D)}else y.insert(l.content||l.element,this.content);
this.id&&(l.element.id=this.id);if(e=this.cssClassName){"string"==typeof e&&(e={element:e});for(var a in e)if(d=l[a]){var c=p(d),n=String(e[a]).qw();d=0;for(var u;u=n[d++];)c.add(u)}}this.templateUpdate(this.tmpl);g&&g.names.length&&(g.handler&&this.addHandler(g.handler),g.sync.call(this));if(this instanceof k){if(l=this.nodes)for(d=l.length;0<d--;)a=l[d],a.parentNode.insertBefore(a,a.nextSibling)}else for(a=this.lastChild;a;a=a.previousSibling)this.insertBefore(a,a.nextSibling);m&&(this.element&&
m!==this.element)&&((l=m&&m.parentNode)&&l.replaceChild(this.element,m),this.emit_templateChanged());this.templateBinding_=g}},setTemplate:function(d){var e=this.templateSwitcher_;d instanceof b.template.TemplateSwitcher&&(this.templateSwitcher_=d,d=d.resolve(this),e||this.addHandler(m,this));!1==d instanceof q&&(d=null);if(e&&(!d||e.resolve(this)!==d))this.templateSwitcher_=null,this.removeHandler(m,this);if(this.template!==d){var k=this.template,e=this.element;if(k){k.clearInstance(this.tmpl);var c=
this.templateBinding_;c&&c.handler&&this.removeHandler(c.handler);this.templateBinding_=null}(this.template=d)?(d=d.createInstance(this,this.templateAction,this.templateSync),d.childNodesHere&&(d.childNodesElement=d.childNodesHere.parentNode,d.childNodesElement.insertPoint=d.childNodesHere),this.tmpl=d,this.element=d.element,this.childNodesElement=d.childNodesElement||d.element,1!=this.childNodesElement.nodeType&&(this.childNodesElement=z.createDocumentFragment()),k&&this.templateSync(!0)):this.childNodesElement=
this.element=this.tmpl=null;if(e&&(!this.element||this.element!=e))(d=e&&e.parentNode)&&d.nodeType==y.ELEMENT_NODE&&d.removeChild(e)}},updateBind:function(b){var d=this.binding[b];(d=d&&d.getter)&&this.tmpl&&this.tmpl.set(b,d(this))},templateAction:function(b,d){var e=this.action[b];e&&e.call(this,d)},templateUpdate:function(b,d,e){},focus:function(e){if(this.focusable){var k=this.tmpl.focus||this.element;k&&(d&&(d=b.timer.clearImmediate(d)),d=b.timer.setImmediate(function(){y.focus(k,e)}))}},blur:function(){if(this.focusable){var b=
this.tmpl.focus||this.element;b&&b.blur()}},destroy:function(){g.destroy.call(this);this.setTemplate()}}};P=function(b){return{insertBefore:function(d,e){d=b.insertBefore.call(this,d,e);var k=(d.groupNode||this).childNodesElement||this.childNodesElement,c=d.nextSibling,l=d.element,c=(c&&c.element.parentNode==k?c.element:null)||k.insertPoint||null;(l.parentNode!==k||l.nextSibling!==c)&&k.insertBefore(l,c);return d},removeChild:function(d){b.removeChild.call(this,d);var e=d.element,k=e.parentNode;k&&
k.removeChild(e);return d},clear:function(d){if(d)for(var e=this.firstChild;e;){var k=e.element,c=k.parentNode;c&&c.removeChild(k);e=e.nextSibling}b.clear.call(this,d)},setChildNodes:function(d,e){var k=y.createFragment(),c=this.grouping||this,l=c.childNodesElement;c.childNodesElement=k;b.setChildNodes.call(this,d,e);l.insertBefore(k,l.insertPoint||null);c.childNodesElement===k&&(c.childNodesElement=l)}}};var k=t(C,A,{className:g+".PartitionNode",binding:{title:"data:"}}),C=t(x,P,{className:g+".GroupingNode",
childClass:k,groupingClass:t.SELF,emit_ownerChanged:function(b){this.syncDomRefs();x.prototype.emit_ownerChanged.call(this,b)},listen:{owner:{templateChanged:function(){this.syncDomRefs();for(var b=this.lastChild;b;b=b.previousSibling)this.insertBefore(b,b.nextSibling)}}},init:function(){this.element=this.childNodesElement=this.nullElement=y.createFragment();x.prototype.init.call(this)},syncDomRefs:function(){var b=this,d=this.owner,e=null;d&&(e=d.tmpl&&d.tmpl.groupsElement||d.childNodesElement,e.appendChild(this.nullElement));
do b.element=b.childNodesElement=e;while(b=b.grouping)}}),R=t(J,A,P,{className:g+".Node",childClass:t.SELF,childFactory:function(b){return new this.childClass(b)},groupingClass:C});H.exports={BINDING_PRESET:G,Node:R,PartitionNode:k,GroupingNode:C};H.exports.Container=R}],["basis.router",function(g,H,b,t,J,A,P){function z(){var g=y.hash.substr(1)||"/";if(g!=N){var r=[],m=[];N=g;for(var e in q){var d=q[e],k=g.match(d.regexp);k?(C[e]||r.push(d),C[e]=k):C[e]&&(m.push(d),delete C[e])}for(g=0;d=m[g];g++)for(var d=
b.array.from(d.callbacks),p=0;k=d[p];p++)k.callback.leave&&k.callback.leave.call(k.context);for(g=0;d=r[g];g++){d=b.array.from(d.callbacks);for(p=0;k=d[p];p++)k.callback.enter&&k.callback.enter.call(k.context)}for(e in C){d=q[e];r=b.array.from(C[e],1);d=b.array.from(d.callbacks);for(g=0;k=d[g];g++)k.callback.match&&k.callback.match.apply(k.context,r)}}}b.namespace(String(this.path));var y=t.location;g=t.document.documentMode;g=b.ua.is("IE")&&(!g||7>=g);var v="onhashchange"in t&&!g,p=/:\w+/g,F=/\\\*\w+/g,
q={},C={},x=!1,N,G;H.exports={debug:!1,add:function(g,r,m){var e=q[g],d;if(!e&&(e=q[g]={source:g,callbacks:[],regexp:"[object RegExp]"!=Object.prototype.toString.call(g)?RegExp("^"+String(g).forRegExp().replace(p,"([^/]+)").replace(F,"(.*?)")+"$","i"):g},N&&(d=N.match(e.regexp))))C[g]=d;r={cb_:r,callback:"function"!=typeof r?r:{match:r},context:m};e.callbacks.push(r);if(d=C[g])r.callback.enter&&r.callback.enter.call(m),r.callback.match&&r.callback.match.apply(m,b.array.from(d,1))},remove:function(b,
g,m){var e=q[b];if(e)for(var d=0,k;k=e.callbacks[d];d++)if(k.cb_===g&&k.context===m){e.callbacks.splice(d,1);e.callbacks.length||(delete q[b],delete C[b]);break}},stop:function(){x&&(v?b.dom.event.removeHandler(t,"hashchange",z):clearInterval(G),x=!1)},start:function(){x||(v?b.dom.event.addHandler(t,"hashchange",z):G=setInterval(z,50),x=!0,z())},checkUrl:z,navigate:function(b,g){g?y.replace(y.pathname+"#"+b):y.hash=b;x&&z()}}}],["app.router",function(g,H,b,t,J,A,P){var z=b.ui.Node.prototype.postInit,
y=b.ui.Node.prototype.destroy;b.ui.Node.prototype.postInit=function(){z.call(this);this.router&&b.router.add(this.router,this.routerCallback,this)};b.ui.Node.prototype.destroy=function(){this.router&&b.router.remove(this.router,this.routerCallback,this);y.call(this)};b.ui.Node.prototype.routerCallback=b.Class.extensibleProperty({enter:function(){this.select()},leave:function(){this.unselect()}});H.exports=b.router.exports}],["app",function(g,H,b,t,J,A,P){H.exports=b.app.create({title:"EventShot",
init:function(){var g=new b.ui.Node({selection:!0,listen:{selection:{itemsChanged:function(b){b.itemCount||this.firstChild.select()}}},childClass:{template:b.template.get("#1"),handler:{select:function(){this.lazyContent&&(this.appendChild(this.lazyContent()),this.lazyContent=null)}}},childNodes:[{selected:!0,name:"welcome",lazyContent:b.resource("0.js")},{selected:!0,name:"add-event",router:"/add-event",lazyContent:b.resource("1.js")},{name:"list",router:"/list",lazyContent:b.resource("2.js")},{name:"event",
router:/^\/event(\/.*)?$/,lazyContent:b.resource("3.js")}]});b.router.start();return new b.ui.Node({template:b.template.get("#2"),binding:{pages:g},action:{showEventList:function(){b.router.navigate("/list")},createEvent:function(){b.router.navigate("/add-event")}}})}})}],["basis.date",function(g,H,b,t,J,A,P){function z(b){return 10>b?"0"+b:b}function y(b){return 100>b?"0"+z(b):b}function v(b){return!(b%400&&(!(b%100)||b%4))}function p(b,d){return 1==b?28+v(d):q[b]}function F(b,d,k){var g=function(d,
k){switch(k){case "y":return String(b.getFullYear()).substr(2);case "Y":return b.getFullYear();case "d":return b.getDate();case "D":return z(b.getDate());case "m":return b.getMonth()+1;case "M":return z(b.getMonth()+1);case "h":return b.getHours();case "H":return z(b.getHours());case "i":return z(b.getHours()%12||12);case "p":return 12<b.getHours()?"pm":"am";case "P":return 12<b.getHours()?"PM":"AM";case "I":return z(b.getMinutes());case "s":return b.getSeconds();case "S":return z(b.getSeconds());
case "z":return b.getMilliseconds();case "Z":return y(b.getMilliseconds())}},m=function(d,k){switch(k){case "y":return String(b.getUTCFullYear()).substr(2);case "Y":return b.getUTCFullYear();case "d":return b.getUTCDate();case "D":return z(b.getUTCDate());case "m":return b.getUTCMonth()+1;case "M":return z(b.getUTCMonth()+1);case "h":return b.getUTCHours();case "H":return z(b.getUTCHours());case "i":return z(b.getUTCHours()%12||12);case "p":return 12<b.getUTCHours()?"pm":"am";case "P":return 12<b.getUTCHours()?
"PM":"AM";case "I":return z(b.getUTCMinutes());case "s":return b.getUTCSeconds();case "S":return z(b.getUTCSeconds());case "z":return b.getUTCMilliseconds();case "Z":return y(b.getUTCMilliseconds())}};return d.replace(G,k?m:g)}var q=[31,28,31,30,31,30,31,31,30,31,30,31],C={day:864E5,hour:36E5,minute:6E4,second:1E3};"year month day hour minute second millisecond".qw();var x={},N={};b.object.iterate({year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"},
function(b,d){x[b]=function(b){return b["get"+d]()};N[b]=function(b,e){return b["set"+d](e)}});var G=/%([yYdDmMhHipPIsSzZ])/g,I=/\D/,r=/(.{10,})([\-\+]\d{1,2}):?(\d{1,2})?$/;b.object.extend(Date.prototype,{isLeapYear:function(){return v(this.getFullYear())},getMonthDayCount:function(){return p(this.getMonth(),this.getFullYear())},add:function(b,d){var k=x[b];if(!k)throw 35;var g;if("year"==b||"month"==b)g=this.getDate(),28<g&&this.setDate(1);N[b](this,k(this)+d);28<g&&(k=this.getMonthDayCount(),this.setDate(Math.min(g,
k)));return this},diff:function(b,d){if("year"==b||"month"==b){var k=0<Number(this)-Number(d)?-1:1,g=0<k?this:d,m=0<k?d:this,r=g.getFullYear(),r=m.getFullYear()-r;if("year"==b)return k*r;g=g.getMonth();m=m.getMonth();return k*(r?(1<r?12*(r-1):0)+(11-g)+(m+1):m-g)}k=Math.floor((d-this)/C[b]);return k+Number(0!=x[b](new Date(d-k*C[b]))-x[b](this))},set:function(b,d){var k=N[b];if(!k)throw 36;var g;if("year"==b||"month"==b)g=this.getDate(),28<g&&this.setDate(1);k(this,d);28<g&&(k=this.getMonthDayCount(),
this.setDate(Math.min(g,k)));return this},get:function(b){if(x[b])return x[b](this);throw 37;},toISODateString:function(){return F(this,"%Y-%M-%D",!0)},toISOTimeString:function(){return F(this,"%H:%I:%S.%Z",!0)},fromDate:function(b){b instanceof Date&&(this.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),this.setTime(b.getTime()));return this},toFormat:function(b){return F(this,b)}});b.object.complete(Date.prototype,{toISOString:function(){return this.toISODateString()+"T"+this.toISOTimeString()+
"Z"},fromISOString:function(b){return this.fromDate(m(b))}});var m=function(){function b(d,e,g,m,r,c,l){return new Date(d,e-1,g,m||0,(r||0)-k,c||0,l?l.substr(0,3):0)}var d=(new Date).getTimezoneOffset(),k;return function(g){return b.apply(k=d,String(g||"").replace(r,function(b,d,e,g){k+=g?60*e+1*g:1*e;return d}).split(I))}}();H.exports={monthNumToAbbr:"jan feb mar apr may jun jul aug sep oct nov dec".split(" "),dayNumToAbbr:"mon tue wed thr fri sat sun".split(" "),isLeapYear:v,getMonthDayCount:p,
format:F,fromISOString:m}}],["basis.data.dataset",function(g,H,b,t,J,A,P){function z(c,b){var d={},e;c&&c.length&&(e=d.inserted=c);b&&b.length&&(e=d.deleted=b);if(e)return d}function y(c,d){return function Q(d){if(!d)return null;if(d.__extend__)return d;"string"!=typeof d&&!Array.isArray(d)&&(d="object"==typeof d?b.object.keys(d):null);return F(b.event.createHandler(d,c),{__extend__:Q})}(d)}function v(c,b){if(!c.length)return 0;var d,e=b.object.basisObjectId,k=b.value,g,a,n=0,m=c.length-1;do if(d=
n+m>>1,a=c[d],g=a.value,g===k)if(a=a.object.basisObjectId,e<a)m=d-1;else if(e>a)n=d+1;else return e==a?d:0;else if(k<g)m=d-1;else if(k>g)n=d+1;else return k==g?d:0;while(n<=m);return d+(g<k)}function p(c,b){return+(c.value>b.value)||-(c.value<b.value)||c.object.basisObjectId-b.object.basisObjectId}A=this.path;P=b.Class;var F=b.object.extend,q=b.object.values,C=b.getter,x=b.fn.$self,N=b.fn.$true,G=b.fn.$false,I=b.array.from,r=b.event.create,m=b.data.SUBSCRIPTION,e=b.data.Object,d=b.data.KeyObjectMap,
k=b.data.AbstractDataset,R=b.data.Dataset;m.add("SOURCE",{sourceChanged:function(c,b){b&&m.unlink("source",c,b);c.source&&m.link("source",c,c.source)},sourcesChanged:function(c,b){var d;if(d=b.inserted)for(var e=0;d[e];e++)m.link("source",c,d[e]);if(d=b.deleted)for(e=0;d[e];e++)m.unlink("source",c,d[e])}},function(c,b){for(var d=b.sources||(b.source?[b.source]:[]),e=0,k;k=d[e++];)c("source",b,k)});m.addProperty("minuend");m.addProperty("subtrahend");var D=P(k,{className:A+".Merge",subscribeTo:m.SOURCE,
emit_sourcesChanged:r("sourcesChanged","delta"),sources:null,rule:function(c,b){return 0<c},listen:{source:{itemsChanged:function(c,b){var d=this.members_,e={},k,g;if(b.inserted)for(var a=0;k=b.inserted[a];a++)g=k.basisObjectId,d[g]?d[g].count++:d[g]={count:1,object:k},e[g]=d[g];if(b.deleted)for(a=0;k=b.deleted[a];a++)g=k.basisObjectId,e[g]=d[g],d[g].count--;this.applyRule(e)},destroy:function(c){this.removeSource(c)}}},init:function(){k.prototype.init.call(this);var c=this.sources;this.sources=[];
c&&c.forEach(this.addSource,this)},setRule:function(c){"function"!=typeof c&&(c=D.UNION);this.rule!==c&&(this.rule=c,this.applyRule())},applyRule:function(c){var b=this.members_,d=this.rule,e=this.sources.length,k=[],g=[],a,n;c||(c=b);for(var m in c)c=b[m],a=e&&c.count&&d(c.count,e),a!=!!this.items_[m]&&(a?k:g).push(c.object),0==c.count&&delete b[m];(n=z(k,g))&&this.emit_itemsChanged(n);return n},addSource:function(b){if(b instanceof k&&this.sources.add(b)){this.listen.source&&b.addHandler(this.listen.source,
this);var d=this.members_,e;for(e in b.items_)d[e]?d[e].count++:d[e]={count:1,object:b.items_[e]};this.applyRule();this.emit_sourcesChanged({inserted:[b]});return!0}},removeSource:function(b){if(this.sources.remove(b)){this.listen.source&&b.removeHandler(this.listen.source,this);var d=this.members_,e;for(e in b.items_)d[e].count--;this.applyRule();this.emit_sourcesChanged({deleted:[b]});return!0}},setSources:function(b){for(var d=I(this.sources),e=0,g;g=b[e];e++)g instanceof k&&(d.remove(g)||this.addSource(g));
d.forEach(this.removeSource,this)},clear:function(){I(this.sources).forEach(this.removeSource,this)},destroy:function(){k.prototype.destroy.call(this);this.sources=null}});D.UNION=D.prototype.rule;D.INTERSECTION=function(b,d){return b==d};D.DIFFERENCE=function(b,d){return 1==b};D.MORE_THAN_ONE_INCLUDE=function(b,d){return 1==d||1<b};D.AT_LEAST_ONE_EXCLUDE=function(b,d){return 1==d||b<d};var E=function(b){return!this.has(b)};g=P(k,{className:A+".Subtract",subscribeTo:m.MINUEND+m.SUBTRAHEND,minuend:null,
emit_minuendChanged:r("minuendChanged","oldMinuend"),subtrahend:null,emit_subtrahendChanged:r("subtrahendChanged","oldSubtrahend"),listen:{minuend:{itemsChanged:function(b,d){if(this.subtrahend){var e=z(d.inserted&&d.inserted.filter(E,this.subtrahend),d.deleted&&d.deleted.filter(this.has,this));e&&this.emit_itemsChanged(e)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{itemsChanged:function(b,d){if(this.minuend){var e=z(d.deleted&&d.deleted.filter(E,this),d.inserted&&d.inserted.filter(this.has,
this));e&&this.emit_itemsChanged(e)}},destroy:function(){this.setOperands(this.minuend,null)}}},init:function(){k.prototype.init.call(this);var b=this.minuend,d=this.subtrahend;this.subtrahend=this.minuend=null;(b||d)&&this.setOperands(b,d)},setOperands:function(b,d){var e,g=!1;!1==b instanceof k&&(b=null);!1==d instanceof k&&(d=null);var m=this.minuend,M=this.subtrahend;if(m!==b){g=!0;this.minuend=b;var a=this.listen.minuend;a&&(m&&m.removeHandler(a,this),b&&b.addHandler(a,this));this.emit_minuendChanged(m)}if(M!==
d){g=!0;this.subtrahend=d;if(a=this.listen.subtrahend)M&&M.removeHandler(a,this),d&&d.addHandler(a,this);this.emit_subtrahendChanged(M)}if(!g)return!1;if(!b||!d)this.itemCount&&this.emit_itemsChanged(e={deleted:this.getItems()});else{var g=[],m=[],n;for(n in this.items_)(!b.items_[n]||d.items_[n])&&g.push(this.items_[n]);for(n in b.items_)!this.items_[n]&&!d.items_[n]&&m.push(b.items_[n]);(e=z(m,g))&&this.emit_itemsChanged(e)}return e},setMinuend:function(b){return this.setOperands(b,this.subtrahend)},
setSubtrahend:function(b){return this.setOperands(this.minuend,b)},clear:function(){this.setOperands()}});var L=P(k,{className:A+".SourceDataset",subscribeTo:m.SOURCE,source:null,sourceMap_:null,emit_sourceChanged:r("sourceChanged","oldSource"),listen:{source:{destroy:function(){this.setSource()}}},init:function(){this.sourceMap_={};var b=this.source;b&&(this.source=null);k.prototype.init.call(this);b&&this.setSource(b)},setSource:function(b){!1==b instanceof k&&(b=null);if(this.source!==b){var d=
this.source,e=this.listen.source;this.source=b;if(e){var g=e.itemsChanged;d&&(d.removeHandler(e,this),g&&g.call(this,d,{deleted:d.getItems()}));b&&(b.addHandler(e,this),g&&g.call(this,b,{inserted:b.getItems()}))}this.emit_sourceChanged(d)}},clear:function(){this.setSource()},destroy:function(){k.prototype.destroy.call(this);this.sourceMap_=null}}),O=P(L,{className:A+".MapFilter",map:x,filter:G,rule:C(N),ruleEvents:y(function(b){var d=this.map?this.map(b):object;if(!1==d instanceof e||this.filter(d))d=
null;var k=this.sourceMap_[b.basisObjectId],g=k.member;if(g!==d){var m=this.members_,M,a,n;k.member=d;g&&(k=g.basisObjectId,this.removeMemberRef&&this.removeMemberRef(g,b),0==--m[k]&&(delete m[k],n=[g]));d&&(g=d.basisObjectId,this.addMemberRef&&this.addMemberRef(d,b),m[g]?m[g]++:(m[g]=1,a=[d]));(M=z(a,n))&&this.emit_itemsChanged(M)}},"update"),addMemberRef:null,removeMemberRef:null,listen:{source:{itemsChanged:function(b,d){var k=this.sourceMap_,g=this.members_,m=[],M=[],a,n,u,r=this.ruleEvents;R.setAccumulateState(!0);
if(d.inserted)for(var p=0;a=d.inserted[p];p++){u=this.map?this.map(a):a;if(!1==u instanceof e||this.filter(u))u=null;r&&a.addHandler(r,this);k[a.basisObjectId]={sourceObject:a,member:u};u&&(n=u.basisObjectId,g[n]?g[n]++:(g[n]=1,m.push(u)),this.addMemberRef&&this.addMemberRef(u,a))}if(d.deleted)for(p=0;a=d.deleted[p];p++)n=a.basisObjectId,u=k[n].member,r&&a.removeHandler(r,this),delete k[n],u&&(n=u.basisObjectId,0==--g[n]&&(delete g[n],M.push(u)),this.removeMemberRef&&this.removeMemberRef(u,a));R.setAccumulateState(!1);
(d=z(m,M))&&this.emit_itemsChanged(d)}}},setMap:function(b){"function"!=typeof b&&(b=x);if(this.map!==b)return this.map=b,this.applyRule()},setFilter:function(b){"function"!=typeof b&&(b=G);if(this.filter!==b)return this.filter=b,this.applyRule()},setRule:function(b){"function"!=typeof b&&(b=N);if(this.rule!==b)return this.rule=b,this.applyRule()},applyRule:function(){var b=this.sourceMap_,d=this.members_,k,g,m,M,a,n=[],u=[],r,p;for(p in b){a=b[p];M=a.sourceObject;k=a.member;g=this.map?this.map(M):
M;if(!1==g instanceof e||this.filter(g))g=null;k!=g&&(a.member=g,k&&(m=k.basisObjectId,this.removeMemberRef&&this.removeMemberRef(k,M),d[m]--),g&&(k=g.basisObjectId,this.addMemberRef&&this.addMemberRef(g,M),k in d?d[k]++:(d[k]=1,n.push(g))))}for(m in this.items_)0==d[m]&&(delete d[m],u.push(this.items_[m]));(r=z(n,u))&&this.emit_itemsChanged(r);return r}});t=P(O,{className:A+".Subset",filter:function(b){return!this.rule(b)}});J=P(O,{className:A+".Split",subsetClass:k,keyMap:null,map:function(b){return this.keyMap.resolve(b)},
setRule:function(b){"function"!=typeof b&&(b=N);if(this.rule!==b)return this.rule=b,this.keyMap.keyGetter=b,this.applyRule()},addMemberRef:function(b,d){b.emit_itemsChanged({inserted:[d]})},removeMemberRef:function(b,d){b.emit_itemsChanged({deleted:[d]})},init:function(){if(!this.keyMap||!1==this.keyMap instanceof d)this.keyMap=new d(F({keyGetter:this.rule,itemClass:this.subsetClass},this.keyMap));O.prototype.init.call(this)},getSubset:function(b,d){return this.keyMap.get(b,d)},destroy:function(){O.prototype.destroy.call(this);
this.keyMap.destroy();this.keyMap=null}});r=P(L,{className:A+".Slice",rule:C(N),ruleEvents:y(function(b){var d=this.sourceMap_[b.basisObjectId];b=this.rule(b);var e=this.index_;b!==d.value&&(e.splice(v(e,d),1),d.value=b,e.splice(v(e,d),0,d),this.applyRule())},"update"),index_:null,orderDesc:!1,offset:0,limit:10,listen:{source:{itemsChanged:function(b,d){var e=this.sourceMap_,k=this.index_,g=this.ruleEvents,m=!1,a=!1,n,u=d.inserted,r=d.deleted;if(r){r.length>k.length-r.length&&(m=!0,a=r.length!=k.length,
k.length=0);for(var D=0,q;q=r[D];D++)m||(n=e[q.basisObjectId],k.splice(v(k,n),1)),delete e[q.basisObjectId],g&&q.removeHandler(g,this);if(a)for(var h in e)n=e[h],k.splice(v(k,n),0,n)}if(u){a=!k.length;for(D=0;q=u[D];D++)n={object:q,value:this.rule(q)},e[q.basisObjectId]=n,a?k.push(n):k.splice(v(k,n),0,n),g&&q.addHandler(g,this);a&&k.sort(p)}this.applyRule()}}},emit_rangeChanged:r("rangeChanged","oldOffset","oldLimit"),init:function(){this.index_=[];L.prototype.init.call(this)},setRange:function(b,
d){var e=this.offset,k=this.limit,g=!1;if(e!=b||k!=d)this.offset=b,this.limit=d,g=this.applyRule(),this.emit_rangeChanged(e,k);return g},setOffset:function(b){return this.setRange(b,this.limit)},setLimit:function(b){return this.setRange(this.offset,b)},applyRule:function(){var c=this.offset,d=c+this.limit;this.orderDesc&&(c=this.index_.length-d,d=c+this.limit);for(var e=b.object.slice(this.items_),c=this.index_.slice(Math.max(0,c),Math.max(0,d)),d=[],k,g=0,m;m=c[g];g++){var a=m.object.basisObjectId;
e[a]?delete e[a]:d.push(m.object)}(k=z(d,q(e)))&&this.emit_itemsChanged(k);return k},destroy:function(){L.prototype.destroy.call(this);this.index_=null}});A=P(L,{className:A+".Cloud",subsetClass:k,rule:C(G),ruleEvents:y(function(b){var d=this.sourceMap_,e=this.members_,k=b.basisObjectId,g=d[k].list,d=d[k].list={},k=this.rule(b),m,a=[],n=[],u;if(Array.isArray(k))for(var r=0;r<k.length;r++)if((u=this.keyMap.resolve(k[r]))&&!u.has(b))p=u.basisObjectId,d[p]=u,g[p]||(u.emit_itemsChanged({inserted:[b]}),
e[p]?e[p]++:(a.push(u),e[p]=1));for(var p in g)d[p]||(u=g[p],u.emit_itemsChanged({deleted:[b]}),--e[p]||(delete e[p],n.push(u)));(m=z(a,n))&&this.emit_itemsChanged(m)},"update"),keyMap:null,map:x,listen:{source:{itemsChanged:function(b,d){var e=this.sourceMap_,k=this.members_,g=this.ruleEvents,m,a,n,u=[],r=[];R.setAccumulateState(!0);if(m=d.inserted)for(var p=0,q;q=m[p];p++){var h=this.rule(q),f={object:q,list:{}};e[q.basisObjectId]=f;if(Array.isArray(h))for(var s=0,D={};s<h.length;s++)if((a=this.keyMap.get(h[s],
!0))&&!D[a.basisObjectId])n=a.basisObjectId,D[n]=!0,f.list[n]=a,a.emit_itemsChanged({inserted:[q]}),k[n]?k[n]++:(u.push(a),k[n]=1);g&&q.addHandler(g,this)}if(m=d.deleted)for(p=0;q=m[p];p++){a=q.basisObjectId;h=e[a].list;delete e[a];for(n in h)a=h[n],a.emit_itemsChanged({deleted:[q]}),--k[n]||(delete k[n],r.push(a));g&&q.removeHandler(g,this)}R.setAccumulateState(!1);(d=z(u,r))&&this.emit_itemsChanged(d)}}},init:function(){if(!this.keyMap||!1==this.keyMap instanceof d)this.keyMap=new d(F({keyGetter:this.map,
itemClass:this.subsetClass},this.keyMap));L.prototype.init.call(this)},getSubset:function(b,d){return this.keyMap.get(b,d)},destroy:function(){L.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});H.exports={createRuleEvents:y,Merge:D,Subtract:g,SourceDataset:L,MapFilter:O,Subset:t,Split:J,Slice:r,Cloud:A}}],["basis.entity",function(g,H,b,t,J,A,P){function z(a){n[a]=n[a]||0;return a+n[a]++}function y(a,b){var c=U[a];if(c){for(var d=0,f;f=c[d];d++)f[0][f[1]]=b;delete U[a]}u[a]=b}
function v(a,b,c){if(u[a])return u[a];var d=U[a];d||(d=U[a]=[]);d.push([b,c]);return V}function p(){var a=d(arguments),b=a.pop(),c=a[0],f=a[1],e=a[2],h;if("function"!=typeof b)throw 39;switch(a.length){case 0:h=function(){return b()};break;case 1:h=function(a,d,f){return c in a?b(d[c]):f};break;case 2:h=function(a,d,e){return c in a||f in a?b(d[c],d[f]):e};break;case 3:h=function(a,d,h){return c in a||f in a||e in a?b(d[c],d[f],d[e]):h};break;default:h=function(c,d,f){for(var e=!1,h=[],k=0,g;g=a[k];k++)e=
e||g in c,h.push(d[g]);return e?b.apply(null,h):f}}h.args=a;return h.calc=h}function F(){return p.apply(null,d(arguments).concat(function(){for(var a=[],b=arguments.length;0<b--;){if(null==arguments[b])return null;a.push(arguments[b])}return a.join("-")}))}function q(a,b){if(!Array.isArray(a))return null;if(!Array.isArray(b)||a.length!=b.length)return a||null;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return a;return b}function C(c,d,f){if(!c.all.itemCount){c.aliases[d]=d;f="string"==typeof f||Array.isArray(f)||
"function"==typeof f&&f.calc!==f?{type:f}:b.object.slice(f);if("type"in f){"string"==typeof f.type&&(f.type=v(f.type,c.fields,d));if(Array.isArray(f.type)){var h=f.type.slice();f.type=function(a,b){return-1!=h.indexOf(a)?a:b};f.defValue=f.type(f.defValue,h[0])}f.type===Array&&(f.type=q);"function"!=typeof f.type&&(f.type=e)}var k=f.type||e;[Q,K,M,a].has(k)&&(f.id=!0);f.id&&(c.index||(c.index=new W(String)),c.idFields[d]=!0,c.idField||c.compositeKey?(c.idField=null,c.compositeKey=F.apply(null,r(c.idFields))):
c.idField=d);f.calc?N(c,d,f.calc):c.fields[d]=k;c.defaults[d]="defValue"in f?f.defValue:k();c.entityClass.prototype["get_"+d]=function(a){return a&&this.modified&&d in this.modified?this.modified[d]:this.data[d]};c.entityClass.prototype["set_"+d]=function(a,b){return this.set(d,a,b)};Z[d]||(Z[d]={destroy:function(){this.set(d,null)}})}}function x(a,b,c){c in a.fields&&!1==b in a.aliases&&(a.aliases[b]=c)}function N(a,b,c){if(!b||!a.fields[b]){a.calcs||(a.calcs=[]);var d={args:c.args||[],wrapper:c},
f=a.calcs.length,e=0;if(c.args)for(var h=0;h<a.calcs.length;h++)c.args.has(a.calcs[h].key)&&(e=h+1);if(b){d.key=b;for(h=0;h<a.calcs.length;h++)if(a.calcs[h].args.has(b)){f=h;break}if(e>f)return;a.idField&&b==a.idField&&(a.compositeKey=c);a.fields[b]=function(a,b){return b}}else f=e;a.calcs.splice(Math.min(f,e),0,d)}}var G=this.path,I=b.Class,r=b.object.keys,m=b.object.extend,e=b.fn.$self,d=b.array.from,k=b.event.Emitter;g=b.event.create;var R=b.data.Object,D=b.data.Slot,E=b.data.Dataset;t=b.data.dataset.Subset;
var L=b.data.dataset.Split,O=b.data.STATE,c={},l={string:1,number:1},B=[],Q=function(a){return isNaN(a)?null:Number(a)},K=function(a){return isNaN(a)?null:Number(a)},M=function(a){return isNaN(a)?null:parseInt(a,10)},a=function(a){return null==a?null:String(a)},n={},u={},U={},V=function(){},W=b.Class(null,{className:G+".Index",items:null,fn:String,init:function(a){this.items={};"function"==typeof a&&(this.fn=a)},calcWrapper:function(a,b){var c=this.fn(a,b);if(c!==b&&this.items[c])throw 38;return c},
get:function(a,b){var c=this.items[a];if(!b||c instanceof b)return c},add:function(a,b){var c=this.items[a];if(b&&(!c||c===b))return this.items[a]=b,!0},remove:function(a,b){if(this.items[a]===b)return delete this.items[a],!0},destroy:function(){this.items=null}});P=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}};J=function(a,b){return function(){this.name||(this.name=z(b));a.prototype.init.call(this)}};A=function(a){return function(a){var c=b.object.slice(this.items_),
d=[];if(a){E.setAccumulateState(!0);for(var f=0;f<a.length;f++){var e=this.wrapper(a[f]);e&&(c[e.basisObjectId]=!1)}E.setAccumulateState(!1)}for(var h in this.items_)!1==h in c&&d.push(this.items_[h]);for(h in c)c[h]&&c[h].destroy();return d.length?d:null}};var h=I(E,{className:G+".EntitySet",wrapper:e,init:J(E,"EntitySet"),sync:A(E),set:P(E,"set"),add:P(E,"add"),remove:P(E,"remove"),destroy:function(){E.prototype.destroy.call(this);this.wrapper=null}}),f=I(h,{className:G+".ReadOnlyEntitySet",set:b.fn.$false,
add:b.fn.$false,remove:b.fn.$false,clear:b.fn.$false});P=I(t,{className:G+".EntityCollection",init:J(t,"EntityCollection"),sync:A(t)});P.sourceHandler=t.sourceHandler;t=I(L,{className:G+".EntityGrouping",subsetClass:f,init:J(L,"EntityGrouping"),sync:A(L),getSubset:function(a,b){var c=L.prototype.getSubset.call(this,a,b);c&&(c.wrapper=this.wrapper);return c}});var s=function(a,b){if(this instanceof s){a||(a=e);if(!b||u[b])b=z("UntitledEntitySetType");var c=new S({entitySetClass:{wrapper:a}}),f=c.entitySetClass,
k=function(a,b){return null!=a?(b instanceof h||(b=c.createEntitySet()),b.set(a instanceof E?a.getItems():d(a)),b):null};"string"==typeof a&&(f.prototype.wrapper=v(a,f.prototype,"wrapper"));y(b,k);m(k,{type:c,typeName:b,toString:function(){return this.typeName+"()"},entitySetType:c,extend:function(){return f.extend.apply(f,arguments)},reader:function(a){if(Array.isArray(a)){var b=f.prototype.wrapper;return a.map(b.reader||b)}return a}});return k}},S=I(null,{className:G+".EntitySetConstructor",entitySetClass:h,
extendConstructor_:!0,createEntitySet:function(){return new this.entitySetClass}}),T=function(a){if(this instanceof T){var b;b=a.singleton?function(a){var b=c.get();b?a&&b.update(a):b=new d(a||{});return b}:function(a,b){if(null!=a){if(a===b||a.entityType===c)return a;var f,e=c.idField;if(l[typeof a]){if(!e)return;f=a;a={};a[e]=f}else c.compositeKey?f=c.compositeKey(a,a):e&&(f=a[e]);null!=f&&(b=c.index.get(f,c.entityClass));b&&b.entityType===c?b.update(a):b=new d(a);return b}};var c=new aa(a||{},
b),d=c.entityClass;y(c.name,b);m(b,{all:c.all,type:c,typeName:c.name,entityType:c,toString:function(){return this.typeName+"()"},reader:function(a){return c.reader(a)},addField:function(a,b){c.addField(a,b)},addCalcField:function(a,b){c.addCalcField(a,b)},get:function(a){return c.get(a)},getSlot:function(a,b){return c.getSlot(a,b)},extend:function(){return d.extend.apply(d,arguments)}});return b}},Z={},aa=I(null,{className:G+".EntityType",wrapper:null,all:null,fields:null,idFields:null,defaults:null,
aliases:null,slots:null,singleton:!1,index:null,entityClass:null,init:function(a,c){this.name=a.name;if(!this.name||u[this.name])this.name=z("UntitledEntityType");this.fields={};this.idFields={};this.defaults={};this.aliases={};this.slots={};var d=a.index;d&&d instanceof W&&(this.index=d);this.wrapper=c;this.all=new f(b.object.complete({wrapper:c},a.all));if(this.singleton=!!a.singleton){var e;this.get=function(){return e};this.all.addHandler({itemsChanged:function(a,b){e=b.inserted?b.inserted[0]:
null}},this)}this.entityClass=da(this,this.all,this.fields,this.defaults,this.slots);this.entityClass.extend({entityType:this,type:c,typeName:this.name,state:a.state||this.entityClass.prototype.state});for(var h in a.fields)C(this,h,a.fields[h]);for(h in a.aliases)x(this,h,a.aliases[h]);a.constrains&&a.constrains.forEach(function(a){N(this,null,a)},this);B.push(this)},reader:function(a){var b={};if(l[typeof a])return this.idField?a:null;if(!a||null==a)return null;for(var c in a){var d=this.aliases[c];
if(d){var f=this.fields[d].reader;b[d]=f?f(a[c]):a[c]}}return b},get:function(a){a=this.getId(a);if(null!=a)return this.index.get(a,this.entityClass)},getId:function(a){if((this.idField||this.compositeKey)&&null!=a){if(l[typeof a])return a;if(a&&a.entityType===this)return a.__id__;a instanceof R&&(a=a.data);return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(null!=b){var c=this.slots[b];c||(l[typeof a]&&(c={},this.idField&&!this.compositeKey&&
(c[this.idField]=a),a=c),c=this.slots[b]=new D({delegate:this.get(b),data:a}));return c}}}),Y=I(R,{className:G+".BaseEntity",canSetDelegate:!1,isTarget:!0,modified:null,emit_rollbackUpdate:g("rollbackUpdate")}),da=function(a,b,d,f,e){function h(b,c,d){var f=a.calcs,e=b.data,k=!1,n=b.__id__,l;try{if(f)for(var m=0,u;u=f[m];m++){var r=u.key,M=e[r],p=u.wrapper(c,e,M);r&&p!==M&&(e[r]=p,c[r]=M,k=!0)}l=a.compositeKey?a.compositeKey(c,e,n):a.idField&&a.idField in c?e[a.idField]:n;l!==n&&a.index.calcWrapper(l,
n)}catch(s){k=!1;l=n;for(r in c)b.data[r]=c[r];if(d&&!b.modified)for(r in d){b.modified=d;break}}l!==n&&(b.__id__=l,g(b,n,l));return k}function g(b,c,d){var f=a.index;null!=c&&(f.remove(c,b),e[c]&&e[c].setDelegate());null!=d&&(f.add(d,b),e[d]&&e[d].setDelegate(b))}return I(Y,{className:G+".Entity",extendConstructor_:!1,init:function(a){this.delegate=null;this.data={};Y.prototype.init.call(this);this.fieldHandlers_={};var c,e={},g;for(g in d)g in a?(e[g]=f[g],c=d[g](a[g])):"function"==typeof f[g]?
(e[g]=void 0,c=f[g](a)):c=f[g],c&&c!==this&&c instanceof k&&c.addHandler(Z[g],this)&&(this.fieldHandlers_[g]=!0),this.data[g]=c;h(this,e);b.emit_itemsChanged({inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},getId:function(){return this.__id__},get:function(a,b){return b&&this.modified&&a in this.modified?this.modified[a]:this.data[a]},set:function(b,c,f,e){var g=d[b];if(!g)return!1;var n,l=this.modified;g===q&&(l&&b in l)&&(c=q(c,l[b]));
c=g(c,this.data[b]);g=this.data[b];if(c!==g&&(!c||!g||c.constructor!==Date||g.constructor!==Date||+c!==+g))a:{n={};if(!a.idFields[b])if(f)l||(this.modified=l={}),!1===b in l?(n.rollback={key:b,value:void 0},l[b]=g):l[b]===c&&(n.rollback={key:b,value:c},delete l[b],r(l).length||(this.modified=null));else if(l&&b in l)if(l[b]!==c){n.rollback={key:b,value:l[b]};l[b]=c;break a}else return!1;this.data[b]=c;this.fieldHandlers_[b]&&(g.removeHandler(Z[b],this),this.fieldHandlers_[b]=!1);c&&c!==this&&c instanceof
k&&c.addHandler(Z[b],this)&&(this.fieldHandlers_[b]=!0);n.key=b;n.value=g;n.delta={};n.delta[b]=g}else!f&&(l&&b in l)&&(n={rollback:{key:b,value:l[b]}},delete l[b],r(l).length||(this.modified=null));if(!e&&n){b=n.key;f=n.delta||{};var m;n.rollback&&(m={},m[n.rollback.key]=n.rollback.value);h(this,f,m)&&(b=!0);b&&(this.emit_update(f),n.delta=f);m&&this.emit_rollbackUpdate(m)}return n||!1},update:function(a,b){if(a){var c,d={},f,e={},k,g;for(g in a)if(k=this.set(g,a[g],b,!0))k.key&&(c=!0,d[k.key]=k.value),
k.rollback&&(f=!0,e[k.rollback.key]=k.rollback.value);h(this,d,e)&&(c=!0);c&&this.emit_update(d);f&&this.emit_rollbackUpdate(e)}return c?d:!1},reset:function(){this.update(f)},clear:function(){var a={},b;for(b in this.data)a[b]=void 0;return this.update(a)},commit:function(a){if(this.modified){var b=this.modified;this.modified=null}this.update(a);b&&this.emit_rollbackUpdate(b)},rollback:function(){if(this.state!=O.PROCESSING){if(this.modified){var a=this.modified;this.modified=null;this.update(a);
this.emit_rollbackUpdate(a)}this.setState(O.READY)}},destroy:function(){for(var a in this.fieldHandlers_)this.fieldHandlers_[a]&&this.data[a].removeHandler(Z[a],this);this.fieldHandlers_=c;null!=this.__id__&&g(this,this.__id__,null);R.prototype.destroy.call(this);b.emit_itemsChanged({deleted:[this]});this.data=c;this.modified=null}})};H.exports={isEntity:function(a){return a&&a instanceof Y},createType:function(a,c){var d=a||{};"string"==typeof a?d={name:d,fields:c||{}}:c&&(d=b.object.merge(d,{fields:c}));
return new T(d)},createSetType:function(a,b){return 1<arguments.length?new s(b,a):new s(a)},validate:function(){for(var a in U)b.dev.warn(G+": type `"+a+"` is not defined, but used by "+U[a].length+" type(s)")},getTypeByName:function(a){return u[a]},NumericId:Q,NumberId:K,IntId:M,StringId:a,Index:W,CalculateField:p,calc:p,EntityType:T,Entity:da,BaseEntity:Y,EntitySetType:s,EntitySet:h,ReadOnlyEntitySet:f,Collection:P,Grouping:t}}],["basis.net",function(g,H,b,t,J,A,P){function z(b){var a=I(b);return function(){a.apply(k,
arguments);this.service&&a.apply(this.service,arguments);a.apply(this,arguments)}}function y(b){var a=I(b);return function(){var c=[this].concat(x(arguments));a.apply(k,c);this.transport&&this.transport["emit_"+b].apply(this.transport,c);a.apply(this,arguments)}}function v(b){return String(b).replace(l,function(a){a=a.charCodeAt(0).toHex();return"%"+(2>a.length?"0":"")+a})}function p(d,a){var e={};c.test(a.method)?("multipart/form-data"!=a.contentType&&(e["Content-Type"]=a.contentType+(a.encoding?
";charset="+a.encoding:"")),q.test("gecko")&&(e.Connection="close")):q.test("ie")&&(e["If-Modified-Since"]="Thu, 01 Jan 1970 00:00:00 GMT");b.object.iterate(C(e,a.headers),function(a,b){null!=b&&"function"!=typeof b&&this.setRequestHeader(a,b)},d)}function F(c){var a=this.xhr;a&&("number"!=typeof c&&(c=a.readyState),c!=this.prevReadyState_&&(this.prevReadyState_=c,this.emit_readyStateChanged(c),c==O?(this.clearTimeout(),a.onreadystatechange=b.fn.$undef,"unknown"==typeof a.responseText||!a.responseText&&
!a.getAllResponseHeaders()?(this.emit_abort(),c=this.stateOnAbort):(this.processResponse(),this.isSuccessful()?(this.emit_success(this.getResponseData()),c=r.READY):(this.processErrorResponse(),this.emit_failure(this.data.error),c=r.ERROR)),this.emit_complete(this)):c=r.PROCESSING,this.setState(c,this.data.error)))}g=this.path;var q=b.ua,C=b.object.extend,x=b.array.from,N=b.object.slice,G=b.object.merge,I=b.event.create,r=b.data.STATE,m=b.data.Object,e=b.event.Emitter,d=[],k=new e({abort:function(){for(var b=
x(d),a=0;a<b.length;a++)b[a].abort();return b},handler:{start:function(b){d.add(b.transport)},complete:function(b){d.remove(b.transport)}}}),R=m.subclass({className:g+".AbstractRequest",influence:null,initData:null,requestData:null,transport:null,stateOnAbort:r.UNDEFINED,emit_start:y("start"),emit_timeout:y("timeout"),emit_abort:y("abort"),emit_success:y("success"),emit_failure:y("failure"),emit_complete:y("complete"),emit_stateChanged:function(b){m.prototype.emit_stateChanged.call(this,b);if(this.influence)for(b=
0;b<this.influence.length;b++)this.influence[b].setState(this.state,this.state.data)},init:function(){m.prototype.init.call(this);this.influence=[]},setInfluence:function(b){this.influence=x(b)},clearInfluence:function(){this.influence=null},doRequest:b.fn.$undef,getResponseData:b.fn.$undef,destroy:function(){m.prototype.destroy.call(this);this.requestData=this.initData=null;this.clearInfluence()}}),D=e.subclass({className:g+".AbstractTransport",requestClass:R,requests:null,poolLimit:null,poolHashGetter:b.fn.$true,
emit_start:z("start"),emit_timeout:z("timeout"),emit_abort:z("abort"),emit_success:z("success"),emit_failure:z("failure"),emit_complete:z("complete"),init:function(){this.requests={};this.requestQueue=[];this.inprogressRequests=[];e.prototype.init.call(this);this.addHandler(E,this);this.poolLimit&&this.addHandler(L,this)},getRequestByHash:function(b){var a=this.requests[b];if(!a){for(var c in this.requests)if(this.requests[c].isIdle()&&!this.requestQueue.has(this.requests[c])){a=this.requests[c];
delete this.requests[c];break}a||(a=new this.requestClass({transport:this}));this.requests[b]=a}return a},prepare:b.fn.$true,prepareRequestData:b.fn.$self,request:function(b){if(this.prepare()){b=N(b);var a=this.poolHashGetter(this.prepareRequestData(b)),a=this.getRequestByHash(a,!0);a.initData&&a.abort();a.initData=b;a.requestData=b;a.setInfluence(b.influence||this.influence);this.poolLimit&&this.inprogressRequests.length>=this.poolLimit?(this.requestQueue.push(a),a.setState(r.PROCESSING)):a.doRequest();
return a}},abort:function(){for(var b=0,a;a=this.inprogressRequests[b];b++)a.abort();for(b=0;a=this.requestQueue[b];b++)a.setState(r.ERROR);this.inprogressRequests=[];this.requestQueue=[]},stop:function(){this.stopped||(this.stoppedRequests=this.inprogressRequests.concat(this.requestQueue),this.abort(),this.stopped=!0)},resume:function(){if(this.stoppedRequests){for(var b=0,a;a=this.stoppedRequests[b];b++)a.transport.request(a.initData);this.stoppedRequests=null}this.stopped=!1},destroy:function(){for(var b in this.requests)this.requests[b].destroy();
this.requests={};this.stoppedRequests=this.requestQueue=this.inprogressRequests=null;e.prototype.destroy.call(this)}}),E={start:function(b,a){this.inprogressRequests.add(a)},complete:function(b,a){this.inprogressRequests.remove(a)}},L={complete:function(){var c=this.requestQueue.shift();c&&b.timer.nextTick(function(){c.doRequest()})}},O=4;"HEAD GET POST PUT PATCH DELETE TRACE LINK UNLINK CONNECT".qw();var c=/^(POST|PUT|PATCH|LINK|UNLINK)$/i,l=/[\%\=\&\<\>\s\+]/g,B="native",Q=function(){if("XMLHttpRequest"in
t)return function(){return new XMLHttpRequest};var b=t.ActiveXObject;if(b)for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;B=a[c];c++)try{if(new b(B))return function(){return new b(B)}}catch(d){}throw 40;}();J=R.subclass({className:g+".AjaxRequest",requestStartTime:0,timeout:3E4,timer_:null,debug:!1,emit_readyStateChanged:y("readyStateChanged"),init:function(){R.prototype.init.call(this);this.xhr=Q()},isIdle:function(){return this.xhr.readyState==O||0==
this.xhr.readyState},isSuccessful:function(){try{var b=this.xhr.status;return void 0==b||0==b||200<=b&&300>b}catch(a){}return!1},processResponse:function(){this.update({contentType:this.xhr.getResponseHeader("content-type"),responseText:this.xhr.responseText,responseXML:this.xhr.responseXML,status:this.xhr.status})},getResponseData:function(){return/^application\/json/i.test(this.data.contentType)?this.data.responseText.toObject():this.data.responseText},processErrorResponse:function(){this.update({error:{code:"SERVER_ERROR",
msg:this.xhr.responseText}})},prepare:b.fn.$true,prepareRequestData:function(b){var a=[],d=b.url;b=N(b);for(var e in b.params){var k=b.params[e];null==k||null==k.toString()||a.push(v(e)+"="+v(k.toString()))}a=a.join("&");!b.postBody&&c.test(b.method)&&(b.postBody=a||"",a="");b.routerParams&&(d=d.replace(/:([a-z\_\-][a-z0-9\_\-]+)/gi,function(a,c){if(c in b.routerParams)return b.routerParams[c]}));a&&(d+=(-1==d.indexOf("?")?"?":"&")+a);b.requestUrl=d;return b},doRequest:function(){this.send(this.prepareRequestData(this.requestData))},
send:function(b){this.update({responseText:"",responseXML:"",status:"",error:""});q.test("gecko1.8.1-")&&b.asynchronous&&(this.xhr=Q());this.emit_start();var a=this.xhr;this.prevReadyState_=-1;a.onreadystatechange=F.bind(this);b.asynchronous||F.call(this,0);a.open(b.method,b.requestUrl,b.asynchronous);p(a,b);this.setTimeout(this.timeout);var d=b.postBody;if(c.test(b.method)&&q.test("ie9-"))if("object"==typeof d&&"undefined"!=typeof d.documentElement&&"string"==typeof d.xml)d=d.xml;else if("string"==
typeof d)d=d.replace(/\r/g,"");else if(null==d||""==d)d="[No data]";a.send(d);return!0},repeat:function(){this.requestData&&(this.abort(),this.doRequest())},abort:function(){this.isIdle()||(this.clearTimeout(),this.xhr.abort(),this.xhr.readyState!=O&&F.call(this,O))},setTimeout:function(b){"ontimeout"in this.xhr?(this.xhr.timeout=b,this.xhr.ontimeout=this.timeoutAbort.bind(this)):this.timer_=setTimeout(this.timeoutAbort.bind(this),b)},clearTimeout:function(){!1=="ontimeout"in this.xhr&&(this.timer_=
clearTimeout(this.timer_))},timeoutAbort:function(){this.update({error:{code:"TIMEOUT_ERROR",message:"Timeout error"}});this.emit_timeout(this);this.abort()},destroy:function(){this.abort();this.xhr=null;R.prototype.destroy.call(this)}});var K=D.subclass({className:g+".AjaxTransport",requestClass:J,emit_readyStateChanged:z("readyStateChanged"),asynchronous:!0,method:"GET",contentType:"application/x-www-form-urlencoded",encoding:null,requestHeaders:b.Class.extensibleProperty(),init:function(){D.prototype.init.call(this);
this.params=N(this.params)},setParam:function(b,a){this.params[b]=a},setParams:function(b){this.clearParams();for(var a in b)this.setParam(a,b[a])},removeParam:function(b){delete this.params[b]},clearParams:function(){for(var b in this.params)delete this.params[b]},prepareRequestData:function(b){var a=b.url||this.url;if(!a)throw 41;C(b,{requestUrl:a,url:a,method:b.method||this.method,contentType:b.contentType||this.contentType,encoding:b.encoding||this.encoding,asynchronous:this.asynchronous,headers:G(this.requestHeaders,
b.headers),postBody:b.postBody||this.postBody,params:G(this.params,b.params),routerParams:b.routerParams,influence:b.influence});return b}});H.exports={createEvent:z,transportDispatcher:k,AbstractRequest:R,AbstractTransport:D,AjaxTransport:K,AjaxRequest:J,Transport:K,request:function(c,a,d){"string"==typeof c&&(c={url:c,asynchronous:!(!a&&!d)});var e=new K(c);e.addHandler({success:a&&function(b,c,d){a(d)},failure:d&&function(a,b,c){d(c)},complete:function(){b.timer.nextTick(function(){e.destroy()})}});
c=e.request();if(!c.requestData.asynchronous)return c.getResponseData()}}}],["basis.data.value",function(g,H,b,t,J,A,P){t=this.path;var z=b.getter,y=b.cleaner,v=b.event.Emitter,p=b.data.AbstractData,F=b.data.Value,q=b.data.STATE,C={},x={destroy:function(b){this.removeLink(b)}},N=F.subclass({className:t+".BindValue",links_:null,bindingBridge:{attach:function(b,g,e){return b.addLink(e,g)},detach:function(b,g,e){return b.removeLink(e,g)},get:function(b){return b.value}},emit_change:function(b,g){F.prototype.emit_change.call(this,
b,g);if(!y.globalDestroy)for(var e=this;e=e.links_;)this.apply_(e,g)},init:function(){F.prototype.init.call(this);C[this.basisObjectId]=this},addLink:function(g,m,e){"function"!=typeof e&&(e=z(b.fn.$self,e));this.links_={object:g,field:m,format:e,links_:this.links_};g instanceof v&&g.addHandler(x,this);this.apply_(this.links_);return g},removeLink:function(b,g){for(var e=this,d;d=e,e=e.links_;)if(e.object===b&&(!g||g==e.field))e.field=null,d.links_=e.links_,e.object instanceof v&&e.object.removeHandler(x,
this)},clear:function(){for(var b=this;b=b.links_;)b.object instanceof v&&b.object.removeHandler(x,this);this.links_=null},apply_:function(b,g){var e=b.field;if(null!=e){var d=b.format(this.value),k=b.object;"function"==typeof e?e.call(k,d,2>arguments.length?d:b.format(g)):k[e]=d}},destroy:function(){this.clear();F.prototype.destroy.call(this);this.links_=null;delete C[this.basisObjectId]}});g=N.subclass({className:t+".Property",extendConstructor_:!1,init:function(b,g,e){this.value=b;this.handler=
g;this.proxy=e;N.prototype.init.call(this)}});var G={stateChanged:function(){this.fire(!1,!0)},update:function(){this.fire(!0)},change:function(){this.fire(!0)},destroy:function(b){this.remove(b)}},I=N.subclass({className:t+".ObjectSet",objects:null,value:0,valueChanged_:!1,calculateValue:function(){return this.value+1},calculateOnInit:!1,statePriority:q.priority,stateChanged_:!0,timer_:!1,init:function(){N.prototype.init.call(this);var b=this.objects;this.objects=[];b&&Array.isArray(b)&&(this.lock(),
this.add.apply(this,b),this.unlock());this.valueChanged_=this.stateChanged_=!!this.calculateOnInit;this.update()},add:function(){for(var b=0,g=arguments.length;b<g;b++){var e=arguments[b];if(e instanceof p)this.objects.add(e)&&e.addHandler(G,this);else throw 46;}this.fire(!0,!0)},remove:function(b){this.objects.remove(b)&&b.removeHandler(G,this);this.fire(!0,!0)},clear:function(){for(var b=0,g;g=this.objects[b];b++)g.removeHandler(G,this);this.objects.clear();this.fire(!0,!0)},fire:function(g,m){if(!this.locked&&
(this.valueChanged_=this.valueChanged_||!!g,this.stateChanged_=this.stateChanged_||!!m,!this.timer_&&(this.valueChanged_||this.stateChanged_)))this.timer_=b.timer.setImmediate(this.update.bind(this))},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},update:function(){var g=this.valueChanged_,m=this.stateChanged_;this.stateChanged_=this.valueChanged_=!1;this.timer_=b.timer.clearImmediate(this.timer_);if(!y.globalDestroy&&(g&&this.set(this.calculateValue()),m))if(g=this.objects.length){for(var m=
-2,e,d=0;d<g;d++){var k=this.objects[d],p=this.statePriority.indexOf(String(k.state));p>m&&(e=k,m=p)}e&&this.setState(e.state,e.state.data)}else this.setState(q.UNDEFINED)},destroy:function(){this.lock();this.clear();this.timer_&&b.timer.clearImmediate(this.timer_);N.prototype.destroy.call(this)}});t=g.subclass({className:t+".Expression",init:function(g,m){N.prototype.init.call(this);g=b.array(arguments);m=g.pop();"function"!=typeof m&&(m=b.fn.$undef);1==g.length&&g[0].addLink(this,function(b){this.set(m.call(this,
b))});if(1<g.length){var e=new I({objects:g,calculateOnInit:!0,calculateValue:function(){return m.apply(this,g.map(function(b){return b.value}))}});e.addLink(this,this.set);this.addHandler({destroy:function(){y.globalDestroy||e.destroy()}})}}});y.add(function(){for(var b in C)C[b].destroy();C=null});H.exports={BindValue:N,Property:g,ObjectSet:I,Expression:t};H.exports.DataObjectSet=I}],["basis.data.index",function(g,H,b,t,J,A,P){function z(a,b){if(!a.length)return 0;var c,d,e=0,k=a.length-1;do if(c=
e+k>>1,d=a[c]||0,b<d)k=c-1;else if(b>d)e=c+1;else return b==d?c:0;while(e<=k);return c+(d<b)}function y(){}function v(a,b,c){var d=a.indexCache_;a.lock();if(b)for(var e=0,k;k=b[e++];){var h=a.normalize(a.valueGetter(k));d[k.basisObjectId]=h;a.add_(h)}if(c)for(e=0;k=c[e++];)b=k.basisObjectId,a.remove_(d[b]),delete d[b];a.unlock()}function p(a,b){if(!1==b instanceof y)throw 44;var c=a.basisObjectId,e=Q[c];e||(e=Q[c]={},a.addHandler(B),B.itemsChanged.call(a,a,{inserted:a.getItems()}));var c=b.indexId,
g=e[c];if(!g){b=d[c];if(!b)throw 45;g=new b.indexClass;g.addHandler(k,a);e[c]=g;v(g,a.getItems())}return g}function F(a,b){var c=Q[a.basisObjectId];if(c&&c[b.indexId]){delete c[b.indexId];b.removeHandler(k,a);for(var d in c)return;a.removeHandler(B);delete Q[a.basisObjectId]}}function q(){return"calc-index-preset-"+(M++).lead(8)}g=this.path;var C=b.Class;t=b.data;var x=t.KeyObjectMap,N=t.AbstractDataset,G=b.data.value.BindValue,I=b.data.dataset.MapFilter,r=C(G,{className:g+".Index",autoDestroy:!0,
indexCache_:null,valueGetter:b.fn.$null,updateEvents:{},value:0,init:function(){this.indexCache_={};G.prototype.init.call(this)},add_:function(a){},remove_:function(a){},update_:function(a,b){},normalize:function(a){return Number(a)||0},destroy:function(){G.prototype.destroy.call(this);this.indexCache_=null}});t=C(r,{className:g+".Sum",add_:function(a){this.value+=a},remove_:function(a){this.value-=a},update_:function(a,b){this.set(this.value-b+a)}});J=C(r,{className:g+".Count",valueGetter:b.fn.$true,
add_:function(a){this.value+=a},remove_:function(a){this.value-=a},normalize:function(a){return!!a},update_:function(a,b){this.set(this.value-!!b+!!a)}});A=C(r,{className:g+".Avg",sum_:0,count_:0,add_:function(a){this.sum_+=a;this.count_+=1;this.value=this.sum_/this.count_},remove_:function(a){this.sum_-=a;this.value=(this.count_-=1)?this.sum_/this.count_:0},update_:function(a,b){this.sum_+=a-b;this.set(this.sum_/this.count_)}});P=C(r,{className:g+".VectorIndex",itemGetter:b.fn.$null,vector_:null,
value:void 0,init:function(){this.vector_=[];r.prototype.init.call(this)},add_:function(a){null!==a&&(this.vector_.splice(z(this.vector_,a),0,a),this.value=this.vectorGetter(this.vector_))},remove_:function(a){null!==a&&(this.vector_.splice(z(this.vector_,a),1),this.value=this.vectorGetter(this.vector_))},update_:function(a,b){null!==b&&this.vector_.splice(z(this.vector_,b),1);null!==a&&this.vector_.splice(z(this.vector_,a),0,a);this.set(this.vectorGetter(this.vector_))},normalize:function(a){return"string"==
typeof a||"number"==typeof a?a:null},destroy:function(){r.prototype.destroy.call(this);this.vector_=null}});var m=C(P,{className:g+".Min",vectorGetter:function(a){return a[0]}}),e=C(P,{className:g+".Max",vectorGetter:function(a){return a[a.length-1]}}),d={},k={destroy:function(a){F(this,a)}},R=function(a,c){return function(e,k,g){var l;e instanceof N&&(l=e,e=k,k=g);e=e||c;if(!C.isClass(a)||!a.isSubclassOf(r))throw 42;e=b.getter(e);k=k||"update";if("string"!=typeof k)throw 43;k=k.qw().sort();g=[a.basisClassId_,
e.basisGetterId_,k].join("_");var h=d[g];if(h)e=h.owner;else{for(var f={},h=0;h<k.length;h++)f[k[h]]=!0;h=new y;d[g]={owner:h,indexClass:a.subclass({indexId:g,updateEvents:f,valueGetter:e})};h.indexId=g;e=h}return l?p(l,e):e}},D=R(J,b.fn.$true),E=R(t),L=R(A),O=R(m),c=R(e),l={"*":function(a){var b,c,d=a.type,e=a.sender,k=e.basisObjectId,h=Q[this.basisObjectId],f;for(f in h)c=h[f],c.updateEvents[d]&&(a=c.indexCache_[k],b=c.normalize(c.valueGetter(e)),b!==a&&(c.update_(b,a),c.indexCache_[k]=b))}},B=
{itemsChanged:function(a,b){var c;if(c=b.inserted)for(var d=c.length;0<d--;)c[d].addHandler(l,this);if(c=b.deleted)for(d=c.length;0<d--;)c[d].removeHandler(l,this);c=Q[this.basisObjectId];for(var e in c)v(c[e],b.inserted,b.deleted)},destroy:function(){var a=Q[this.basisObjectId],b;for(b in a)F(this,a[b])}},Q={};N.extend({getIndex:function(a){return p(this,a)},deleteIndex:function(a){F(this,a)}});var K=C(null,{extendConstructor_:!0,indexes:{},calc:b.fn.$null}),M=1;g=C(I,{className:g+".IndexMap",calcs:null,
indexes:null,indexes_:null,timer_:void 0,indexUpdated:null,memberSourceMap:null,keyMap:null,map:function(a){return this.keyMap.get(a,!0)},addMemberRef:function(a,b){this.memberSourceMap[a.basisObjectId]=b.basisObjectId;this.listen.member&&a.addHandler(this.listen.member,this);this.sourceMap_[b.basisObjectId].updated=!0;0<a.subscriberCount&&this.calcMember(a)},removeMemberRef:function(a,b){delete this.memberSourceMap[a.basisObjectId];this.listen.member&&a.removeHandler(this.listen.member,this)},emit_sourceChanged:function(a){I.prototype.emit_sourceChanged.call(this,
a);for(var b in this.indexes_){var c=this.indexes_[b];a&&(this.removeIndex(b),F(a,this.indexes[b]));this.source&&this.addIndex(b,p(this.source,c))}},listen:{index:{change:function(a,b){var c=this.indexMap;c.indexValues[this.key]=b;c.indexUpdated=!0;c.recalcRequest()}},member:{subscribersChanged:function(a,b){0<a.subscriberCount&&this.calcMember(a)}}},ruleEvents:b.data.dataset.createRuleEvents(function(a,b){I.prototype.ruleEvents.update.call(this,a,b);this.sourceMap_[a.basisObjectId].updated=!0;this.recalcRequest()},
"update"),init:function(){this.recalc=this.recalc.bind(this);this.indexUpdated=!1;this.indexesBind_={};this.memberSourceMap={};var a=this.indexes;this.indexes={};this.indexes_={};this.indexValues={};var c=this.calcs;this.calcs={};if(!this.keyMap||!1==this.keyMap instanceof x)this.keyMap=new x(b.object.complete({create:function(a,b){return new this.itemClass(b)}},this.keyMap));I.prototype.init.call(this);b.object.iterate(a,this.addIndex,this);b.object.iterate(c,this.addCalc,this)},addIndex:function(a,
b){if(!this.indexes[a]){if(b instanceof y){if(this.indexes_[a])return;this.indexes_[a]=b;b=this.source?p(this.source,b):null}if(b instanceof r){this.indexValues[a]=b.value;this.indexes[a]=b;this.indexesBind_[a]={key:a,indexMap:this};var c=this.listen.index;c&&(b.addHandler(c,this.indexesBind_[a]),c.change&&c.change.call(this.indexesBind_[a],b,b.value))}}},removeIndex:function(a){if(this.indexes_[a]||this.indexes[a])this.indexes[a]&&this.listen.index&&this.indexes[a].removeHandler(this.listen.index,
this.indexesBind_[a]),delete this.indexValues[a],delete this.indexesBind_[a],delete this.indexes[a],delete this.indexes_[a]},addCalc:function(a,b){if(b instanceof K){this.calcs[a]=b.calc;for(var c in b.indexes)this.addIndex(c,b.indexes[c])}else this.calcs[a]=b;this.recalcRequest()},removeCalc:function(a){var b=this.calcs[a];if(b&&b.preset instanceof K){var b=b.preset.indexes,c;for(c in b)this.removeIndex(c,b[c])}delete this.calcs[a]},lock:function(){for(var a in this.indexes)this.indexes[a].lock()},
unlock:function(){for(var a in this.indexes)this.indexes[a].unlock()},recalcRequest:function(){this.timer_||(this.timer_=b.timer.setImmediate(this.recalc))},recalc:function(){for(var a in this.items_)this.calcMember(this.items_[a]);this.indexUpdated=!1;this.timer_=b.timer.clearImmediate(this.timer_)},calcMember:function(a){var b=this.sourceMap_[this.memberSourceMap[a.basisObjectId]];if(a.subscriberCount&&(b.updated||this.indexUpdated)){b.updated=!1;var c={},d,e,k,h;for(h in this.calcs)if(d=this.calcs[h](b.sourceObject.data,
this.indexValues,b.sourceObject),e=a.data[h],a.data[h]!==d&&("number"!=typeof d||"number"!=typeof e||!isNaN(d)||!isNaN(e)))c[h]=d,k=!0;k&&a.update(c)}},getMember:function(a){return this.keyMap.get(a,!0)},destroy:function(){this.timer_=clearTimeout(this.timer_);this.indexesBind_=this.memberSourceMap=this.indexUpdated=this.calcs=null;this.keyMap.destroy();this.keyMap=null;for(var a in this.indexes)this.removeIndex(a);I.prototype.destroy.call(this)}});H.exports={IndexConstructor:y,createIndexConstructor:R,
getDatasetIndex:p,removeDatasetIndex:F,Index:r,Count:J,Sum:t,Avg:A,VectorIndex:P,Min:m,Max:e,count:D,sum:E,avg:L,max:c,min:O,CalcIndexPreset:K,percentOfRange:function(a,d){var e="min_"+q(),k="max_"+q(),g={};a=b.getter(a);g[e]=O(a,d);g[k]=c(a,d);var l=function(b,c,d){return(a(d)-c[e])/(c[k]-c[e])};return l.preset=new K({indexes:g,calc:l})},percentOfMax:function(a,d){var e="max_"+q(),k={};a=b.getter(a);k[e]=c(a,d);var g=function(b,c,d){return a(d)/c[e]};return g.preset=new K({indexes:k,calc:g})},percentOfSum:function(a,
c){var d="sum_"+q(),e={};a=b.getter(a);e[d]=E(a,c);var k=function(b,c,f){return a(f)/c[d]};return k.preset=new K({indexes:e,calc:k})},IndexMap:g}}],["basis.net.action",function(g,H,b,t,J,A,P){var z=b.data.STATE.UNDEFINED,y=b.data.STATE.READY,v=b.data.STATE.PROCESSING,p=b.data.STATE.ERROR,F=function(){},q={start:function(b,g){var p=g.requestData.origin;this.start.call(g.requestData.origin);p.state!=v&&p.setState(v)},success:function(b,g,p){b=g.requestData.origin;this.success.call(b,p);b.state==v&&
b.setState(y)},failure:function(b,g,q){b=g.requestData.origin;this.failure.call(b,q);b.state==v&&b.setState(p,q)},abort:function(b,g){var p=g.requestData.origin;this.abort.call(p);p.state==v&&p.setState(z)},complete:function(b,g){this.complete.call(g.requestData.origin)}},C={start:F,success:F,failure:F,abort:F,complete:F};H.exports={create:function(g){g=b.object.extend({prepare:F,request:F},g);var p=b.object.splice(g,["prepare","request"]),t=b.object.merge(C,b.object.splice(g,["start","success","failure",
"abort","complete"])),y=b.fn.lazyInit(function(){var p=g.transport?g.transport:g.service?g.service.createTransport(g):g.createTransport?g.createTransport(g):new b.net.Transport(g);p.addHandler(q,t);return p});return function(){this.state!=v&&(p.prepare.apply(this,arguments),this.request=y().request(b.object.complete({origin:this},p.request.apply(this,arguments))))}}}}],["basis.net.service",function(g,H,b,t,J,A,P){g=b.event.create;var z=b.net.action.create,y=b.event.Emitter,v={start:function(b,g){this.inprogressTransports.add(g.transport)},
complete:function(b,g){this.inprogressTransports.remove(g.transport)}};g=y.subclass({className:this.path+".Service",inprogressTransports:null,transportClass:b.net.AjaxTransport,emit_sessionOpen:g("sessionOpen"),emit_sessionClose:g("sessionClose"),emit_sessionFreeze:g("sessionFreeze"),emit_sessionUnfreeze:g("sessionUnfreeze"),isSecure:!1,prepare:b.fn.$true,signature:b.fn.$undef,isSessionExpiredError:b.fn.$false,init:function(){y.prototype.init.call(this);this.inprogressTransports=[];var b=this.transportClass;
this.transportClass=b.subclass({service:this,needSignature:this.isSecure,emit_failure:function(g,q){b.prototype.emit_failure.call(this,g,q);this.needSignature&&this.service.isSessionExpiredError(g)&&(this.service.freeze(),this.service.stoppedTransports.push(this),this.stop())},request:function(g){if(this.service.prepare(this,g)&&(!this.needSignature||this.service.sign(this)))return b.prototype.request.call(this,g)}});this.addHandler(v)},sign:function(b){if(this.sessionKey)return this.signature(b,
this.sessionData),!0},openSession:function(b,g){this.sessionKey=b;this.sessionData=g;this.unfreeze();this.emit_sessionOpen()},closeSession:function(){this.freeze();this.emit_sessionClose()},freeze:function(){if(this.sessionKey){this.sessionData=this.sessionKey=null;this.stoppedTransports=this.inprogressTransports.filter(function(b){return b.needSignature});for(var b=0,g;g=this.inprogressTransports[b];b++)g.stop();this.emit_sessionFreeze()}},unfreeze:function(){if(this.stoppedTransports)for(var b=
0,g;g=this.stoppedTransports[b];b++)g.resume();this.emit_sessionUnfreeze()},createTransport:function(b){return new this.transportClass(b)},createAction:function(g){return z(b.object.complete({service:this},g))},destroy:function(){this.sessionData=this.sessionKey=this.stoppedTransports=this.inprogressTransports=null;y.prototype.destroy.call(this)}});H.exports={Service:g}}],["app.service",function(g,H,b,t,J,A,P){function z(b){"updateProviderList"===b.data&&app.updateProviderList()}g=new b.net.service.Service({transportClass:b.net.Transport.subclass({request:function(){b.net.Transport.prototype.request.apply(this,
arguments)}})});(app.updateProviderList=function(){b.net.request({url:"/api/user"},function(b){app.type.Provider.all.forEach(function(g){g.set("enabled",b.user.prodivers.has(g.data.id))});if(app.onProvidersInit)app.onProvidersInit()})})();t.addEventListener?t.addEventListener("message",z,!0):t.attachEvent("onmessage",z);H.exports={"default":g}}],["app.type",function(g,H,b,t,J,A,P){H.exports={Event:b.resource("5.js").fetch(),Entry:b.resource("6.js").fetch(),Provider:b.resource("7.js").fetch()}}],["basis.layout",
function(g,H,b,t,J,A,P){function z(b,d){if(E)try{return parseFloat(F.getComputedStyle(b,null)[d])}catch(e){}return 0}function y(b,d){if(E)return z(b,"height");N.setStyle(d,{borderTop:b.currentStyle.borderTopWidth+" solid red",borderBottom:b.currentStyle.borderBottomWidth+" solid red",paddingTop:b.currentStyle.paddingTop,paddingBottom:b.currentStyle.paddingBottom,fontSize:0.01,height:0,overflow:"hidden"});return b.offsetHeight-d.offsetHeight}function v(b,d){if(D)b.onresize=d;else{var e=q.createElement({description:"iframe",
css:{position:"absolute",width:"100%",height:"100%",border:"none",left:0,zIndex:-1,top:"-2000px"}});q.insert(b,e);e.onload=function(){(e.contentWindow.onresize=d)()}}}g=this.path;var p=t.document,F=p.defaultView;t=b.Class;var q=b.dom,C=b.ua,x=b.object.extend,N=b.cssom,G=b.cssom.classList,I=b.ui.Node,r=C.test("IE"),m=C.test("IE7+"),e=C.test("IE8-"),d=!1;J=q.createElement("");A=["","-webkit-"];for(P=0;P<A.length;P++)try{if(!("-webkit-"==A[P]&&b.ua.is("opera"))){var k=A[P]+"box";J.style.display=k;if(J.style.display==
k){d=A[P];break}}}catch(R){}var D="undefined"!=typeof J.onresize,E=F&&F.getComputedStyle,L={top:NaN,left:NaN,bottom:NaN,right:NaN,width:NaN,height:NaN,defined:!1},O=t(null,{className:g+".Box",init:function(b,d,e){this.reset();this.element=q.get(b);this.offsetElement=e;d||this.recalc(this.offsetElement)},reset:function(){x(this,L)},set:function(b,d){if(this.defined){switch(b.toLowerCase()){case "left":this.left=d;this.right=this.left+this.width;break;case "right":this.right=d;this.left=this.right-
this.width;break;case "width":this.width=d;this.right=this.left+this.width;break;case "top":this.top=d;this.bottom=this.top+this.height;break;case "bottom":this.bottom=d;this.top=this.bottom-this.height;break;case "height":this.height=d,this.bottom=this.top+this.height}(0>=this.width||0>=this.height)&&this.reset()}return this},recalc:function(b){this.reset();var d=this.element;if(d){var k=d,g=p.documentElement;if(d.getBoundingClientRect)k=d.getBoundingClientRect(),this.top=k.top,this.left=k.left,
r&&(m?e&&(this.top+=g.scrollTop-g.clientTop,this.left+=g.scrollLeft-g.clientLeft):d!=p.body&&(this.top-=p.body.clientTop-p.body.scrollTop,this.left-=p.body.clientLeft-p.body.scrollLeft)),b&&(b!==p.body?(b=new O(b),this.top-=b.top,this.left-=b.left,b.destroy()):(this.top+=b.scrollTop+g.scrollTop,this.left+=b.scrollLeft+g.scrollLeft));else if(p.getBoxObjectFor){var q=p.getBoxObjectFor(g),k=p.getBoxObjectFor(d);this.top=k.screenY-q.screenY;this.left=k.screenX-q.screenX;if(C.test("FF1.5-")){if(k=d.offsetParent)this.top-=
k.scrollTop,this.left-=k.scrollLeft;k!=p.body&&(this.top+=g.scrollTop,this.left+=g.scrollLeft)}if(C.test("FF2+")){if(this.top&&(k=g.scrollTop,2<k)){for(var q=0,D=Math.floor(Math.log(k)/Math.LN2);0<=D;D-=3)q+=1<<D;k>q&&(this.top-=1)}this.left&&(this.left-=1<g.scrollLeft)}b&&(b=new O(b),this.top-=b.top,this.left-=b.left,b.destroy())}else if(d!=b){this.top=d.offsetTop;this.left=d.offsetLeft;this.top-=p.body.clientTop-p.body.scrollTop;for(this.left-=p.body.clientLeft-p.body.scrollLeft;(k=k.offsetParent)&&
k!=b;)this.top+=k.offsetTop+k.clientTop-k.scrollTop,this.left+=k.offsetLeft+k.clientLeft-k.scrollLeft}else this.top=this.left=0;this.width=d.offsetWidth;this.height=d.offsetHeight;this.bottom=this.top+this.height;this.right=this.left+this.width;this.defined=!0}return this.defined},intersect:function(b){if(!this.defined)return!1;!1==b instanceof O&&(b=new O(b));return b.defined&&b.right>this.left&&b.left<this.right&&b.bottom>this.top&&b.top<this.bottom},destroy:function(){this.offsetElement=this.element=
null}}),k=t(O,{className:g+".Intersection",init:function(b,d,e){this.boxA=b instanceof O?b:new O(b,!0);this.boxB=d instanceof O?d:new O(d,!0);e||this.recalc()},recalc:function(){this.reset();if(!this.boxA.recalc()||!this.boxB.recalc())return!1;this.boxA.intersect(this.boxB)&&(this.top=Math.max(this.boxA.top,this.boxB.top),this.left=Math.max(this.boxA.left,this.boxB.left),this.bottom=Math.min(this.boxA.bottom,this.boxB.bottom),this.right=Math.min(this.boxA.right,this.boxB.right),this.width=this.right-
this.left,this.height=this.bottom-this.top,0>=this.width||0>=this.height?this.reset():this.defined=!0);return this.defined},destroy:function(){O.prototype.destroy.call(this);this.boxB=this.boxA=null}});J=t(O,{className:g+".Viewport",recalc:function(){this.reset();var b=this.element;if(b){var d=b;this.width=b.clientWidth;this.height=b.clientHeight;if(b.getBoundingClientRect){var e=b.getBoundingClientRect();this.top=e.top;for(this.left=e.left;d=d.offsetParent;)this.top-=d.scrollTop,this.left-=d.scrollLeft}else if(p.getBoxObjectFor){e=
p.getBoxObjectFor(b);this.top=e.y;for(this.left=e.x;d=d.offsetParent;)this.top-=d.scrollTop,this.left-=d.scrollLeft}else e=new O(b),this.top=e.top+b.clientTop,this.left=e.left+b.clientLeft;this.bottom=this.top+this.height;this.right=this.left+this.width;this.defined=!0}return this.defined}});A=b.template.define(g,{Panel:b.resource("o.tmpl"),Stack:b.resource("p.tmpl")});b=t(I,{className:g+".VerticalPanel",template:A.Panel,flex:0,init:function(){I.prototype.init.call(this);this.flex?!1!==d&&N.setStyleProperty(this.element,
d+"box-flex",this.flex):!1===d&&v(this.element,function(){this.parentNode&&this.parentNode.realign()}.bind(this))}});g=t(I,{className:g+".VerticalPanelStack",template:A.Stack,childClass:b,init:function(){this.cssRule=N.uniqueRule();this.cssRule.setProperty("overflow","auto");this.ruleClassName=this.cssRule.token;I.prototype.init.call(this);!1===d&&(this.realign(),v(this.childNodesElement,this.realign.bind(this)))},insertBefore:function(b,d){if(b=I.prototype.insertBefore.call(this,b,d))return b.flex&&
G(b.element).add(this.ruleClassName),this.realign(),b},removeChild:function(b){if(I.prototype.removeChild.call(this,b))return b.flex&&G(b.element).remove(this.ruleClassName),this.realign(),b},realign:function(){if(!1===d){var b=this.element,e=this.lastChild.element,k=this.tmpl.ruller,g=(new O(e,!1,b)).bottom-z(b,"paddingTop")-z(b,"borderTopWidth")||0,b=y(b,k);if(E)g+=z(e,"marginBottom");else{var m=k.offsetHeight;k.style.height=e.currentStyle.marginBottom;g+=k.offsetHeight-m}if(g=b-g){for(b=e=0;m=
this.childNodes[b];b++)m.flex&&(e++,g+=y(m.element,k));e&&this.cssRule.setProperty("height",Math.max(0,g/e)+"px")}}},destroy:function(){I.prototype.destroy.call(this);this.cssRule.destroy();this.cssRule=null}});H.exports={Box:O,Intersection:k,Viewport:J,VerticalPanel:b,VerticalPanelStack:g,addBlockResizeHandler:v}}],["basis.ui.popup",function(g,H,b,t,J,A,P){function z(b,e){return I["string"==typeof b&&b.toUpperCase()]||e}t=this.path;J=b.Class;var y=b.dom,v=b.dom.event,p=b.cssom,F=b.layout,q=b.array.from;
A=b.event.create;var C=b.ui.Node;g=b.template.define(t,{Popup:b.resource("q.tmpl"),Balloon:b.resource("r.tmpl"),popupManager:b.resource("s.tmpl")});var x={VERTICAL:"V",HORIZONTAL:"H"},N={L:"LEFT",R:"RIGHT",T:"TOP",B:"BOTTOM",C:"CENTER"},G={LEFT:"RIGHT",RIGHT:"LEFT",TOP:"BOTTOM",BOTTOM:"TOP",CENTER:"CENTER"},I=function(){for(var b=["LEFT","CENTER","RIGHT"],e=["TOP","CENTER","BOTTOM"],d={},k={},g=0;3>g;g++)for(var p=0;3>p;p++)k[b[g]+" "+e[p]]=b[g]+" "+e[p],k[e[p]+" "+b[g]]=b[g]+" "+e[p];for(var q in k)for(var r in k)d[q+
" "+r]=k[q]+" "+k[r];return d}();A=J(C,{className:t+".Popup",template:g.Popup,binding:{visible:{events:"show hide",getter:function(b){return b.visible?"visible":"hidden"}},orientation:{events:"layoutChanged",getter:function(b){return(b.orientation+"-"+b.dir.qw().slice(2,4).join("-")).toLowerCase()}}},action:{hide:function(){this.hide()}},emit_beforeShow:A("beforeShow"),emit_show:A("show"),emit_hide:A("hide"),emit_realign:A("realign"),emit_layoutChanged:A("layoutChanged","oldOrientation","oldDir"),
visible:!1,autorotate:!1,dir:"",defaultDir:"RIGHT BOTTOM RIGHT TOP",orientation:x.VERTICAL,hideOnAnyClick:!0,hideOnKey:!1,hideOnScroll:!0,ignoreClickFor:null,init:function(){C.prototype.init.call(this);this.ignoreClickFor=q(this.ignoreClickFor);this.dir?this.defaultDir=this.dir=z(this.dir,"RIGHT BOTTOM RIGHT TOP"):this.dir=this.defaultDir=z(this.defaultDir,"RIGHT BOTTOM RIGHT TOP");this.setLayout(this.defaultDir,this.orientation)},templateSync:function(b){C.prototype.templateSync.call(this,b);this.element&&
this.realign()},setLayout:function(b,e,d){var k=this.dir,g=this.orientation;this.dir=z(b,this.dir);"string"==typeof e&&(this.orientation=e);if(k!=this.dir||g!=this.orientation)this.emit_layoutChanged(g,k),d||this.realign()},flip:function(b){var e=this.dir.qw();b=b==x.VERTICAL;e[0+b]=G[e[0+b]];e[2+b]=G[e[2+b]];this.setLayout(e.join(" "))},rotate:function(b){var e=this.dir.qw(),d=[];b=(b%4+4)%4;if(!b)return e;var k=e[0].charAt(0),g=e[1].charAt(0),p="LTRTRBLBLCCTRCCBCCCCCCCC".indexOf(k+g)>>1,k=(p&252)+
((p&3)+b&3)<<1;d.push(N["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(k)],N["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(k+1)]);k=e[2].charAt(0);g=e[3].charAt(0);p="LTRTRBLBLCCTRCCBCCCCCCCC".indexOf(k+g)>>1;b="C"!=k&&"C"!=g&&e[0]==e[2]!=(e[1]==e[3])?-b+4:b;k=(p&252)+((p&3)+b&3)<<1;d.push(N["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(k)],N["LTRTRBLBLCCTRCCBCCCCCCCC".charAt(k+1)]);return d},isFitToViewport:function(b){if(this.visible&&this.relElement){var e=new F.Box(this.relElement,!1,this.element.offsetParent),d=new F.Viewport(this.element.offsetParent),
k=this.element.offsetWidth,g=this.element.offsetHeight;b=z(b,this.dir).qw();var p="CENTER"==b[0]?e.left+(e.width>>1):e[b[0].toLowerCase()],e="CENTER"==b[1]?e.top+(e.height>>1):e[b[1].toLowerCase()];return("LEFT"!=b[2])*(p<k>>("CENTER"==b[2]))||("RIGHT"!=b[2])*(d.width-p<k>>("CENTER"==b[2]))||("TOP"!=b[3])*(e<g>>("CENTER"==b[3]))||("BOTTOM"!=b[3])*(d.height-e<g>>("CENTER"==b[3]))?!1:{x:p,y:e}}},setZIndex:function(b){this.zIndex=isNaN(b)?"auto":b;p.setStyle(this.element,{"z-index":b})},realign:function(){this.setZIndex(this.zIndex);
if(this.visible&&this.relElement){for(var b=this.dir.qw(),e,d=0,k=b,g=b[2],q=b[3],r="number"==typeof this.autorotate||!this.autorotate.length?3:this.autorotate.length;this.autorotate&&d<=r;){if(e=this.isFitToViewport(k.join(" "))){g=k[2];q=k[3];this.setLayout(k.join(" "),null,!0);break}if(d==r)break;if(Array.isArray(this.autorotate))var t=this.autorotate[d++],k="string"==typeof t?z(t,k.join(" ")).split(" "):this.rotate(t);else k=this.rotate(++d*this.autorotate)}e||(e=new F.Box(this.relElement,!1,
this.element.offsetParent),e={x:"CENTER"==b[0]?e.left+(e.width>>1):e[b[0].toLowerCase()],y:"CENTER"==b[1]?e.top+(e.height>>1):e[b[1].toLowerCase()]});b=new F.Box(this.element.offsetParent);d={left:"auto",right:"auto",top:"auto",bottom:"auto"};switch(g){case "LEFT":d.left=e.x+"px";break;case "CENTER":d.left=Math.round(e.x-this.element.offsetWidth/2)+"px";break;case "RIGHT":d.right=b.width-e.x+"px"}switch(q){case "TOP":d.top=e.y+"px";break;case "CENTER":d.top=Math.round(e.y-this.element.offsetHeight/
2)+"px";break;case "BOTTOM":d.bottom=b.height-e.y+"px"}p.setStyle(this.element,d);this.emit_realign()}},show:function(b,e,d){this.relElement=y.get(b)||this.relElement;this.setLayout(z(e,this.defaultDir),d);this.visible?this.realign():this.relElement&&(p.visibility(this.element,!1),r.appendChild(this),this.emit_beforeShow(),this.visible=!0,this.realign(),p.visibility(this.element,!0),this.emit_show())},hide:function(){this.visible&&(this.visible=!1,this.parentNode&&r.removeChild(this),this.emit_hide())},
hideAll:function(){r.clear()},destroy:function(){this.hide();C.prototype.destroy.call(this)}});t=J(A,{className:t+".Balloon",template:g.Balloon});var r=new C({template:g.popupManager,selection:!0,emit_childNodesModified:function(b){if(b.deleted)for(var e=b.deleted.length-1,d;d=b.deleted[e];e--)d.hide();b.inserted&&(!b.deleted&&this.childNodes.length==b.inserted.length)&&(v.addGlobalHandler("click",this.hideByClick,this),v.addGlobalHandler("keydown",this.hideByKey,this),v.addGlobalHandler("scroll",
this.hideByScroll,this),v.addHandler(window,"resize",this.realignAll,this));this.lastChild?this.lastChild.select():(v.removeGlobalHandler("click",this.hideByClick,this),v.removeGlobalHandler("keydown",this.hideByKey,this),v.removeGlobalHandler("scroll",this.hideByScroll,this),v.removeHandler(window,"resize",this.realignAll,this));C.prototype.emit_childNodesModified.call(this,b)},insertBefore:function(g,e){C.prototype.insertBefore.call(this,g,e)&&g.setZIndex(b.ui.window?b.ui.window.getWindowTopZIndex():
2001)},removeChild:function(b){b&&(b.hideOnAnyClick&&b.nextSibling&&this.removeChild(b.nextSibling),C.prototype.removeChild.call(this,b))},realignAll:function(){for(var b=this.firstChild;b;b=b.nextSibling)b.realign()},clear:function(){this.firstChild&&this.removeChild(this.firstChild)},hideByClick:function(b){if(this.firstChild){b=y.axis(b.sender,y.AXIS_ANCESTOR_OR_SELF);for(var e=this.lastChild;e;e=e.previousSibling)if(b.has(e.element)||b.some(Array.prototype.has,e.ignoreClickFor)){for(;e=e.nextSibling;)if(e.hideOnAnyClick){this.removeChild(e);
break}return}this.removeChild(this.getChild(!0,"hideOnAnyClick"))}},hideByKey:function(b){var e=this.lastChild;if(e&&e.hideOnKey){var d=!1;"function"==typeof e.hideOnKey?d=e.hideOnKey(b.key):Array.isArray(e.hideOnKey)&&(d=e.hideOnKey.has(b.key));d&&e.hide()}},hideByScroll:function(b){b=b.sender;if(!y.parentOf(b,this.element))for(var e=this.lastChild;e;){var d=e.previousSibling;e.hideOnScroll&&(e.relElement&&e.offsetParent!==b&&y.parentOf(b,e.relElement))&&e.hide();e=d}}});b.ready(function(){y.insert(document.body,
r.element,y.INSERT_BEGIN);r.realignAll()});H.exports={ORIENTATION:x,DIR:{LEFT:"LEFT",RIGHT:"RIGHT",TOP:"TOP",BOTTOM:"BOTTOM",CENTER:"CENTER"},Popup:A,Balloon:t}}],["basis.ui.calendar",function(g,H,b,t,J,A,P){function z(b){return{hour:b.getHours(),day:b.getDate()-1,month:b.getMonth(),year:b.getFullYear()}}function y(b,e){var g={},m=r[b];if(m){var p=e.getFullYear(),q=e.getMonth(),t=e.getDate(),p=p-p%m[1],q=m[2]?q-q%m[2]:0,t=m[3]?t:1;g.periodStart=new Date(p,q,t);g.periodEnd=new Date(new Date(p+m[4],
q+m[5],t+m[6])-1)}else g.periodStart=new Date(e),g.periodEnd=new Date(e);return g}function v(){for(var b=y(this.nodePeriodName,(new Date(this.periodStart)).add(this.nodePeriodUnit,-this.nodePeriodUnitCount*(this.getInitOffset(this.periodStart)||0))),e=[],g=0;g<this.nodeCount;g++)e.push(b),b=y(this.nodePeriodName,(new Date(b.periodStart)).add(this.nodePeriodUnit,this.nodePeriodUnitCount));return e}var p=this.path;g=b.Class;var F=b.dom;t=b.event.create;var q=b.l10n.token,C=b.data.value.Property,x=b.ui.Node,
N=b.date.monthNumToAbbr;J=b.template.define(p,{Calendar:b.resource("t.tmpl"),Section:b.resource("u.tmpl"),SectionMonth:b.resource("v.tmpl"),Node:b.resource("w.tmpl")});b.l10n.createDictionary(p,"l10n",{quarter:"Quarter",today:"Today",selected:"Selected"});b.l10n.createDictionary(p+".month","l10n",{jan:"January",feb:"February",mar:"March",apr:"April",may:"May",jun:"June",jul:"July",aug:"August",sep:"September",oct:"October",nov:"November",dec:"December"});b.l10n.createDictionary(p+".monthShort","l10n",
{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"});b.l10n.createDictionary(p+".day","l10n",{mon:"Monday",tue:"Tuesday",wed:"Wednesday",thr:"Thursday",fri:"Friday",sat:"Saturday",sun:"Sunday"});b.l10n.createDictionary(p+".day2","l10n",{mon:"Mo",tue:"Tu",wed:"We",thr:"Th",fri:"Fr",sat:"Sa",sun:"Su"});b.l10n.createDictionary(p+".day3","l10n",{mon:"Mon",tue:"Tue",wed:"Wed",thr:"Thr",fri:"Fri",sat:"Sat",sun:"Sun"});var G={};(function(){for(var b=
32,e=2147483647;--b;)G[b]=e,e>>=1})();var I={century:function(b){return b.periodStart.getFullYear()+" - "+b.periodEnd.getFullYear()},decade:function(b){return b.periodStart.getFullYear()+" - "+b.periodEnd.getFullYear()},year:function(b){return b.periodStart.getFullYear()},quarter:function(b){return q(p,"quarter")},month:function(b){return q(p,"monthShort",N[b.periodStart.getMonth()])},day:function(b){return b.periodStart.getDate()}},r={century:["year",100,0,0,100,0,0],decade:["year",10,0,0,10,0,0],
year:["year",1,0,0,1,0,0],quarter:["month",1,3,0,0,3,0],month:["month",1,1,0,0,1,0],day:["day",1,1,1,0,0,1]},m=g(x,{className:p+".Calendar.Node",childClass:null,periodStart:null,periodEnd:null,emit_periodChanged:t("periodChanged"),emit_select:function(){x.prototype.emit_select.call(this);F.focus(this.element)},template:J.Node,binding:{nodePeriodName:"nodePeriodName",title:{events:"periodChanged",getter:function(b){return I[b.nodePeriodName](b)}},before:{events:"periodChanged",getter:function(b){return b.parentNode&&
b.periodStart<b.parentNode.periodStart?"before":""}},after:{events:"periodChanged",getter:function(b){return b.parentNode&&b.periodEnd>b.parentNode.periodEnd?"after":""}}},action:{click:function(b){var e=this.parentNode&&this.parentNode.parentNode;e&&!this.isDisabled()&&e.templateAction("click",b,this)}},setPeriod:function(b,e,g){if(g||this.periodStart-b.periodStart||this.periodEnd-b.periodEnd)this.periodStart=b.periodStart,this.periodEnd=b.periodEnd,this.isPeriodEnabled(this.periodStart,this.periodEnd)?
this.enable():this.disable(),e&&(e>=this.periodStart&&e<=this.periodEnd?this.select():this.unselect()),this.emit_periodChanged()}}),e=g(x,{className:p+".CalendarSection",emit_periodChanged:t("periodChanged"),emit_selectedDateChanged:t("selectedDateChanged"),template:J.Section,binding:{sectionName:"sectionName",title:{events:"periodChanged",getter:function(b){return b.getTitle(b.periodStart)||"-"}},tabTitle:{events:"selectedDateChanged",getter:function(b){return b.getTabTitle(b.selectedDate)||"-"}}},
childClass:m,minDate:null,maxDate:null,periodStart:null,periodEnd:null,setPeriod:function(b,e){if(e||this.periodStart-b.periodStart||this.periodEnd-b.periodEnd){var g=this.periodStart,m=this.periodEnd;this.periodStart=b.periodStart;this.periodEnd=b.periodEnd;var p=v.call(this);this.minDate=p[0].periodStart;this.maxDate=p[p.length-1].periodEnd;if(this.firstChild)for(var q=0,r;r=this.childNodes[q];q++)r.setPeriod(p[q],this.selectedDate,e);this.emit_periodChanged(g,m)}},selectedDate:null,setSelectedDate:function(b){if(this.selectedDate-
b){var e=this.selectedDate;this.selectedDate=b;(b=this.getNodeByDate(this.selectedDate))?b.select():this.selectedDate?this.setViewDate(this.selectedDate):this.selection.clear();this.emit_selectedDateChanged(e)}},isPrevPeriodEnabled:!0,isNextPeriodEnabled:!0,periodName:"period",nodeCount:12,nodePeriodName:"-",nodePeriodUnit:"-",nodePeriodUnitCount:1,selection:!0,init:function(){var b=this.selectedDate||new Date;this.selectedDate=null;this.setViewDate(b);this.childNodes=v.call(this).map(function(b){return{isPeriodEnabled:this.isPeriodEnabled,
disabled:!this.isPeriodEnabled(b.periodStart,b.periodEnd),nodePeriodName:this.nodePeriodName,periodStart:b.periodStart,periodEnd:b.periodEnd}},this);x.prototype.init.call(this);this.setSelectedDate(b)},getTitle:function(){},getTabTitle:function(){},getNodeByDate:function(b){if(b&&this.periodStart<=b&&b<=this.periodEnd){a:{var e=this.childNodes;if(e.length){var g,m,p=0,q=e.length,r;do if(m=e[g=p+q>>1],b<(r=m.periodStart))q=g-1;else if(b>(m=m.periodEnd))p=g+1;else{b=b>=r&&b<=m?g:-1;break a}while(p<=
q)}b=-1}if(-1!=b)return this.childNodes[b]}return null},prevPeriod:function(){this.isPrevPeriodEnabled&&this.setPeriod(y(this.periodName,new Date(+this.periodStart-1)))},nextPeriod:function(){this.isNextPeriodEnabled&&this.setPeriod(y(this.periodName,new Date(+this.periodEnd+1)))},setViewDate:function(b){this.setPeriod(y(this.periodName,b))},rebuild:function(){this.setPeriod(y(this.periodName,this.selectedDate),!0)},getInitOffset:function(){}});e.Month=g(e,{className:p+".CalendarSection.Month",sectionName:"Month",
periodName:"month",nodeCount:42,nodePeriodName:"day",nodePeriodUnit:"day",getTabTitle:function(b){return b.getDate()},getInitOffset:function(b){return 1+((new Date(b)).set("day",1).getDay()+5)%7},template:J.SectionMonth,binding:{year:{events:"periodChanged",getter:function(b){return b.periodStart.getFullYear()}},title:{events:"periodChanged",getter:function(b){return q(p,"month",N[b.periodStart.getMonth()])}}}});e.Year=g(e,{className:p+".CalendarSection.Year",sectionName:"Year",periodName:"year",
nodePeriodName:"month",nodePeriodUnit:"month",getTabTitle:function(b){return q(p,"month",N[b.getMonth()])},getTitle:function(b){return b.getFullYear()}});e.YearDecade=g(e,{className:p+".CalendarSection.YearDecade",sectionName:"YearDecade",periodName:"decade",nodePeriodName:"year",nodePeriodUnit:"year",getInitOffset:function(){return 1},getTabTitle:function(b){return b.getFullYear()},getTitle:function(b){return b.getFullYear()+" - "+this.periodEnd.getFullYear()}});e.Century=g(e,{className:p+".CalendarSection.Century",
sectionName:"Century",periodName:"century",nodePeriodName:"decade",nodePeriodUnit:"year",nodePeriodUnitCount:10,getTabTitle:function(b){if(b)return b=b.getFullYear(),b-=b%10,b+"-"+(Number(b.toString().substr(-2))+9).lead(2)},getInitOffset:function(){return 1}});e.YearQuarters=g(e,{className:p+".CalendarSection.YearQuarter",sectionName:"YearQuarter",periodName:"year",nodeCount:4,nodePeriodName:"quarter",nodePeriodUnit:"month",nodePeriodUnitCount:3});e.Quarter=g(e,{className:p+".CalendarSection.Quarter",
sectionName:"Quarter",periodName:"quarter",nodeCount:3,nodePeriodName:"month",nodePeriodUnit:"month",binding:{title:{events:"periodChanged",getter:function(){return q(p,"quarter")}}}});g=g(x,{className:p+".Calendar",emit_change:t("change"),emit_childNodesModified:function(b){if(b.inserted)for(var e=0,g;g=b.inserted[e++];)g.setViewDate(this.date.value),this.selectedDate.addLink(g,g.setSelectedDate);if(b.deleted)for(e=0;g=b.deleted[e++];)this.selectedDate.removeLink(g,g.setSelectedDate);x.prototype.emit_childNodesModified.call(this,
b);this.selection&&(!this.selection.itemCount&&this.firstChild)&&this.firstChild.select();var m={};F.insert(this.tmpl.sectionTabs,this.childNodes.map(function(b){return m[b.basisObjectId]=b.tmpl.tabElement||document.createComment("")}));for(var p in this.tabElementMap_)m[p]||F.remove(this.tabElementMap_[p]);this.tabElementMap_=m},template:J.Calendar,binding:{today:function(){return(new Date).toFormat("%D.%M.%Y")}},action:{moveNext:function(){this.selection.pick().nextPeriod()},movePrev:function(){this.selection.pick().prevPeriod()},
selectToday:function(){this.selectedDate.set(new Date)}},templateAction:function(b,e,g){x.prototype.templateAction.call(this,b,e);g instanceof m&&(b=g.periodStart,e=this.selection.pick(),this.selectedDate.set((new Date(this.selectedDate.value)).add(e.nodePeriodUnit,this.selectedDate.value.diff(e.nodePeriodUnit,b))),this.nextSection(!1))},selection:!0,childClass:e,childFactory:function(){},tabElementMap_:{},listen:{childNode:{templateChanged:function(b){var e=b.tmpl.tabElement||document.createComment(),
g=this.tabElementMap_[b.basisObjectId];e!==g&&(this.tabElementMap_[b.basisObjectId]=e,F.replace(g,e))}}},date:null,sections:["Month","Year","YearDecade"],minDate:null,maxDate:null,map:null,periodEnableByDefault:!0,init:function(){var b=new Date;this.selectedDate=new C(new Date(this.date||b));this.date=new C(new Date(this.date||b));x.prototype.init.call(this);this.isPeriodEnabled=this.isPeriodEnabled.bind(this);this.sections&&this.setChildNodes(this.sections.map(function(b){return new e[b]({isPeriodEnabled:this.isPeriodEnabled,
selectedDate:this.selectedDate.value})},this))},setMinDate:function(b){if(this.minDate!=b){this.minDate=b;b=0;for(var e;e=this.childNodes[b];b++)e.rebuild()}},setMaxDate:function(b){if(this.maxDate!=b){this.maxDate=b;b=0;for(var e;e=this.childNodes[b];b++)e.rebuild()}},setSection:function(b){(b=this.childNodes.search("sectionName",b))&&b.select()},nextSection:function(b){var e=this.selection.pick();(e=b?e.nextSibling:e.previousSibling)?(e.select(),e.setViewDate(this.selectedDate.value)):b||this.emit_change()},
selectDate:function(b){0!=b-this.date.value&&this.date.set(b)},getNextPeriod:function(b,e){if(!this.isNextPeriodEnabled(b,e))return!1;if(this.map){var g=e?1:-1,m=e?"start":"till",p=e?"till":"start",q=(new Date(b)).add("millisecond",g),r=this.map[this.periodEnableByDefault?"disabled":"enabled"];if(r){var c=y("year",q);for(c.periodEnd.getFullYear()==q.getFullYear()&&(c[m]=q);!this.isPeriodEnabled(c.periodStart,c.periodEnd);)c=y("year",q.add("year",g));for(c[p]=y("month",c[m])[p];!this.isPeriodEnabled(c.periodStart,
c.periodEnd);)c=y("month",q.add("month",g));var l=z(c[m]),p=z(c[p]);if(r=r[p.year]&&r[p.year][p.month]){this.periodEnableByDefault&&(m=G[c.periodEnd.getMonthDayCount()],r=r&m^m);for(m=l.day;m!=p.day+g;m+=g)if(r>>m&1){q=new Date(l.year,l.month,m+1);break}}else return y("day",c[m])}}return y("day",q)},isNextPeriodEnabled:function(d,e){if(!e&&this.minDate&&this.minDate>d||e&&this.maxDate&&this.maxDate<d)return!1;if(this.map)if(this.periodEnableByDefault){if(!e&&this.minDate)return this.isPeriodEnabled(this.minDate,
d);if(e&&this.maxDate)return this.isPeriodEnabled(d,this.maxDate)}else{var g=e?1:-1,m=d.getFullYear(),p=(new Date(d)).add("millisecond",g),q=p.getFullYear(),r=b.object.keys(this.map.enable).filter(function(b){return g*b>=g*q}),c=r.length;if(c)for(var r=r.sort(function(b,c){return g*(b>c)||-g*(b<c)}),l=0;l<c;l++){var t=y("year",new Date(r[l],0));if(this.isPeriodEnabled(e&&r[l]==m?p:t.periodStart,!e&&r[l]==m?p:t.periodEnd))return!0}return!1}return!0},isPeriodEnabled:function(b,e){if(this.minDate&&this.minDate>
e||this.maxDate&&this.maxDate<b)return!1;var g=this.map&&this.map[this.periodEnableByDefault?"disabled":"enabled"];if(g){var m=z(b),p=z(e),q,r,c,l=m.month,t=new Date(m.year,m.month),v=11-m.month,y=v+1+12*(p.year-m.year-1)+(p.month+1)-1;if(this.periodEnableByDefault){if(0==y)return!(q=g[m.year])||!(r=q[m.month])||(r^2147483647)>>m.day&G[p.day-m.day+1];for(var x=0;x<=y;x++){if(!x||v==x%12)if(q=g[t.getFullYear()],!q)return!0;r=q[l=t.getMonth()];if(!r)return!0;c=G[t.getMonthDayCount()];if(x/y?1==x/y?
(r&c^c)&G[p.day+1]:r&c^c:(r&c^c)>>m.day)return!0;t.setMonth(l+1)}}else{if(0==y)return(q=g[m.year])&&(r=q[m.month])&&r>>m.day&G[p.day-m.day+1];for(x=0;x<=y;x++){if(!x||v==x%12||!q)if(q=g[t.getFullYear()],!q){x+=12;t.setMonth(l+12);continue}if((r=q[l=t.getMonth()])&&(x/y?1==x/y?r&G[p.day+1]:r:r>>m.day))return!0;t.setMonth(l+1)}}return!1}return!0},destroy:function(){x.prototype.destroy.call(this);this.date.destroy();this.date=null;this.selectedDate.destroy();this.selectedDate=null;delete this.isPeriodEnabled;
this.tabElementMap_=null}});H.exports={Calendar:g,CalendarSection:e}}]].forEach(function(g){var H=g[1];g=basis.namespace(g[0]);H.call(g,g.exports,g,basis,this,"","",basis.resource);basis.object.complete(g,g.exports)},this)}).call(this)